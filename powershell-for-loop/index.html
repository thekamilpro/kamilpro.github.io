<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>PowerShell For loop | Kamil Pro</title><meta name=keywords content="PowerShell,loop,statement,repeat,do,azure,repeat"><meta name=description content="For loop - do you actually need it, since there&rsquo;s foreach loop? Turns out, yes - there are situations where for loop comes very handy.
In this video I&rsquo;ll show you the basic syntax of the for loop, going through nested for loops to end up with real case scenario from Azure Application Insights.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 # Link to the video: https://youtu."><meta name=author content="Kamil"><link rel=canonical href=https://kamilpro.github.io/powershell-for-loop/><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://kamilpro.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://kamilpro.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://kamilpro.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://kamilpro.github.io/apple-touch-icon.png><link rel=mask-icon href=https://kamilpro.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=text/plain href=https://kamilpro.github.io/powershell-for-loop/index.md><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="PowerShell For loop"><meta property="og:description" content="For loop - do you actually need it, since there&rsquo;s foreach loop? Turns out, yes - there are situations where for loop comes very handy.
In this video I&rsquo;ll show you the basic syntax of the for loop, going through nested for loops to end up with real case scenario from Azure Application Insights.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 # Link to the video: https://youtu."><meta property="og:type" content="article"><meta property="og:url" content="https://kamilpro.github.io/powershell-for-loop/"><meta property="og:image" content="https://kamilpro.github.io/powershell-for-loop/featured-image.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-07-14T00:00:00+00:00"><meta property="article:modified_time" content="2022-04-21T20:17:03+01:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kamilpro.github.io/powershell-for-loop/featured-image.jpg"><meta name=twitter:title content="PowerShell For loop"><meta name=twitter:description content="For loop - do you actually need it, since there&rsquo;s foreach loop? Turns out, yes - there are situations where for loop comes very handy.
In this video I&rsquo;ll show you the basic syntax of the for loop, going through nested for loops to end up with real case scenario from Azure Application Insights.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 # Link to the video: https://youtu."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://kamilpro.github.io/posts/"},{"@type":"ListItem","position":3,"name":"PowerShell For loop","item":"https://kamilpro.github.io/powershell-for-loop/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"PowerShell For loop","name":"PowerShell For loop","description":"For loop - do you actually need it, since there\u0026rsquo;s foreach loop? Turns out, yes - there are situations where for loop comes very handy.\nIn this video I\u0026rsquo;ll show you the basic syntax of the for loop, going through nested for loops to end up with real case scenario from Azure Application Insights.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 # Link to the video: https://youtu.","keywords":["PowerShell","loop","statement","repeat","do","azure","repeat"],"articleBody":" For loop - do you actually need it, since there’s foreach loop? Turns out, yes - there are situations where for loop comes very handy.\nIn this video I’ll show you the basic syntax of the for loop, going through nested for loops to end up with real case scenario from Azure Application Insights.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 # Link to the video: https://youtu.be/YQnBVn-9SN0 # Documentation: # https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_for?view=powershell-7.1 # Basic syntax: # for (Initial Value/statement; Condition; Repeat) { Run my code } # Initial value: Set this is up before starting the loop # Condition: For loops ends, when condition evaluates to false; or it keep running as lon as condition is true # Repeat: Do this after every loop for ($MyVariable = 0; $MyVariable -lt 10; $MyVariable = $MyVariable + 1) { '$MyVariable is {0}' -f $MyVariable Start-Sleep -Seconds 2 } for ($MyVariable = 0; $MyVariable -lt 99; $MyVariable++) { '$MyVariable is {0}' -f $MyVariable } # We can also decrease it for ($MyVariable = 10; $MyVariable -gt 5; $MyVariable = $MyVariable - 1) { '$MyVariable is {0}' -f $MyVariable } # or specify variable outside if $outside = 7 for (; $outside -lt 15; $outside++) { '$Outside is {0}' -f $outside } #Looping through array $pets = @(\"Cat\", \"Dog\", \"Fish\", \"Turtle\") $pets.Count $pets[2] \"My pets in order:\" for ($i = 0; $i -lt $pets.Count; $i++) { $pets[$i] } # How about I'd like to add numbers \"\" \"My pets in order:\" \"\" for ($i = 0; $i -lt $pets.Count; $i++) { $Number = $i + 1 \" {0}. {1}\" -f $Number, $pets[$i] } # For also works with strings for ($text = ''; $text.Length -lt 10; $text += '@') { $text } # Nested for $row = 1..10 $column = 1..10 for ($i = 0; $i -lt $row.Count; $i++) { for ( $j = 0; $j -lt $column.Count; $j++) { $r = $row[$i] $c = $column[$j] $result = $r * $c $t = \"{0} * {1} = {2}\" -f $r, $c, $result Write-Host $t } } # It never ends... We need to break with CTRL - C for ( $i = 0 ; ; $i++ ) { \"Loop number: $I\" } # Or we can break when certain condition is met for ( $i = 0 ; ; $i++ ) { \"Loop number: $I\" if ($i -eq 1000) { \"Breaking out\" break } } # A real case scenario with Azure Application Insigts $Headers = @(\"First Name\", \"Email\", \"Phone Number\") $Rows = @( @(\"Kamil\", \"kamil@kamil.mail\", \"111-111-111\"), @(\"John\", \"john@john.mail\", \"222-222-222\"), @(\"Abigail\", \"abigail@abigail.mail\", \"333-333-333\") ) # List is like an array, however it allows to add new entries to it $result = New-Object System.Collections.Generic.List[System.Object] # We work with one record at the time foreach ($row in $Rows) { # We need a blank PowerShell object. Notice we don't specify any properties up front $record = [PSCustomObject]@{} # Now we are going to iterate through each property in the row for ($i = 0; $i -lt $Headers.Count; $i++) { # Since we are working with PowerShell object, we can add members # Notice we use index for both name and value $record | Add-Member -MemberType NoteProperty -Name $Headers[$i] -Value $row[$i] } # We add completed object object to the list $result.Add($record) } #Display list with all records $result ","wordCount":"663","inLanguage":"en","datePublished":"2021-07-14T00:00:00Z","dateModified":"2022-04-21T20:17:03+01:00","author":{"@type":"Person","name":"Kamil"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://kamilpro.github.io/powershell-for-loop/"},"publisher":{"@type":"Organization","name":"Kamil Pro","logo":{"@type":"ImageObject","url":"https://kamilpro.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://kamilpro.github.io accesskey=h title="Kamil Pro (Alt + H)">Kamil Pro</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://kamilpro.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://kamilpro.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://kamilpro.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href="https://www.youtube.com/playlist?list=PL-esmhgrps8Zv9bAHesStPRQ1AiUL1wY3" title="About PowerShell"><span>About PowerShell</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://kamilpro.github.io/powershell-for-it-professionals/ title="Powershell for IT professionals"><span>Powershell for IT professionals</span></a></li><li><a href=https://github.com/thekamilpro title=GitHub><span><i class='fab fa-github fa-fw'></i></span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>PowerShell For loop</h1><div class=post-meta><span title='2021-07-14 00:00:00 +0000 UTC'>2021-07-14</span>&nbsp;·&nbsp;Kamil</div></header><div class=post-content><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube-nocookie.com/embed/YQnBVn-9SN0 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><p>For loop - do you actually need it, since there&rsquo;s foreach loop? Turns out, yes - there are situations where for loop comes very handy.</p><p>In this video I&rsquo;ll show you the basic syntax of the for loop, going through nested for loops to end up with real case scenario from Azure Application Insights.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ps1 data-lang=ps1><span class=line><span class=cl><span class=c># Link to the video: https://youtu.be/YQnBVn-9SN0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Documentation:</span>
</span></span><span class=line><span class=cl><span class=c># https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_for?view=powershell-7.1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Basic syntax:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># for (Initial Value/statement; Condition; Repeat) { Run my code }</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Initial value: Set this is up before starting the loop </span>
</span></span><span class=line><span class=cl><span class=c># Condition: For loops ends, when condition evaluates to false; or it keep running as lon as condition is true</span>
</span></span><span class=line><span class=cl><span class=c># Repeat: Do this after every loop</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span><span class=nv>$MyVariable</span> <span class=p>=</span> <span class=mf>0</span><span class=p>;</span> <span class=nv>$MyVariable</span> <span class=o>-lt</span> <span class=mf>10</span><span class=p>;</span> <span class=nv>$MyVariable</span> <span class=p>=</span> <span class=nv>$MyVariable</span> <span class=p>+</span> <span class=mf>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;$MyVariable is {0}&#39;</span> <span class=o>-f</span> <span class=nv>$MyVariable</span>
</span></span><span class=line><span class=cl>    <span class=nb>Start-Sleep</span> <span class=n>-Seconds</span> <span class=mf>2</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span><span class=nv>$MyVariable</span> <span class=p>=</span> <span class=mf>0</span><span class=p>;</span> <span class=nv>$MyVariable</span> <span class=o>-lt</span> <span class=mf>99</span><span class=p>;</span> <span class=nv>$MyVariable</span><span class=p>++)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;$MyVariable is {0}&#39;</span> <span class=o>-f</span> <span class=nv>$MyVariable</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># We can also decrease it</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span><span class=nv>$MyVariable</span> <span class=p>=</span> <span class=mf>10</span><span class=p>;</span> <span class=nv>$MyVariable</span> <span class=o>-gt</span> <span class=mf>5</span><span class=p>;</span> <span class=nv>$MyVariable</span> <span class=p>=</span> <span class=nv>$MyVariable</span> <span class=p>-</span> <span class=mf>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;$MyVariable is {0}&#39;</span> <span class=o>-f</span> <span class=nv>$MyVariable</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># or specify variable outside if</span>
</span></span><span class=line><span class=cl><span class=nv>$outside</span> <span class=p>=</span> <span class=mf>7</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=p>(;</span> <span class=nv>$outside</span> <span class=o>-lt</span> <span class=mf>15</span><span class=p>;</span> <span class=nv>$outside</span><span class=p>++)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;$Outside is {0}&#39;</span> <span class=o>-f</span> <span class=nv>$outside</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>#Looping through array</span>
</span></span><span class=line><span class=cl><span class=nv>$pets</span> <span class=p>=</span> <span class=vm>@</span><span class=p>(</span><span class=s2>&#34;Cat&#34;</span><span class=p>,</span> <span class=s2>&#34;Dog&#34;</span><span class=p>,</span> <span class=s2>&#34;Fish&#34;</span><span class=p>,</span> <span class=s2>&#34;Turtle&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$pets</span><span class=p>.</span><span class=py>Count</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$pets</span><span class=p>[</span><span class=mf>2</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s2>&#34;My pets in order:&#34;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span><span class=nv>$i</span> <span class=p>=</span> <span class=mf>0</span><span class=p>;</span> <span class=nv>$i</span> <span class=o>-lt</span> <span class=nv>$pets</span><span class=p>.</span><span class=n>Count</span><span class=p>;</span> <span class=nv>$i</span><span class=p>++)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$pets</span><span class=p>[</span><span class=nv>$i</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># How about I&#39;d like to add numbers</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;My pets in order:&#34;</span>
</span></span><span class=line><span class=cl><span class=s2>&#34;&#34;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span><span class=nv>$i</span> <span class=p>=</span> <span class=mf>0</span><span class=p>;</span> <span class=nv>$i</span> <span class=o>-lt</span> <span class=nv>$pets</span><span class=p>.</span><span class=n>Count</span><span class=p>;</span> <span class=nv>$i</span><span class=p>++)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$Number</span> <span class=p>=</span> <span class=nv>$i</span> <span class=p>+</span> <span class=mf>1</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;  {0}. {1}&#34;</span> <span class=o>-f</span> <span class=nv>$Number</span><span class=p>,</span> <span class=nv>$pets</span><span class=p>[</span><span class=nv>$i</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># For also works with strings</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span><span class=nv>$text</span> <span class=p>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span> <span class=nv>$text</span><span class=p>.</span><span class=py>Length</span> <span class=o>-lt</span> <span class=mf>10</span><span class=p>;</span> <span class=nv>$text</span> <span class=p>+=</span> <span class=s1>&#39;@&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$text</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Nested for</span>
</span></span><span class=line><span class=cl><span class=nv>$row</span> <span class=p>=</span> <span class=mf>1</span><span class=p>.</span><span class=mf>.10</span>
</span></span><span class=line><span class=cl><span class=nv>$column</span> <span class=p>=</span> <span class=mf>1</span><span class=p>.</span><span class=mf>.10</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span><span class=nv>$i</span> <span class=p>=</span> <span class=mf>0</span><span class=p>;</span> <span class=nv>$i</span> <span class=o>-lt</span> <span class=nv>$row</span><span class=p>.</span><span class=n>Count</span><span class=p>;</span> <span class=nv>$i</span><span class=p>++)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span> <span class=nv>$j</span> <span class=p>=</span> <span class=mf>0</span><span class=p>;</span> <span class=nv>$j</span> <span class=o>-lt</span> <span class=nv>$column</span><span class=p>.</span><span class=n>Count</span><span class=p>;</span> <span class=nv>$j</span><span class=p>++)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nv>$r</span> <span class=p>=</span> <span class=nv>$row</span><span class=p>[</span><span class=nv>$i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=nv>$c</span> <span class=p>=</span> <span class=nv>$column</span><span class=p>[</span><span class=nv>$j</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=nv>$result</span> <span class=p>=</span> <span class=nv>$r</span> <span class=p>*</span> <span class=nv>$c</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nv>$t</span> <span class=p>=</span> <span class=s2>&#34;{0} * {1} = {2}&#34;</span> <span class=o>-f</span> <span class=nv>$r</span><span class=p>,</span> <span class=nv>$c</span><span class=p>,</span> <span class=nv>$result</span>
</span></span><span class=line><span class=cl>        <span class=nb>Write-Host</span> <span class=nv>$t</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>     
</span></span><span class=line><span class=cl><span class=c># It never ends... We need to break with CTRL - C</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span> <span class=nv>$i</span> <span class=p>=</span> <span class=mf>0</span> <span class=p>;</span> <span class=p>;</span> <span class=nv>$i</span><span class=p>++</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Loop number: </span><span class=nv>$I</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Or we can break when certain condition is met </span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=p>(</span> <span class=nv>$i</span> <span class=p>=</span> <span class=mf>0</span> <span class=p>;</span> <span class=p>;</span> <span class=nv>$i</span><span class=p>++</span> <span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Loop number: </span><span class=nv>$I</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$i</span> <span class=o>-eq</span> <span class=mf>1000</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;Breaking out&#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># A real case scenario with Azure Application Insigts</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$Headers</span> <span class=p>=</span> <span class=vm>@</span><span class=p>(</span><span class=s2>&#34;First Name&#34;</span><span class=p>,</span> <span class=s2>&#34;Email&#34;</span><span class=p>,</span> <span class=s2>&#34;Phone Number&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$Rows</span> <span class=p>=</span> <span class=vm>@</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=vm>@</span><span class=p>(</span><span class=s2>&#34;Kamil&#34;</span><span class=p>,</span> <span class=s2>&#34;kamil@kamil.mail&#34;</span><span class=p>,</span> <span class=s2>&#34;111-111-111&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=vm>@</span><span class=p>(</span><span class=s2>&#34;John&#34;</span><span class=p>,</span> <span class=s2>&#34;john@john.mail&#34;</span><span class=p>,</span> <span class=s2>&#34;222-222-222&#34;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=vm>@</span><span class=p>(</span><span class=s2>&#34;Abigail&#34;</span><span class=p>,</span> <span class=s2>&#34;abigail@abigail.mail&#34;</span><span class=p>,</span> <span class=s2>&#34;333-333-333&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># List is like an array, however it allows to add new entries to it</span>
</span></span><span class=line><span class=cl><span class=nv>$result</span> <span class=p>=</span> <span class=nb>New-Object</span> <span class=n>System</span><span class=p>.</span><span class=py>Collections</span><span class=p>.</span><span class=py>Generic</span><span class=p>.</span><span class=n>List</span><span class=p>[</span><span class=no>System.Object</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># We work with one record at the time</span>
</span></span><span class=line><span class=cl><span class=k>foreach</span> <span class=p>(</span><span class=nv>$row</span> <span class=k>in</span> <span class=nv>$Rows</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c># We need a blank PowerShell object. Notice we don&#39;t specify any properties up front</span>
</span></span><span class=line><span class=cl>    <span class=nv>$record</span> <span class=p>=</span> <span class=p>[</span><span class=no>PSCustomObject</span><span class=p>]</span><span class=vm>@</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c># Now we are going to iterate through each property in the row</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=nv>$i</span> <span class=p>=</span> <span class=mf>0</span><span class=p>;</span> <span class=nv>$i</span> <span class=o>-lt</span> <span class=nv>$Headers</span><span class=p>.</span><span class=n>Count</span><span class=p>;</span> <span class=nv>$i</span><span class=p>++)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c># Since we are working with PowerShell object, we can add members</span>
</span></span><span class=line><span class=cl>        <span class=c># Notice we use index for both name and value</span>
</span></span><span class=line><span class=cl>        <span class=nv>$record</span> <span class=p>|</span> <span class=nb>Add-Member</span> <span class=n>-MemberType</span> <span class=n>NoteProperty</span> <span class=n>-Name</span> <span class=nv>$Headers</span><span class=p>[</span><span class=nv>$i</span><span class=p>]</span> <span class=n>-Value</span> <span class=nv>$row</span><span class=p>[</span><span class=nv>$i</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c># We add completed object object to the list</span>
</span></span><span class=line><span class=cl>    <span class=nv>$result</span><span class=p>.</span><span class=py>Add</span><span class=p>(</span><span class=nv>$record</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c>#Display list with all records</span>
</span></span><span class=line><span class=cl><span class=nv>$result</span>
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://kamilpro.github.io/tags/powershell/>powershell</a></li><li><a href=https://kamilpro.github.io/tags/loop/>loop</a></li><li><a href=https://kamilpro.github.io/tags/statement/>statement</a></li><li><a href=https://kamilpro.github.io/tags/do/>do</a></li><li><a href=https://kamilpro.github.io/tags/azure/>azure</a></li><li><a href=https://kamilpro.github.io/tags/repeat/>repeat</a></li></ul></footer></article></main><footer class=footer><span>Kamil Procyszyn</span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>