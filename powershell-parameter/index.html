<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>PowerShell Parameter Attributes - validate, group, require params and add pipeline to your function | Kamil Pro</title><meta name=keywords content="PowerShell,pwsh,validate,pipeline,parameter"><meta name=description content="Having properly configured parameters help your users to understand the use of your function. It also helps fellow developers to appreciate the intended use of the function. In addition, it gives you more control of how the code flows through your script.
Parameter attributes is what takes parameters to the next level - you can specify that certain parameters are mandatory, group them together so that only certain combination of parameters is meant to work together, we can even add pipeline support so that function can be used as any other built-in function."><meta name=author content="Kamil"><link rel=canonical href=https://kamilpro.github.io/powershell-parameter/><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://kamilpro.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://kamilpro.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://kamilpro.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://kamilpro.github.io/apple-touch-icon.png><link rel=mask-icon href=https://kamilpro.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=text/plain href=https://kamilpro.github.io/powershell-parameter/index.md><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="PowerShell Parameter Attributes - validate, group, require params and add pipeline to your function"><meta property="og:description" content="Having properly configured parameters help your users to understand the use of your function. It also helps fellow developers to appreciate the intended use of the function. In addition, it gives you more control of how the code flows through your script.
Parameter attributes is what takes parameters to the next level - you can specify that certain parameters are mandatory, group them together so that only certain combination of parameters is meant to work together, we can even add pipeline support so that function can be used as any other built-in function."><meta property="og:type" content="article"><meta property="og:url" content="https://kamilpro.github.io/powershell-parameter/"><meta property="og:image" content="https://kamilpro.github.io/powershell-parameter/featured-image.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-02-07T00:00:00+00:00"><meta property="article:modified_time" content="2022-09-29T10:46:11+01:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kamilpro.github.io/powershell-parameter/featured-image.jpg"><meta name=twitter:title content="PowerShell Parameter Attributes - validate, group, require params and add pipeline to your function"><meta name=twitter:description content="Having properly configured parameters help your users to understand the use of your function. It also helps fellow developers to appreciate the intended use of the function. In addition, it gives you more control of how the code flows through your script.
Parameter attributes is what takes parameters to the next level - you can specify that certain parameters are mandatory, group them together so that only certain combination of parameters is meant to work together, we can even add pipeline support so that function can be used as any other built-in function."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://kamilpro.github.io/posts/"},{"@type":"ListItem","position":3,"name":"PowerShell Parameter Attributes - validate, group, require params and add pipeline to your function","item":"https://kamilpro.github.io/powershell-parameter/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"PowerShell Parameter Attributes - validate, group, require params and add pipeline to your function","name":"PowerShell Parameter Attributes - validate, group, require params and add pipeline to your function","description":"Having properly configured parameters help your users to understand the use of your function. It also helps fellow developers to appreciate the intended use of the function. In addition, it gives you more control of how the code flows through your script.\nParameter attributes is what takes parameters to the next level - you can specify that certain parameters are mandatory, group them together so that only certain combination of parameters is meant to work together, we can even add pipeline support so that function can be used as any other built-in function.","keywords":["PowerShell","pwsh","validate","pipeline","parameter"],"articleBody":" Having properly configured parameters help your users to understand the use of your function. It also helps fellow developers to appreciate the intended use of the function. In addition, it gives you more control of how the code flows through your script.\nParameter attributes is what takes parameters to the next level - you can specify that certain parameters are mandatory, group them together so that only certain combination of parameters is meant to work together, we can even add pipeline support so that function can be used as any other built-in function.\nI will show you all the above with even more, as I always strive to go profoundly in PowerShell explanation!\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 # Sample script which asks user for basic information, then manipulates it and # display some information # There's no way (at least easy) to pass these parameters from prompt, nor validate $Name = Read-Host -Prompt \"What's your name?\" $Age = Read-Host -Prompt \"What's your age?\" Write-Host \"==================\" $email = '{0}@company.com' -f $Name.ToLower() Write-Host \"Hi $($Name.ToUpper())\" Write-Host \"your email address is: $email\" if ($Age -gt 17) { Write-Host \"You will be able to access any website\" } else { Write-Host \"We will turn on content blocker approriate to your age\" } ```ps1 @{ users = @( @{ID = 1; FirstName = \"John\"; Surname = \"Smith\"; Active = $true; Region = \"EU\" } @{ID = 2; FirstName = \"Elen\"; Surname = \"Smith\"; Active = $true; Region = \"NZ\"} @{ID = 3; FirstName = \"Andy\"; Surname = \"Oliver\"; Active = $true; Region = \"US\" } @{ID = 4; FirstName = \"Richard\"; Surname = \"Mann\"; Active = $false; Region = \"EU\" } ) } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 function Get-Person { [cmdletbinding()] param ( #[Parameter(Mandatory)] [string]$Surname, [string]$Firstname, [Parameter(Mandatory)] [int]$Id, [switch]$All, [switch]$IncludeInactive, [string]$Region ) $items = [System.Collections.Generic.List[pscustomobject]]::new() $data = Import-PowerShellDataFile -Path \"$PSScriptRoot\\data.psd1\" $users = $data.users if (!($IncludeInactive.IsPresent)) { $users = $users | Where-Object {$_.Active -eq $true} } if ($PSBoundParameters.ContainsKey('Region')) { $users = $users | Where-Object {$_.Region -eq $Region} } foreach ($u in $users) { $items.Add([pscustomobject]$u) } if ($PSBoundParameters.ContainsKey('All')) { return $items } if ($PSBoundParameters.ContainsKey('ID')) { return $items.Where({$_.ID -eq $Id}) } if ($PSBoundParameters.ContainsKey('Surname')) { if ($PSBoundParameters.ContainsKey(\"Firstname\")) { return $items.Where( { $_.Surname -eq $Surname -and $_.FirstName -eq $Firstname }) } else { return $items.Where( { $_.Surname -eq $Surname }) } } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 function Get-Person { [cmdletbinding(DefaultParameterSetName = \"All\")] param ( [Parameter(Mandatory, ParameterSetName = \"byName\")] [string]$Surname, [Parameter(ParameterSetName = \"byName\")] [string]$Firstname, [Parameter(Mandatory, ParameterSetName = \"byId\")] [int]$Id, [Parameter(ParameterSetName = \"All\")] [switch]$All, [switch]$IncludeInactive, [string]$Region ) $items = [System.Collections.Generic.List[pscustomobject]]::new() $data = Import-PowerShellDataFile -Path \"$PSScriptRoot\\data.psd1\" $users = $data.users if (!($IncludeInactive.IsPresent)) { $users = $users | Where-Object {$_.Active -eq $true} } if ($PSBoundParameters.ContainsKey('Region')) { $users = $users | Where-Object {$_.Region -eq $Region} } foreach ($u in $users) { $items.Add([pscustomobject]$u) } if ($PSCmdlet.ParameterSetName -eq \"All\") { return $items } if ($PSCmdlet.ParameterSetName -eq \"byId\") { return $items.Where({$_.ID -eq $Id}) } if ($PSCmdlet.ParameterSetName -eq \"byName\") { if ($PSBoundParameters.ContainsKey(\"Firstname\")) { return $items.Where( { $_.Surname -eq $Surname -and $_.FirstName -eq $Firstname }) } else { return $items.Where( { $_.Surname -eq $Surname }) } } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 function Get-Person { [cmdletbinding(DefaultParameterSetName = \"All\")] param ( [Parameter(Mandatory, ParameterSetName = \"byName\", Position = 1)] [string]$Surname, [Parameter(ParameterSetName = \"byName\", Position = 2)] [string]$Firstname, [Parameter(Mandatory, ParameterSetName = \"byId\", Position = 1)] [int]$Id, [Parameter(ParameterSetName = \"All\")] [switch]$All, [switch]$IncludeInactive, [string]$Region ) $items = [System.Collections.Generic.List[pscustomobject]]::new() $data = Import-PowerShellDataFile -Path \"$PSScriptRoot\\data.psd1\" $users = $data.users if (!($IncludeInactive.IsPresent)) { $users = $users | Where-Object {$_.Active -eq $true} } if ($PSBoundParameters.ContainsKey('Region')) { $users = $users | Where-Object {$_.Region -eq $Region} } foreach ($u in $users) { $items.Add([pscustomobject]$u) } if ($PSCmdlet.ParameterSetName -eq \"All\") { return $items } if ($PSCmdlet.ParameterSetName -eq \"byId\") { return $items.Where({$_.ID -eq $Id}) } if ($PSCmdlet.ParameterSetName -eq \"byName\") { if ($PSBoundParameters.ContainsKey(\"Firstname\")) { return $items.Where( { $_.Surname -eq $Surname -and $_.FirstName -eq $Firstname }) } else { return $items.Where( { $_.Surname -eq $Surname }) } } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 function Get-Person { [cmdletbinding(DefaultParameterSetName = \"All\")] param ( [Parameter(Mandatory, ParameterSetName = \"byName\", Position = 1, ValueFromPipeline)] [string]$Surname, [Parameter(ParameterSetName = \"byName\", Position = 2)] [string]$Firstname, [Parameter(Mandatory, ParameterSetName = \"byId\", Position = 1, ValueFromPipeline)] [int]$Id, [Parameter(ParameterSetName = \"All\")] [switch]$All, [switch]$IncludeInactive, [string]$Region ) $items = [System.Collections.Generic.List[pscustomobject]]::new() $data = Import-PowerShellDataFile -Path \"$PSScriptRoot\\data.psd1\" $users = $data.users if (!($IncludeInactive.IsPresent)) { $users = $users | Where-Object {$_.Active -eq $true} } if ($PSBoundParameters.ContainsKey('Region')) { $users = $users | Where-Object {$_.Region -eq $Region} } foreach ($u in $users) { $items.Add([pscustomobject]$u) } if ($PSCmdlet.ParameterSetName -eq \"All\") { return $items } if ($PSCmdlet.ParameterSetName -eq \"byId\") { return $items.Where({$_.ID -eq $Id}) } if ($PSCmdlet.ParameterSetName -eq \"byName\") { if ($PSBoundParameters.ContainsKey(\"Firstname\")) { return $items.Where( { $_.Surname -eq $Surname -and $_.FirstName -eq $Firstname }) } else { return $items.Where( { $_.Surname -eq $Surname }) } } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 function Get-Person { [cmdletbinding(DefaultParameterSetName = \"All\")] param ( [Parameter(Mandatory, ParameterSetName = \"byName\", Position = 1, ValueFromPipeline)] [string]$Surname, [Parameter(ParameterSetName = \"byName\", Position = 2)] [ValidateNotNullOrEmpty()] [string]$Firstname, [Parameter(Mandatory, ParameterSetName = \"byId\", Position = 1, ValueFromPipeline)] [ValidateRange(1,4)] [int]$Id, [Parameter(ParameterSetName = \"All\")] [switch]$All, [switch]$IncludeInactive, [ValidateSet(\"EU\", \"US\", \"NZ\")] [string]$Region ) $items = [System.Collections.Generic.List[pscustomobject]]::new() $data = Import-PowerShellDataFile -Path \"$PSScriptRoot\\data.psd1\" $users = $data.users if (!($IncludeInactive.IsPresent)) { $users = $users | Where-Object {$_.Active -eq $true} } if ($PSBoundParameters.ContainsKey('Region')) { $users = $users | Where-Object {$_.Region -eq $Region} } foreach ($u in $users) { $items.Add([pscustomobject]$u) } if ($PSCmdlet.ParameterSetName -eq \"All\") { return $items } if ($PSCmdlet.ParameterSetName -eq \"byId\") { return $items.Where({$_.ID -eq $Id}) } if ($PSCmdlet.ParameterSetName -eq \"byName\") { if ($PSBoundParameters.ContainsKey(\"Firstname\")) { return $items.Where( { $_.Surname -eq $Surname -and $_.FirstName -eq $Firstname }) } else { return $items.Where( { $_.Surname -eq $Surname }) } } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 function Get-Person { [cmdletbinding(DefaultParameterSetName = \"All\")] param ( [Parameter(Mandatory, ParameterSetName = \"byName\", Position = 1, ValueFromPipeline)] [Alias(\"SecondName\")] [string]$Surname, [Parameter(ParameterSetName = \"byName\", Position = 2)] [ValidateNotNullOrEmpty()] [Alias(\"GivenName\")] [string]$Firstname, [Parameter(Mandatory, ParameterSetName = \"byId\", Position = 1, ValueFromPipeline)] [ValidateRange(1,4)] [int]$Id, [Parameter(ParameterSetName = \"All\")] [switch]$All, [switch]$IncludeInactive, [ValidateSet(\"EU\", \"US\", \"NZ\")] [string]$Region ) $items = [System.Collections.Generic.List[pscustomobject]]::new() $data = Import-PowerShellDataFile -Path \"$PSScriptRoot\\data.psd1\" $users = $data.users if (!($IncludeInactive.IsPresent)) { $users = $users | Where-Object {$_.Active -eq $true} } if ($PSBoundParameters.ContainsKey('Region')) { $users = $users | Where-Object {$_.Region -eq $Region} } foreach ($u in $users) { $items.Add([pscustomobject]$u) } if ($PSCmdlet.ParameterSetName -eq \"All\") { return $items } if ($PSCmdlet.ParameterSetName -eq \"byId\") { return $items.Where({$_.ID -eq $Id}) } if ($PSCmdlet.ParameterSetName -eq \"byName\") { if ($PSBoundParameters.ContainsKey(\"Firstname\")) { return $items.Where( { $_.Surname -eq $Surname -and $_.FirstName -eq $Firstname }) } else { return $items.Where( { $_.Surname -eq $Surname }) } } } ","wordCount":"1394","inLanguage":"en","datePublished":"2022-02-07T00:00:00Z","dateModified":"2022-09-29T10:46:11+01:00","author":{"@type":"Person","name":"Kamil"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://kamilpro.github.io/powershell-parameter/"},"publisher":{"@type":"Organization","name":"Kamil Pro","logo":{"@type":"ImageObject","url":"https://kamilpro.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://kamilpro.github.io accesskey=h title="Kamil Pro (Alt + H)">Kamil Pro</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://kamilpro.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://kamilpro.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://kamilpro.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href="https://www.youtube.com/playlist?list=PL-esmhgrps8Zv9bAHesStPRQ1AiUL1wY3" title="About PowerShell"><span>About PowerShell</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://kamilpro.github.io/powershell-for-it-professionals/ title="Powershell for IT professionals"><span>Powershell for IT professionals</span></a></li><li><a href=https://github.com/thekamilpro title=GitHub><span><i class='fab fa-github fa-fw'></i></span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>PowerShell Parameter Attributes - validate, group, require params and add pipeline to your function</h1><div class=post-meta><span title='2022-02-07 00:00:00 +0000 UTC'>2022-02-07</span>&nbsp;Â·&nbsp;Kamil</div></header><div class=post-content><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube-nocookie.com/embed/hJIAK3qjlZQ style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><p>Having properly configured parameters help your users to understand the use of your function. It also helps fellow developers to appreciate the intended use of the function. In addition, it gives you more control of how the code flows through your script.</p><p>Parameter attributes is what takes parameters to the next level - you can specify that certain parameters are mandatory, group them together so that only certain combination of parameters is meant to work together, we can even add pipeline support so that function can be used as any other built-in function.</p><p>I will show you all the above with even more, as I always strive to go profoundly in PowerShell explanation!</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ps1 data-lang=ps1><span class=line><span class=cl><span class=c># Sample script which asks user for basic information, then manipulates it and</span>
</span></span><span class=line><span class=cl><span class=c># display some information</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># There&#39;s no way (at least easy) to pass these parameters from prompt, nor validate </span>
</span></span><span class=line><span class=cl><span class=nv>$Name</span> <span class=p>=</span> <span class=nb>Read-Host</span> <span class=n>-Prompt</span> <span class=s2>&#34;What&#39;s your name?&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$Age</span> <span class=p>=</span> <span class=nb>Read-Host</span> <span class=n>-Prompt</span> <span class=s2>&#34;What&#39;s your age?&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Write-Host</span> <span class=s2>&#34;==================&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$email</span> <span class=p>=</span> <span class=s1>&#39;{0}@company.com&#39;</span> <span class=o>-f</span> <span class=nv>$Name</span><span class=p>.</span><span class=py>ToLower</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Write-Host</span> <span class=s2>&#34;Hi </span><span class=p>$(</span><span class=nv>$Name</span><span class=p>.</span><span class=py>ToUpper</span><span class=p>())</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>Write-Host</span> <span class=s2>&#34;your email address is: </span><span class=nv>$email</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$Age</span> <span class=o>-gt</span> <span class=mf>17</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>Write-Host</span> <span class=s2>&#34;You will be able to access any website&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>Write-Host</span> <span class=s2>&#34;We will turn on content blocker approriate to your age&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>```</span><span class=n>ps1</span>
</span></span><span class=line><span class=cl><span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>users</span> <span class=p>=</span> <span class=vm>@</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=vm>@</span><span class=p>{</span><span class=n>ID</span> <span class=p>=</span> <span class=mf>1</span><span class=p>;</span> <span class=n>FirstName</span> <span class=p>=</span> <span class=s2>&#34;John&#34;</span><span class=p>;</span> <span class=n>Surname</span> <span class=p>=</span> <span class=s2>&#34;Smith&#34;</span><span class=p>;</span> <span class=n>Active</span> <span class=p>=</span> <span class=vm>$true</span><span class=p>;</span> <span class=n>Region</span> <span class=p>=</span> <span class=s2>&#34;EU&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=vm>@</span><span class=p>{</span><span class=n>ID</span> <span class=p>=</span> <span class=mf>2</span><span class=p>;</span> <span class=n>FirstName</span> <span class=p>=</span> <span class=s2>&#34;Elen&#34;</span><span class=p>;</span> <span class=n>Surname</span> <span class=p>=</span> <span class=s2>&#34;Smith&#34;</span><span class=p>;</span> <span class=n>Active</span> <span class=p>=</span> <span class=vm>$true</span><span class=p>;</span> <span class=n>Region</span> <span class=p>=</span> <span class=s2>&#34;NZ&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=vm>@</span><span class=p>{</span><span class=n>ID</span> <span class=p>=</span> <span class=mf>3</span><span class=p>;</span> <span class=n>FirstName</span> <span class=p>=</span> <span class=s2>&#34;Andy&#34;</span><span class=p>;</span> <span class=n>Surname</span> <span class=p>=</span> <span class=s2>&#34;Oliver&#34;</span><span class=p>;</span> <span class=n>Active</span> <span class=p>=</span> <span class=vm>$true</span><span class=p>;</span> <span class=n>Region</span> <span class=p>=</span> <span class=s2>&#34;US&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=vm>@</span><span class=p>{</span><span class=n>ID</span> <span class=p>=</span> <span class=mf>4</span><span class=p>;</span> <span class=n>FirstName</span> <span class=p>=</span> <span class=s2>&#34;Richard&#34;</span><span class=p>;</span> <span class=n>Surname</span> <span class=p>=</span> <span class=s2>&#34;Mann&#34;</span><span class=p>;</span> <span class=n>Active</span> <span class=p>=</span> <span class=vm>$false</span><span class=p>;</span> <span class=n>Region</span> <span class=p>=</span> <span class=s2>&#34;EU&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ps1 data-lang=ps1><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>Get-Person</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=nb>cmdletbinding</span><span class=p>()]</span>
</span></span><span class=line><span class=cl>    <span class=k>param</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=c>#[Parameter(Mandatory)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>string</span><span class=p>]</span><span class=nv>$Surname</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>string</span><span class=p>]</span><span class=nv>$Firstname</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>Mandatory</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>int</span><span class=p>]</span><span class=nv>$Id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>switch</span><span class=p>]</span><span class=nv>$All</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>switch</span><span class=p>]</span><span class=nv>$IncludeInactive</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>string</span><span class=p>]</span><span class=nv>$Region</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$items</span> <span class=p>=</span> <span class=p>[</span><span class=no>System.Collections.Generic.List[pscustomobject]</span><span class=p>]::</span><span class=n>new</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nv>$data</span> <span class=p>=</span> <span class=nb>Import-PowerShellDataFile</span> <span class=n>-Path</span> <span class=s2>&#34;</span><span class=nv>$PSScriptRoot</span><span class=s2>\data.psd1&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>$users</span> <span class=p>=</span> <span class=nv>$data</span><span class=p>.</span><span class=py>users</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(!(</span><span class=nv>$IncludeInactive</span><span class=p>.</span><span class=n>IsPresent</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$users</span> <span class=p>=</span> <span class=nv>$users</span> <span class=p>|</span> <span class=nb>Where-Object</span> <span class=p>{</span><span class=nv>$_</span><span class=p>.</span><span class=py>Active</span> <span class=o>-eq</span> <span class=vm>$true</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$PSBoundParameters</span><span class=p>.</span><span class=py>ContainsKey</span><span class=p>(</span><span class=s1>&#39;Region&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$users</span> <span class=p>=</span> <span class=nv>$users</span> <span class=p>|</span> <span class=nb>Where-Object</span> <span class=p>{</span><span class=nv>$_</span><span class=p>.</span><span class=py>Region</span> <span class=o>-eq</span> <span class=nv>$Region</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>foreach</span> <span class=p>(</span><span class=nv>$u</span> <span class=k>in</span> <span class=nv>$users</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$items</span><span class=p>.</span><span class=py>Add</span><span class=p>([</span><span class=no>pscustomobject</span><span class=p>]</span><span class=nv>$u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$PSBoundParameters</span><span class=p>.</span><span class=py>ContainsKey</span><span class=p>(</span><span class=s1>&#39;All&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$items</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$PSBoundParameters</span><span class=p>.</span><span class=py>ContainsKey</span><span class=p>(</span><span class=s1>&#39;ID&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$items</span><span class=p>.</span><span class=py>Where</span><span class=p>({</span><span class=nv>$_</span><span class=p>.</span><span class=py>ID</span> <span class=o>-eq</span> <span class=nv>$Id</span><span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$PSBoundParameters</span><span class=p>.</span><span class=py>ContainsKey</span><span class=p>(</span><span class=s1>&#39;Surname&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nv>$PSBoundParameters</span><span class=p>.</span><span class=py>ContainsKey</span><span class=p>(</span><span class=s2>&#34;Firstname&#34;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nv>$items</span><span class=p>.</span><span class=py>Where</span><span class=p>(</span> <span class=p>{</span> <span class=nv>$_</span><span class=p>.</span><span class=py>Surname</span> <span class=o>-eq</span> <span class=nv>$Surname</span> <span class=o>-and</span> <span class=nv>$_</span><span class=p>.</span><span class=py>FirstName</span> <span class=o>-eq</span> <span class=nv>$Firstname</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nv>$items</span><span class=p>.</span><span class=py>Where</span><span class=p>(</span> <span class=p>{</span> <span class=nv>$_</span><span class=p>.</span><span class=py>Surname</span> <span class=o>-eq</span> <span class=nv>$Surname</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ps1 data-lang=ps1><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>Get-Person</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=nb>cmdletbinding</span><span class=p>(</span><span class=na>DefaultParameterSetName</span> <span class=p>=</span> <span class=s2>&#34;All&#34;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=k>param</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>Mandatory</span><span class=p>,</span> <span class=na>ParameterSetName</span> <span class=p>=</span> <span class=s2>&#34;byName&#34;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>string</span><span class=p>]</span><span class=nv>$Surname</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>ParameterSetName</span> <span class=p>=</span> <span class=s2>&#34;byName&#34;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>string</span><span class=p>]</span><span class=nv>$Firstname</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>Mandatory</span><span class=p>,</span> <span class=na>ParameterSetName</span> <span class=p>=</span> <span class=s2>&#34;byId&#34;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>int</span><span class=p>]</span><span class=nv>$Id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>ParameterSetName</span> <span class=p>=</span> <span class=s2>&#34;All&#34;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>switch</span><span class=p>]</span><span class=nv>$All</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>switch</span><span class=p>]</span><span class=nv>$IncludeInactive</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>string</span><span class=p>]</span><span class=nv>$Region</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$items</span> <span class=p>=</span> <span class=p>[</span><span class=no>System.Collections.Generic.List[pscustomobject]</span><span class=p>]::</span><span class=n>new</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nv>$data</span> <span class=p>=</span> <span class=nb>Import-PowerShellDataFile</span> <span class=n>-Path</span> <span class=s2>&#34;</span><span class=nv>$PSScriptRoot</span><span class=s2>\data.psd1&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>$users</span> <span class=p>=</span> <span class=nv>$data</span><span class=p>.</span><span class=py>users</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(!(</span><span class=nv>$IncludeInactive</span><span class=p>.</span><span class=n>IsPresent</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$users</span> <span class=p>=</span> <span class=nv>$users</span> <span class=p>|</span> <span class=nb>Where-Object</span> <span class=p>{</span><span class=nv>$_</span><span class=p>.</span><span class=py>Active</span> <span class=o>-eq</span> <span class=vm>$true</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$PSBoundParameters</span><span class=p>.</span><span class=py>ContainsKey</span><span class=p>(</span><span class=s1>&#39;Region&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$users</span> <span class=p>=</span> <span class=nv>$users</span> <span class=p>|</span> <span class=nb>Where-Object</span> <span class=p>{</span><span class=nv>$_</span><span class=p>.</span><span class=py>Region</span> <span class=o>-eq</span> <span class=nv>$Region</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>foreach</span> <span class=p>(</span><span class=nv>$u</span> <span class=k>in</span> <span class=nv>$users</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$items</span><span class=p>.</span><span class=py>Add</span><span class=p>([</span><span class=no>pscustomobject</span><span class=p>]</span><span class=nv>$u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$PSCmdlet</span><span class=p>.</span><span class=na>ParameterSetName</span> <span class=o>-eq</span> <span class=s2>&#34;All&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$items</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$PSCmdlet</span><span class=p>.</span><span class=na>ParameterSetName</span> <span class=o>-eq</span> <span class=s2>&#34;byId&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$items</span><span class=p>.</span><span class=py>Where</span><span class=p>({</span><span class=nv>$_</span><span class=p>.</span><span class=py>ID</span> <span class=o>-eq</span> <span class=nv>$Id</span><span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$PSCmdlet</span><span class=p>.</span><span class=na>ParameterSetName</span> <span class=o>-eq</span> <span class=s2>&#34;byName&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nv>$PSBoundParameters</span><span class=p>.</span><span class=py>ContainsKey</span><span class=p>(</span><span class=s2>&#34;Firstname&#34;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nv>$items</span><span class=p>.</span><span class=py>Where</span><span class=p>(</span> <span class=p>{</span> <span class=nv>$_</span><span class=p>.</span><span class=py>Surname</span> <span class=o>-eq</span> <span class=nv>$Surname</span> <span class=o>-and</span> <span class=nv>$_</span><span class=p>.</span><span class=py>FirstName</span> <span class=o>-eq</span> <span class=nv>$Firstname</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nv>$items</span><span class=p>.</span><span class=py>Where</span><span class=p>(</span> <span class=p>{</span> <span class=nv>$_</span><span class=p>.</span><span class=py>Surname</span> <span class=o>-eq</span> <span class=nv>$Surname</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ps1 data-lang=ps1><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>Get-Person</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=nb>cmdletbinding</span><span class=p>(</span><span class=na>DefaultParameterSetName</span> <span class=p>=</span> <span class=s2>&#34;All&#34;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=k>param</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>Mandatory</span><span class=p>,</span> <span class=na>ParameterSetName</span> <span class=p>=</span> <span class=s2>&#34;byName&#34;</span><span class=p>,</span> <span class=na>Position</span> <span class=p>=</span> <span class=mf>1</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>string</span><span class=p>]</span><span class=nv>$Surname</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>ParameterSetName</span> <span class=p>=</span> <span class=s2>&#34;byName&#34;</span><span class=p>,</span> <span class=na>Position</span> <span class=p>=</span> <span class=mf>2</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>string</span><span class=p>]</span><span class=nv>$Firstname</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>Mandatory</span><span class=p>,</span> <span class=na>ParameterSetName</span> <span class=p>=</span> <span class=s2>&#34;byId&#34;</span><span class=p>,</span> <span class=na>Position</span> <span class=p>=</span> <span class=mf>1</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>int</span><span class=p>]</span><span class=nv>$Id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>ParameterSetName</span> <span class=p>=</span> <span class=s2>&#34;All&#34;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>switch</span><span class=p>]</span><span class=nv>$All</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>switch</span><span class=p>]</span><span class=nv>$IncludeInactive</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>string</span><span class=p>]</span><span class=nv>$Region</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$items</span> <span class=p>=</span> <span class=p>[</span><span class=no>System.Collections.Generic.List[pscustomobject]</span><span class=p>]::</span><span class=n>new</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nv>$data</span> <span class=p>=</span> <span class=nb>Import-PowerShellDataFile</span> <span class=n>-Path</span> <span class=s2>&#34;</span><span class=nv>$PSScriptRoot</span><span class=s2>\data.psd1&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>$users</span> <span class=p>=</span> <span class=nv>$data</span><span class=p>.</span><span class=py>users</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(!(</span><span class=nv>$IncludeInactive</span><span class=p>.</span><span class=n>IsPresent</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$users</span> <span class=p>=</span> <span class=nv>$users</span> <span class=p>|</span> <span class=nb>Where-Object</span> <span class=p>{</span><span class=nv>$_</span><span class=p>.</span><span class=py>Active</span> <span class=o>-eq</span> <span class=vm>$true</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$PSBoundParameters</span><span class=p>.</span><span class=py>ContainsKey</span><span class=p>(</span><span class=s1>&#39;Region&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$users</span> <span class=p>=</span> <span class=nv>$users</span> <span class=p>|</span> <span class=nb>Where-Object</span> <span class=p>{</span><span class=nv>$_</span><span class=p>.</span><span class=py>Region</span> <span class=o>-eq</span> <span class=nv>$Region</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>foreach</span> <span class=p>(</span><span class=nv>$u</span> <span class=k>in</span> <span class=nv>$users</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$items</span><span class=p>.</span><span class=py>Add</span><span class=p>([</span><span class=no>pscustomobject</span><span class=p>]</span><span class=nv>$u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$PSCmdlet</span><span class=p>.</span><span class=na>ParameterSetName</span> <span class=o>-eq</span> <span class=s2>&#34;All&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$items</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$PSCmdlet</span><span class=p>.</span><span class=na>ParameterSetName</span> <span class=o>-eq</span> <span class=s2>&#34;byId&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$items</span><span class=p>.</span><span class=py>Where</span><span class=p>({</span><span class=nv>$_</span><span class=p>.</span><span class=py>ID</span> <span class=o>-eq</span> <span class=nv>$Id</span><span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$PSCmdlet</span><span class=p>.</span><span class=na>ParameterSetName</span> <span class=o>-eq</span> <span class=s2>&#34;byName&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nv>$PSBoundParameters</span><span class=p>.</span><span class=py>ContainsKey</span><span class=p>(</span><span class=s2>&#34;Firstname&#34;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nv>$items</span><span class=p>.</span><span class=py>Where</span><span class=p>(</span> <span class=p>{</span> <span class=nv>$_</span><span class=p>.</span><span class=py>Surname</span> <span class=o>-eq</span> <span class=nv>$Surname</span> <span class=o>-and</span> <span class=nv>$_</span><span class=p>.</span><span class=py>FirstName</span> <span class=o>-eq</span> <span class=nv>$Firstname</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nv>$items</span><span class=p>.</span><span class=py>Where</span><span class=p>(</span> <span class=p>{</span> <span class=nv>$_</span><span class=p>.</span><span class=py>Surname</span> <span class=o>-eq</span> <span class=nv>$Surname</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ps1 data-lang=ps1><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>Get-Person</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=nb>cmdletbinding</span><span class=p>(</span><span class=na>DefaultParameterSetName</span> <span class=p>=</span> <span class=s2>&#34;All&#34;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=k>param</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>Mandatory</span><span class=p>,</span> <span class=na>ParameterSetName</span> <span class=p>=</span> <span class=s2>&#34;byName&#34;</span><span class=p>,</span> <span class=na>Position</span> <span class=p>=</span> <span class=mf>1</span><span class=p>,</span> <span class=na>ValueFromPipeline</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>string</span><span class=p>]</span><span class=nv>$Surname</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>ParameterSetName</span> <span class=p>=</span> <span class=s2>&#34;byName&#34;</span><span class=p>,</span> <span class=na>Position</span> <span class=p>=</span> <span class=mf>2</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>string</span><span class=p>]</span><span class=nv>$Firstname</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>Mandatory</span><span class=p>,</span> <span class=na>ParameterSetName</span> <span class=p>=</span> <span class=s2>&#34;byId&#34;</span><span class=p>,</span> <span class=na>Position</span> <span class=p>=</span> <span class=mf>1</span><span class=p>,</span> <span class=na>ValueFromPipeline</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>int</span><span class=p>]</span><span class=nv>$Id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>ParameterSetName</span> <span class=p>=</span> <span class=s2>&#34;All&#34;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>switch</span><span class=p>]</span><span class=nv>$All</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>switch</span><span class=p>]</span><span class=nv>$IncludeInactive</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>string</span><span class=p>]</span><span class=nv>$Region</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$items</span> <span class=p>=</span> <span class=p>[</span><span class=no>System.Collections.Generic.List[pscustomobject]</span><span class=p>]::</span><span class=n>new</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nv>$data</span> <span class=p>=</span> <span class=nb>Import-PowerShellDataFile</span> <span class=n>-Path</span> <span class=s2>&#34;</span><span class=nv>$PSScriptRoot</span><span class=s2>\data.psd1&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>$users</span> <span class=p>=</span> <span class=nv>$data</span><span class=p>.</span><span class=py>users</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(!(</span><span class=nv>$IncludeInactive</span><span class=p>.</span><span class=n>IsPresent</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$users</span> <span class=p>=</span> <span class=nv>$users</span> <span class=p>|</span> <span class=nb>Where-Object</span> <span class=p>{</span><span class=nv>$_</span><span class=p>.</span><span class=py>Active</span> <span class=o>-eq</span> <span class=vm>$true</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$PSBoundParameters</span><span class=p>.</span><span class=py>ContainsKey</span><span class=p>(</span><span class=s1>&#39;Region&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$users</span> <span class=p>=</span> <span class=nv>$users</span> <span class=p>|</span> <span class=nb>Where-Object</span> <span class=p>{</span><span class=nv>$_</span><span class=p>.</span><span class=py>Region</span> <span class=o>-eq</span> <span class=nv>$Region</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>foreach</span> <span class=p>(</span><span class=nv>$u</span> <span class=k>in</span> <span class=nv>$users</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$items</span><span class=p>.</span><span class=py>Add</span><span class=p>([</span><span class=no>pscustomobject</span><span class=p>]</span><span class=nv>$u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$PSCmdlet</span><span class=p>.</span><span class=na>ParameterSetName</span> <span class=o>-eq</span> <span class=s2>&#34;All&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$items</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$PSCmdlet</span><span class=p>.</span><span class=na>ParameterSetName</span> <span class=o>-eq</span> <span class=s2>&#34;byId&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$items</span><span class=p>.</span><span class=py>Where</span><span class=p>({</span><span class=nv>$_</span><span class=p>.</span><span class=py>ID</span> <span class=o>-eq</span> <span class=nv>$Id</span><span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$PSCmdlet</span><span class=p>.</span><span class=na>ParameterSetName</span> <span class=o>-eq</span> <span class=s2>&#34;byName&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nv>$PSBoundParameters</span><span class=p>.</span><span class=py>ContainsKey</span><span class=p>(</span><span class=s2>&#34;Firstname&#34;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nv>$items</span><span class=p>.</span><span class=py>Where</span><span class=p>(</span> <span class=p>{</span> <span class=nv>$_</span><span class=p>.</span><span class=py>Surname</span> <span class=o>-eq</span> <span class=nv>$Surname</span> <span class=o>-and</span> <span class=nv>$_</span><span class=p>.</span><span class=py>FirstName</span> <span class=o>-eq</span> <span class=nv>$Firstname</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nv>$items</span><span class=p>.</span><span class=py>Where</span><span class=p>(</span> <span class=p>{</span> <span class=nv>$_</span><span class=p>.</span><span class=py>Surname</span> <span class=o>-eq</span> <span class=nv>$Surname</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ps1 data-lang=ps1><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>Get-Person</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=nb>cmdletbinding</span><span class=p>(</span><span class=na>DefaultParameterSetName</span> <span class=p>=</span> <span class=s2>&#34;All&#34;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=k>param</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>Mandatory</span><span class=p>,</span> <span class=na>ParameterSetName</span> <span class=p>=</span> <span class=s2>&#34;byName&#34;</span><span class=p>,</span> <span class=na>Position</span> <span class=p>=</span> <span class=mf>1</span><span class=p>,</span> <span class=na>ValueFromPipeline</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>string</span><span class=p>]</span><span class=nv>$Surname</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>ParameterSetName</span> <span class=p>=</span> <span class=s2>&#34;byName&#34;</span><span class=p>,</span> <span class=na>Position</span> <span class=p>=</span> <span class=mf>2</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>ValidateNotNullOrEmpty</span><span class=p>()]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>string</span><span class=p>]</span><span class=nv>$Firstname</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>Mandatory</span><span class=p>,</span> <span class=na>ParameterSetName</span> <span class=p>=</span> <span class=s2>&#34;byId&#34;</span><span class=p>,</span> <span class=na>Position</span> <span class=p>=</span> <span class=mf>1</span><span class=p>,</span> <span class=na>ValueFromPipeline</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>ValidateRange</span><span class=p>(</span><span class=mf>1</span><span class=p>,</span><span class=mf>4</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>int</span><span class=p>]</span><span class=nv>$Id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>ParameterSetName</span> <span class=p>=</span> <span class=s2>&#34;All&#34;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>switch</span><span class=p>]</span><span class=nv>$All</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>switch</span><span class=p>]</span><span class=nv>$IncludeInactive</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>ValidateSet</span><span class=p>(</span><span class=s2>&#34;EU&#34;</span><span class=p>,</span> <span class=s2>&#34;US&#34;</span><span class=p>,</span> <span class=s2>&#34;NZ&#34;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>string</span><span class=p>]</span><span class=nv>$Region</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$items</span> <span class=p>=</span> <span class=p>[</span><span class=no>System.Collections.Generic.List[pscustomobject]</span><span class=p>]::</span><span class=n>new</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nv>$data</span> <span class=p>=</span> <span class=nb>Import-PowerShellDataFile</span> <span class=n>-Path</span> <span class=s2>&#34;</span><span class=nv>$PSScriptRoot</span><span class=s2>\data.psd1&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>$users</span> <span class=p>=</span> <span class=nv>$data</span><span class=p>.</span><span class=py>users</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(!(</span><span class=nv>$IncludeInactive</span><span class=p>.</span><span class=n>IsPresent</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$users</span> <span class=p>=</span> <span class=nv>$users</span> <span class=p>|</span> <span class=nb>Where-Object</span> <span class=p>{</span><span class=nv>$_</span><span class=p>.</span><span class=py>Active</span> <span class=o>-eq</span> <span class=vm>$true</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$PSBoundParameters</span><span class=p>.</span><span class=py>ContainsKey</span><span class=p>(</span><span class=s1>&#39;Region&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$users</span> <span class=p>=</span> <span class=nv>$users</span> <span class=p>|</span> <span class=nb>Where-Object</span> <span class=p>{</span><span class=nv>$_</span><span class=p>.</span><span class=py>Region</span> <span class=o>-eq</span> <span class=nv>$Region</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>foreach</span> <span class=p>(</span><span class=nv>$u</span> <span class=k>in</span> <span class=nv>$users</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$items</span><span class=p>.</span><span class=py>Add</span><span class=p>([</span><span class=no>pscustomobject</span><span class=p>]</span><span class=nv>$u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$PSCmdlet</span><span class=p>.</span><span class=na>ParameterSetName</span> <span class=o>-eq</span> <span class=s2>&#34;All&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$items</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$PSCmdlet</span><span class=p>.</span><span class=na>ParameterSetName</span> <span class=o>-eq</span> <span class=s2>&#34;byId&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$items</span><span class=p>.</span><span class=py>Where</span><span class=p>({</span><span class=nv>$_</span><span class=p>.</span><span class=py>ID</span> <span class=o>-eq</span> <span class=nv>$Id</span><span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$PSCmdlet</span><span class=p>.</span><span class=na>ParameterSetName</span> <span class=o>-eq</span> <span class=s2>&#34;byName&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nv>$PSBoundParameters</span><span class=p>.</span><span class=py>ContainsKey</span><span class=p>(</span><span class=s2>&#34;Firstname&#34;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nv>$items</span><span class=p>.</span><span class=py>Where</span><span class=p>(</span> <span class=p>{</span> <span class=nv>$_</span><span class=p>.</span><span class=py>Surname</span> <span class=o>-eq</span> <span class=nv>$Surname</span> <span class=o>-and</span> <span class=nv>$_</span><span class=p>.</span><span class=py>FirstName</span> <span class=o>-eq</span> <span class=nv>$Firstname</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nv>$items</span><span class=p>.</span><span class=py>Where</span><span class=p>(</span> <span class=p>{</span> <span class=nv>$_</span><span class=p>.</span><span class=py>Surname</span> <span class=o>-eq</span> <span class=nv>$Surname</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ps1 data-lang=ps1><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>Get-Person</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=nb>cmdletbinding</span><span class=p>(</span><span class=na>DefaultParameterSetName</span> <span class=p>=</span> <span class=s2>&#34;All&#34;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>    <span class=k>param</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>Mandatory</span><span class=p>,</span> <span class=na>ParameterSetName</span> <span class=p>=</span> <span class=s2>&#34;byName&#34;</span><span class=p>,</span> <span class=na>Position</span> <span class=p>=</span> <span class=mf>1</span><span class=p>,</span> <span class=na>ValueFromPipeline</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>Alias</span><span class=p>(</span><span class=s2>&#34;SecondName&#34;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>string</span><span class=p>]</span><span class=nv>$Surname</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>ParameterSetName</span> <span class=p>=</span> <span class=s2>&#34;byName&#34;</span><span class=p>,</span> <span class=na>Position</span> <span class=p>=</span> <span class=mf>2</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>ValidateNotNullOrEmpty</span><span class=p>()]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>Alias</span><span class=p>(</span><span class=s2>&#34;GivenName&#34;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>string</span><span class=p>]</span><span class=nv>$Firstname</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>Mandatory</span><span class=p>,</span> <span class=na>ParameterSetName</span> <span class=p>=</span> <span class=s2>&#34;byId&#34;</span><span class=p>,</span> <span class=na>Position</span> <span class=p>=</span> <span class=mf>1</span><span class=p>,</span> <span class=na>ValueFromPipeline</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>ValidateRange</span><span class=p>(</span><span class=mf>1</span><span class=p>,</span><span class=mf>4</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>int</span><span class=p>]</span><span class=nv>$Id</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>ParameterSetName</span> <span class=p>=</span> <span class=s2>&#34;All&#34;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>switch</span><span class=p>]</span><span class=nv>$All</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>switch</span><span class=p>]</span><span class=nv>$IncludeInactive</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>ValidateSet</span><span class=p>(</span><span class=s2>&#34;EU&#34;</span><span class=p>,</span> <span class=s2>&#34;US&#34;</span><span class=p>,</span> <span class=s2>&#34;NZ&#34;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=no>string</span><span class=p>]</span><span class=nv>$Region</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$items</span> <span class=p>=</span> <span class=p>[</span><span class=no>System.Collections.Generic.List[pscustomobject]</span><span class=p>]::</span><span class=n>new</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nv>$data</span> <span class=p>=</span> <span class=nb>Import-PowerShellDataFile</span> <span class=n>-Path</span> <span class=s2>&#34;</span><span class=nv>$PSScriptRoot</span><span class=s2>\data.psd1&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>$users</span> <span class=p>=</span> <span class=nv>$data</span><span class=p>.</span><span class=py>users</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(!(</span><span class=nv>$IncludeInactive</span><span class=p>.</span><span class=n>IsPresent</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$users</span> <span class=p>=</span> <span class=nv>$users</span> <span class=p>|</span> <span class=nb>Where-Object</span> <span class=p>{</span><span class=nv>$_</span><span class=p>.</span><span class=py>Active</span> <span class=o>-eq</span> <span class=vm>$true</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$PSBoundParameters</span><span class=p>.</span><span class=py>ContainsKey</span><span class=p>(</span><span class=s1>&#39;Region&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$users</span> <span class=p>=</span> <span class=nv>$users</span> <span class=p>|</span> <span class=nb>Where-Object</span> <span class=p>{</span><span class=nv>$_</span><span class=p>.</span><span class=py>Region</span> <span class=o>-eq</span> <span class=nv>$Region</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>foreach</span> <span class=p>(</span><span class=nv>$u</span> <span class=k>in</span> <span class=nv>$users</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$items</span><span class=p>.</span><span class=py>Add</span><span class=p>([</span><span class=no>pscustomobject</span><span class=p>]</span><span class=nv>$u</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$PSCmdlet</span><span class=p>.</span><span class=na>ParameterSetName</span> <span class=o>-eq</span> <span class=s2>&#34;All&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$items</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$PSCmdlet</span><span class=p>.</span><span class=na>ParameterSetName</span> <span class=o>-eq</span> <span class=s2>&#34;byId&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$items</span><span class=p>.</span><span class=py>Where</span><span class=p>({</span><span class=nv>$_</span><span class=p>.</span><span class=py>ID</span> <span class=o>-eq</span> <span class=nv>$Id</span><span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nv>$PSCmdlet</span><span class=p>.</span><span class=na>ParameterSetName</span> <span class=o>-eq</span> <span class=s2>&#34;byName&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nv>$PSBoundParameters</span><span class=p>.</span><span class=py>ContainsKey</span><span class=p>(</span><span class=s2>&#34;Firstname&#34;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nv>$items</span><span class=p>.</span><span class=py>Where</span><span class=p>(</span> <span class=p>{</span> <span class=nv>$_</span><span class=p>.</span><span class=py>Surname</span> <span class=o>-eq</span> <span class=nv>$Surname</span> <span class=o>-and</span> <span class=nv>$_</span><span class=p>.</span><span class=py>FirstName</span> <span class=o>-eq</span> <span class=nv>$Firstname</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nv>$items</span><span class=p>.</span><span class=py>Where</span><span class=p>(</span> <span class=p>{</span> <span class=nv>$_</span><span class=p>.</span><span class=py>Surname</span> <span class=o>-eq</span> <span class=nv>$Surname</span> <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://kamilpro.github.io/tags/powershell/>powershell</a></li><li><a href=https://kamilpro.github.io/tags/pwsh/>pwsh</a></li><li><a href=https://kamilpro.github.io/tags/validate/>validate</a></li><li><a href=https://kamilpro.github.io/tags/pipeline/>pipeline</a></li><li><a href=https://kamilpro.github.io/tags/parameter/>parameter</a></li></ul></footer></article></main><footer class=footer><span>Kamil Procyszyn</span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>