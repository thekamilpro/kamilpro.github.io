<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>PowerShell PSCustomObject - Custom Object, the way it was meant to be - Kamil Pro</title><meta name=Description content="Sysadmin's point of view"><meta property="og:title" content="PowerShell PSCustomObject - Custom Object, the way it was meant to be"><meta property="og:description" content="Everything is an object in PowerShell, and ability to create own object allows for one more way of controlling and handling data.
In this video I&rsquo;ll take you through the steps of creating PSCustomObject, working with its properties to doing more advanced topics - like adding methods and types to the object.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 <#PSScriptInfo ."><meta property="og:type" content="article"><meta property="og:url" content="https://kamilpro.github.io/powershell-pscustomobject/"><meta property="og:image" content="https://kamilpro.github.io/powershell-pscustomobject/featured-image.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-11-02T00:00:00+00:00"><meta property="article:modified_time" content="2022-05-02T18:44:37+01:00"><meta property="og:site_name" content="My cool site"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kamilpro.github.io/powershell-pscustomobject/featured-image.png"><meta name=twitter:title content="PowerShell PSCustomObject - Custom Object, the way it was meant to be"><meta name=twitter:description content="Everything is an object in PowerShell, and ability to create own object allows for one more way of controlling and handling data.
In this video I&rsquo;ll take you through the steps of creating PSCustomObject, working with its properties to doing more advanced topics - like adding methods and types to the object.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 <#PSScriptInfo ."><meta name=application-name content="Kamil Pro"><meta name=apple-mobile-web-app-title content="Kamil Pro"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://kamilpro.github.io/powershell-pscustomobject/><link rel=prev href=https://kamilpro.github.io/powershell-hash-table/><link rel=next href=https://kamilpro.github.io/powershell-function/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><meta name=google-site-verification content="NniR9DFiwo_hSUsjXQj7xw3IHmRtl0ICeu4UmstK680"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"PowerShell PSCustomObject - Custom Object, the way it was meant to be","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/kamilpro.github.io\/powershell-pscustomobject\/"},"image":[{"@type":"ImageObject","url":"https:\/\/kamilpro.github.io\/powershell-pscustomobject\/featured-image.png","width":1280,"height":720}],"genre":"posts","keywords":"PowerShell, pwsh, object, custom, pscustomobject, data, scripting","wordcount":809,"url":"https:\/\/kamilpro.github.io\/powershell-pscustomobject\/","datePublished":"2021-11-02T00:00:00+00:00","dateModified":"2022-05-02T18:44:37+01:00","license":"Kamil Procyszyn","publisher":{"@type":"Organization","name":"Kamil Pro","logo":{"@type":"ImageObject","url":"https:\/\/kamilpro.github.io\/images\/avatar.png","width":512,"height":512}},"author":{"@type":"Person","name":"Kamil"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Kamil Pro">Kamil Pro<span class=header-title-post><i class='fas fa-terminal'></i></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href="https://www.youtube.com/playlist?list=PL-esmhgrps8Zv9bAHesStPRQ1AiUL1wY3" rel="noopener noreffer" target=_blank>About PowerShell </a><a class=menu-item href=/powershell-for-it-professionals/>Powershell for IT professionals </a><a class=menu-item href=https://github.com/thekamilpro title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw'></i> </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Kamil Pro">Kamil Pro<span class=header-title-post><i class='fas fa-terminal'></i></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href="https://www.youtube.com/playlist?list=PL-esmhgrps8Zv9bAHesStPRQ1AiUL1wY3" title rel="noopener noreffer" target=_blank>About PowerShell</a><a class=menu-item href=/powershell-for-it-professionals/ title>Powershell for IT professionals</a><a class=menu-item href=https://github.com/thekamilpro title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw'></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">PowerShell PSCustomObject - Custom Object, the way it was meant to be</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Kamil</a></span>&nbsp;<span class=post-category>included in <a href=/categories/powershell/><i class="far fa-folder fa-fw" aria-hidden=true></i>PowerShell</a>&nbsp;<a href=/categories/object/><i class="far fa-folder fa-fw" aria-hidden=true></i>object</a>&nbsp;<a href=/categories/custom/><i class="far fa-folder fa-fw" aria-hidden=true></i>custom</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2021-11-02>2021-11-02</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;809 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;4 minutes&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=/powershell-pscustomobject/featured-image.png data-srcset="/powershell-pscustomobject/featured-image.png, /powershell-pscustomobject/featured-image.png 1.5x, /powershell-pscustomobject/featured-image.png 2x" data-sizes=auto alt=/powershell-pscustomobject/featured-image.png title=/powershell-pscustomobject/featured-image.png></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents></nav></div></div><div class=content id=content><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube-nocookie.com/embed/DAVGyCytsqM style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><p>Everything is an object in PowerShell, and ability to create own object allows for one more way of controlling and handling data.</p><p>In this video I&rsquo;ll take you through the steps of creating PSCustomObject, working with its properties to doing more advanced topics - like adding methods and types to the object.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ps1 data-lang=ps1><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>&lt;#PSScriptInfo
</span></span></span><span class=line><span class=cl><span class=cm>.VERSION 1.0.0
</span></span></span><span class=line><span class=cl><span class=cm>.GUID f5228c81-d25c-4984-bb0c-e64576487b3e
</span></span></span><span class=line><span class=cl><span class=cm>.AUTHOR Kamil Procyszyn
</span></span></span><span class=line><span class=cl><span class=cm>.COPYRIGHT Kamil Procyszyn
</span></span></span><span class=line><span class=cl><span class=cm>.PROJECTURI https://github.com/kprocyszyn/About-PowerShell
</span></span></span><span class=line><span class=cl><span class=cm>.RELEASENOTES 2021 November
</span></span></span><span class=line><span class=cl><span class=cm>.</span><span class=sd>DESCRIPTION</span><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>Link to the video: https://youtu.be/DAVGyCytsqM
</span></span></span><span class=line><span class=cl><span class=cm>#&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>&lt;#
</span></span></span><span class=line><span class=cl><span class=cm>About PsCustomObject:
</span></span></span><span class=line><span class=cl><span class=cm>    https://forums.powershell.org/t/what-is-the-difference-between-pscustomobject-and-psobject/3887/4
</span></span></span><span class=line><span class=cl><span class=cm>    [PSCustomObject] is a type accelerator. It constructs a PSObject, but does so in a way that results in hash table keys 
</span></span></span><span class=line><span class=cl><span class=cm>    becoming properties. 
</span></span></span><span class=line><span class=cl><span class=cm>    PSCustomObject isn’t an object type per se - it’s a process shortcut. 
</span></span></span><span class=line><span class=cl><span class=cm>    The docs are relatively clear about it (https://msdn.microsoft.com/en-us/library/system.management.automation.pscustomobject(v=vs.85).aspx) 
</span></span></span><span class=line><span class=cl><span class=cm>    PSCustomObject is a placeholder that’s used when PSObject is called with no constructor parameters.
</span></span></span><span class=line><span class=cl><span class=cm>#&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Creating custom object:</span>
</span></span><span class=line><span class=cl><span class=nv>$obj</span> <span class=p>=</span> <span class=p>[</span><span class=no>PSCustomObject</span><span class=p>]</span><span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Name</span>    <span class=p>=</span> <span class=s2>&#34;Mr Fiber&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>Species</span> <span class=p>=</span> <span class=s2>&#34;Domestic cat&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>Type </span>   <span class=p>=</span> <span class=s2>&#34;Tabby cat&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nv>$obj</span>
</span></span><span class=line><span class=cl><span class=nv>$obj</span><span class=p>.</span><span class=py>Name</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Saving to a file (JSON):</span>
</span></span><span class=line><span class=cl><span class=c># We could save CSV, however CSV doesn&#39;t support nested properties, thus why JSON is preferable </span>
</span></span><span class=line><span class=cl><span class=nv>$Path</span> <span class=p>=</span> <span class=s2>&#34;</span><span class=nv>$env:TEMP</span><span class=s2>\pstojson.json&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$obj</span> <span class=p>|</span> <span class=nb>ConvertTo-Json</span> <span class=n>-Depth</span> <span class=mf>99</span> <span class=p>|</span> <span class=nb>Set-Content</span> <span class=n>-Path</span> <span class=nv>$path</span>
</span></span><span class=line><span class=cl><span class=nv>$imported</span> <span class=p>=</span> <span class=nb>Get-Content</span> <span class=n>-Path</span> <span class=nv>$Path</span>
</span></span><span class=line><span class=cl><span class=nv>$imported</span>
</span></span><span class=line><span class=cl><span class=nv>$imported</span> <span class=p>|</span> <span class=nb>ConvertFrom-Json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>##############</span>
</span></span><span class=line><span class=cl><span class=c># PROPERTIES #</span>
</span></span><span class=line><span class=cl><span class=c>##############</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Accessing properties</span>
</span></span><span class=line><span class=cl><span class=nv>$obj</span><span class=p>.</span><span class=py>Species</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Dynamically accessing properties</span>
</span></span><span class=line><span class=cl><span class=nv>$prop</span> <span class=p>=</span> <span class=s1>&#39;Type&#39;</span>
</span></span><span class=line><span class=cl><span class=nv>$obj</span><span class=p>.</span><span class=nv>$prop</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Adding property</span>
</span></span><span class=line><span class=cl><span class=nv>$obj</span> <span class=p>|</span> <span class=nb>Add-Member</span> <span class=n>-MemberType</span> <span class=n>NoteProperty</span> <span class=n>-Name</span> <span class=s1>&#39;Favourite Snack&#39;</span> <span class=n>-Value</span> <span class=s1>&#39;Dental treats&#39;</span>
</span></span><span class=line><span class=cl><span class=nv>$obj</span><span class=p>.</span><span class=s1>&#39;Favourite Snack&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Removing properties</span>
</span></span><span class=line><span class=cl><span class=nv>$obj</span><span class=p>.</span><span class=py>psobject</span><span class=p>.</span><span class=py>Properties</span><span class=p>.</span><span class=py>Remove</span><span class=p>(</span><span class=s1>&#39;Favourite Snack&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$obj</span><span class=p>.</span><span class=s1>&#39;Favourite Snack&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Listing properteis</span>
</span></span><span class=line><span class=cl><span class=nv>$obj</span><span class=p>.</span><span class=py>psobject</span><span class=p>.</span><span class=py>properties</span><span class=p>.</span><span class=py>name</span>
</span></span><span class=line><span class=cl><span class=nv>$obj</span> <span class=p>|</span> <span class=nb>Get-Member</span> <span class=n>-MemberType</span> <span class=n>NoteProperty</span> <span class=p>|</span> <span class=nb>Select-Object</span> <span class=n>-ExpandProperty</span> <span class=n>Name</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>#############</span>
</span></span><span class=line><span class=cl><span class=c># Hashtable #</span>
</span></span><span class=line><span class=cl><span class=c>#############</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Converting hashtable to psobject:</span>
</span></span><span class=line><span class=cl><span class=nv>$ht</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Name</span>    <span class=p>=</span> <span class=s2>&#34;Mr Fiber&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>Species</span> <span class=p>=</span> <span class=s2>&#34;Domestic cat&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>Type </span>   <span class=p>=</span> <span class=s2>&#34;Tabby cat&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nv>$ht</span>
</span></span><span class=line><span class=cl><span class=nv>$htobj</span> <span class=p>=</span> <span class=p>[</span><span class=no>pscustomobject</span><span class=p>]</span><span class=nv>$ht</span>
</span></span><span class=line><span class=cl><span class=nv>$htobj</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Converting psobject to hashtable</span>
</span></span><span class=line><span class=cl><span class=nv>$newHt</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=k>foreach</span> <span class=p>(</span><span class=nv>$property</span> <span class=k>in</span> <span class=nv>$htobj</span><span class=p>.</span><span class=py>psobject</span><span class=p>.</span><span class=py>Properties</span><span class=p>.</span><span class=n>name</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$newHt</span><span class=p>[</span><span class=nv>$property</span><span class=p>]</span> <span class=p>=</span> <span class=nv>$htobj</span><span class=p>.</span><span class=nv>$property</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nv>$newHt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>###########</span>
</span></span><span class=line><span class=cl><span class=c># Methods #</span>
</span></span><span class=line><span class=cl><span class=c>###########</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># We can actually have some action!</span>
</span></span><span class=line><span class=cl><span class=nv>$method</span> <span class=p>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Hi, my name is </span><span class=p>$(</span><span class=nv>$this</span><span class=p>.</span><span class=n>name</span><span class=p>)</span><span class=s2> and I like to sleep.&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$params</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>MemberType</span> <span class=p>=</span> <span class=s2>&#34;ScriptMethod&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>Name</span>       <span class=p>=</span> <span class=s2>&#34;SayHi&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>Value</span>      <span class=p>=</span> <span class=nv>$method</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nv>$obj</span> <span class=p>|</span> <span class=nb>Add-Member</span> <span class=nv>@params</span>
</span></span><span class=line><span class=cl><span class=nv>$obj</span><span class=p>.</span><span class=py>SayHi</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># How about, converting Object to Hashtable, as the actual method?</span>
</span></span><span class=line><span class=cl><span class=nv>$params</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>MemberType</span> <span class=p>=</span> <span class=s2>&#34;ScriptMethod&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>Name</span>       <span class=p>=</span> <span class=s2>&#34;OutHashtable&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>Value</span>      <span class=p>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$hash</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>        <span class=nv>$this</span><span class=p>.</span><span class=py>psobject</span><span class=p>.</span><span class=py>properties</span><span class=p>.</span><span class=py>name</span><span class=p>.</span><span class=k>foreach</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=nv>$hash</span><span class=p>[</span><span class=nv>$_</span><span class=p>]</span> <span class=p>=</span> <span class=nv>$this</span><span class=p>.</span><span class=nv>$_</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=nv>$hash</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nv>$obj</span> <span class=p>|</span> <span class=nb>Add-Member</span> <span class=nv>@params</span>
</span></span><span class=line><span class=cl><span class=nv>$obj</span><span class=p>.</span><span class=py>OutHashtable</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>#########</span>
</span></span><span class=line><span class=cl><span class=c># Types #</span>
</span></span><span class=line><span class=cl><span class=c>#########</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$obj</span> <span class=p>|</span> <span class=nb>Get-Member</span> <span class=c># now it is PSCustomObject, duh</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$obj</span><span class=p>.</span><span class=py>psobject</span><span class=p>.</span><span class=py>TypeNames</span> <span class=c># this looks familiar</span>
</span></span><span class=line><span class=cl><span class=nv>$obj</span><span class=p>.</span><span class=py>psobject</span><span class=p>.</span><span class=py>TypeNames</span><span class=p>.</span><span class=py>Insert</span><span class=p>(</span><span class=mf>0</span><span class=p>,</span> <span class=s2>&#34;Kp.CatsAreAwesome&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$obj</span> <span class=p>|</span> <span class=nb>Get-Member</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span><span class=w> </span><span class=nb>Invoke-CAA</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>param</span> <span class=p>(</span> 
</span></span><span class=line><span class=cl>        <span class=c># We only accept parameter of type Kp.CatsAreAwesome</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=n>PSTypeName</span><span class=p>(</span><span class=s1>&#39;Kp.CatsAreAwesome&#39;</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=p>[</span><span class=nb>Parameter</span><span class=p>(</span><span class=na>ValueFromPipeline</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>        <span class=nv>$Cat</span> 
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c># If $Cat has been passed, we call method SayHi(), otherwise we just say that cats are awesome (generally)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nv>$PSBoundParameters</span><span class=p>.</span><span class=py>ContainsKey</span><span class=p>(</span><span class=s1>&#39;Cat&#39;</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;Here&#39;s an awesome cat:&#34;</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=nv>$Cat</span><span class=p>.</span><span class=py>SayHi</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s2>&#34;Cats are awesome!&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nb>Invoke-CAA</span>
</span></span><span class=line><span class=cl><span class=nb>Invoke-Caa</span> <span class=n>-Cat</span> <span class=nv>$obj</span>
</span></span><span class=line><span class=cl><span class=nb>Invoke-Caa</span> <span class=n>-Cat</span> <span class=s2>&#34;BLA&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># We can also specify type name at creation</span>
</span></span><span class=line><span class=cl><span class=nv>$obj2</span> <span class=p>=</span> <span class=p>[</span><span class=no>pscustomobject</span><span class=p>]</span><span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>PSTypeName</span> <span class=p>=</span> <span class=s1>&#39;Kp.CatsAreAwesome&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>Name</span> <span class=p>=</span> <span class=s1>&#39;Whiskers&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>Species</span> <span class=p>=</span> <span class=s2>&#34;Domestic cat&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>Type </span>   <span class=p>=</span> <span class=s2>&#34;Persian&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$method</span> <span class=p>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Hi, my name is </span><span class=p>$(</span><span class=nv>$this</span><span class=p>.</span><span class=n>name</span><span class=p>)</span><span class=s2> and I like to sleep.&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$params</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>MemberType</span> <span class=p>=</span> <span class=s2>&#34;ScriptMethod&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>Name</span>       <span class=p>=</span> <span class=s2>&#34;SayHi&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>Value</span>      <span class=p>=</span> <span class=nv>$method</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nv>$obj2</span> <span class=p>|</span> <span class=nb>Add-Member</span> <span class=nv>@params</span>
</span></span><span class=line><span class=cl><span class=nv>$obj2</span> <span class=p>|</span> <span class=nb>Invoke-CAA</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Specify default output</span>
</span></span><span class=line><span class=cl><span class=nb>Update-TypeData</span> <span class=n>-TypeName</span> <span class=n>kp</span><span class=p>.</span><span class=py>CatsAreAwesome</span> <span class=n>-DefaultDisplayPropertySet</span> <span class=n>Name</span><span class=p>,</span><span class=nb>Type
</span></span></span><span class=line><span class=cl><span class=nb></span><span class=nv>$obj</span> <span class=c># list is now limited to only Name and Type properties</span>
</span></span><span class=line><span class=cl><span class=nv>$obj2</span>
</span></span><span class=line><span class=cl><span class=nv>$obj</span> <span class=p>|</span> <span class=nb>Format-List</span> <span class=n>-Property</span> <span class=p>*</span> <span class=c>#displays all</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Let&#39;s see arrays and pscustomobjects working together</span>
</span></span><span class=line><span class=cl><span class=nv>$list</span> <span class=p>=</span> <span class=p>[</span><span class=no>System.Collections.Generic.List[pscustomobject]</span><span class=p>]::</span><span class=n>new</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nv>$locations</span> <span class=p>=</span> <span class=vm>@</span><span class=p>(</span><span class=s2>&#34;London&#34;</span><span class=p>,</span> <span class=s2>&#34;Sligo&#34;</span><span class=p>,</span> <span class=s2>&#34;Barcelona&#34;</span><span class=p>,</span> <span class=s2>&#34;Paphos&#34;</span><span class=p>,</span> <span class=s2>&#34;Ubud&#34;</span><span class=p>,</span> <span class=s2>&#34;Valdemosa&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$baseUri</span> <span class=p>=</span> <span class=s2>&#34;wttr.in/&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>foreach</span> <span class=p>(</span><span class=nv>$location</span> <span class=k>in</span> <span class=nv>$locations</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Currently retrieving weather for: </span><span class=nv>$location</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>$Uri</span> <span class=p>=</span> <span class=s2>&#34;{0}{1}?format=j1&#34;</span> <span class=o>-f</span> <span class=nv>$baseUri</span><span class=p>,</span> <span class=nv>$location</span>
</span></span><span class=line><span class=cl>    <span class=nv>$Uri</span>
</span></span><span class=line><span class=cl>    <span class=nv>$data</span> <span class=p>=</span> <span class=nb>Invoke-RestMethod</span> <span class=nv>$Uri</span>
</span></span><span class=line><span class=cl>    <span class=nv>$result</span> <span class=p>=</span> <span class=p>[</span><span class=no>pscustomobject</span><span class=p>]</span><span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>City</span> <span class=p>=</span> <span class=nv>$Location</span>
</span></span><span class=line><span class=cl>        <span class=n>Temperature</span> <span class=p>=</span> <span class=nv>$data</span><span class=p>.</span><span class=py>current_condition</span><span class=p>.</span><span class=py>temp_C</span>
</span></span><span class=line><span class=cl>        <span class=n>Pressure</span> <span class=p>=</span>  <span class=nv>$data</span><span class=p>.</span><span class=py>current_condition</span><span class=p>.</span><span class=py>pressure</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nv>$list</span><span class=p>.</span><span class=py>Add</span><span class=p>(</span><span class=nv>$result</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nv>$list</span>
</span></span></code></pre></td></tr></table></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-05-02&nbsp;<a class=git-hash href=https://github.com/thekamilpro/commit/3a65778521dc86da17a8454467bfa48d053c02f6 target=_blank title="commit by Kamil Procyszyn(kprocyszyn@gmail.com) 3a65778521dc86da17a8454467bfa48d053c02f6: add pscustomboject video">
<i class="fas fa-hashtag fa-fw" aria-hidden=true></i>3a657785</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/powershell-pscustomobject/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://kamilpro.github.io/powershell-pscustomobject/ data-title="PowerShell PSCustomObject - Custom Object, the way it was meant to be" data-via=@thekamilpro data-hashtags=PowerShell,pwsh,object,custom,pscustomobject,data,scripting><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://kamilpro.github.io/powershell-pscustomobject/ data-hashtag=PowerShell><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://kamilpro.github.io/powershell-pscustomobject/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on WhatsApp" data-sharer=whatsapp data-url=https://kamilpro.github.io/powershell-pscustomobject/ data-title="PowerShell PSCustomObject - Custom Object, the way it was meant to be" data-web><i class="fab fa-whatsapp fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://kamilpro.github.io/powershell-pscustomobject/ data-title="PowerShell PSCustomObject - Custom Object, the way it was meant to be"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://kamilpro.github.io/powershell-pscustomobject/><i class="fab fa-reddit fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://kamilpro.github.io/powershell-pscustomobject/ data-title="PowerShell PSCustomObject - Custom Object, the way it was meant to be"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/powershell/>powershell</a>,&nbsp;<a href=/tags/pwsh/>pwsh</a>,&nbsp;<a href=/tags/object/>object</a>,&nbsp;<a href=/tags/custom/>custom</a>,&nbsp;<a href=/tags/pscustomobject/>pscustomobject</a>,&nbsp;<a href=/tags/data/>data</a>,&nbsp;<a href=/tags/scripting/>scripting</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/powershell-hash-table/ class=prev rel=prev title="PowerShell Hash Table - Storing key value pairs"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>PowerShell Hash Table - Storing key value pairs</a>
<a href=/powershell-function/ class=next rel=next title="PowerShell function - converting script into function with parameters">PowerShell function - converting script into function with parameters<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=utterances class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://utteranc.es/>utterances</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.115.3">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2014 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Kamil Pro</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{utterances:{darkTheme:"github-dark",issueTerm:"pathname",label:"Comment",lightTheme:"github-light",repo:"thekamilpro/kamilpro.github.io"}},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-64576368-1",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=UA-64576368-1" async></script></body></html>