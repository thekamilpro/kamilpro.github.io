<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>PowerShell for IT Professionals [#17] – Scripting part 4 – parameters, running remotely and formatting | Kamil Pro</title><meta name=keywords content="command,course,first script,formatting,invoke,param,parameters,powershell,remote,script,scripting"><meta name=description content="In the last part of scripting series, we will make the script to be able to query remote machines, e.g. servers.
We will also check how to add parameters to the script (and configure the default value of parameter) so that user will able to pass the parameter name like in a standard PowerShell cmdlet.
Finally, we are going to format the script so that it looks more reliable and make some refactoring so that the logic is simpler."><meta name=author content="Kamil"><link rel=canonical href=https://kamilpro.com/powershell-for-it-professionals-17-scripting-part-4-parameters-running-remotely-and-formatting/><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://kamilpro.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://kamilpro.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://kamilpro.com/favicon-32x32.png><link rel=apple-touch-icon href=https://kamilpro.com/apple-touch-icon.png><link rel=mask-icon href=https://kamilpro.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=text/plain href=https://kamilpro.com/powershell-for-it-professionals-17-scripting-part-4-parameters-running-remotely-and-formatting/index.md><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="PowerShell for IT Professionals [#17] – Scripting part 4 – parameters, running remotely and formatting"><meta property="og:description" content="In the last part of scripting series, we will make the script to be able to query remote machines, e.g. servers.
We will also check how to add parameters to the script (and configure the default value of parameter) so that user will able to pass the parameter name like in a standard PowerShell cmdlet.
Finally, we are going to format the script so that it looks more reliable and make some refactoring so that the logic is simpler."><meta property="og:type" content="article"><meta property="og:url" content="https://kamilpro.com/powershell-for-it-professionals-17-scripting-part-4-parameters-running-remotely-and-formatting/"><meta property="og:image" content="https://kamilpro.com/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-10-19T18:32:20+00:00"><meta property="article:modified_time" content="2022-01-03T19:48:21+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kamilpro.com/logo.png"><meta name=twitter:title content="PowerShell for IT Professionals [#17] – Scripting part 4 – parameters, running remotely and formatting"><meta name=twitter:description content="In the last part of scripting series, we will make the script to be able to query remote machines, e.g. servers.
We will also check how to add parameters to the script (and configure the default value of parameter) so that user will able to pass the parameter name like in a standard PowerShell cmdlet.
Finally, we are going to format the script so that it looks more reliable and make some refactoring so that the logic is simpler."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://kamilpro.com/posts/"},{"@type":"ListItem","position":3,"name":"PowerShell for IT Professionals [#17] – Scripting part 4 – parameters, running remotely and formatting","item":"https://kamilpro.com/powershell-for-it-professionals-17-scripting-part-4-parameters-running-remotely-and-formatting/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"PowerShell for IT Professionals [#17] – Scripting part 4 – parameters, running remotely and formatting","name":"PowerShell for IT Professionals [#17] – Scripting part 4 – parameters, running remotely and formatting","description":"In the last part of scripting series, we will make the script to be able to query remote machines, e.g. servers.\nWe will also check how to add parameters to the script (and configure the default value of parameter) so that user will able to pass the parameter name like in a standard PowerShell cmdlet.\nFinally, we are going to format the script so that it looks more reliable and make some refactoring so that the logic is simpler.","keywords":["command","course","first script","formatting","invoke","param","parameters","powershell","remote","script","scripting"],"articleBody":" In the last part of scripting series, we will make the script to be able to query remote machines, e.g. servers.\nWe will also check how to add parameters to the script (and configure the default value of parameter) so that user will able to pass the parameter name like in a standard PowerShell cmdlet.\nFinally, we are going to format the script so that it looks more reliable and make some refactoring so that the logic is simpler.\nExercises Convert all commandlets that have more than one parameter so that they are called with splatting Add another property to the $result so that it will include the time when information was gattered The $pingWebsite has a hardcoded value of ‘kamilpro.com’ – change it so that it uses a parameter instead If you have multiple computers in your lab, retrieve all computers from AD and use script to query them. Hint: you can use the command to retrieve all computers as a parameter for $ComputerName, in that case, you might need to wrap the command in ( ) brackets. Read about_Comment_Based_Help and add help to the script. You will need to add it at very top, above [cmdletbinding()], and wrap everything in \u003c# ////your help #\u003e. One of the keywords is .SYNOPSIS. Script 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 [cmdletbinding()] param( [string[]]$ComputerName = 'localhost' ) Invoke-Command -ComputerName $ComputerName -ScriptBlock { Write-Verbose \"Getting OS Info\" $OS = Get-CimInstance -ClassName Win32_OperatingSystem Write-Verbose \"Checking if its a server\" $server = $false IF ($os.Caption -like \"*Server*\") { $server = $true } Write-Verbose \"Retrieving IP configuration\" $Network = Get-NetAdapter | Where-Object { $_.Status -eq 'Up' } | Get-NetIPConfiguration Write-Verbose \"Last updates\" $Updates = Get-HotFix | Sort-Object InstalledOn -Descending | Select-Object -First 5 $result = \u0026#91;pscustomobject]@{ 'OSName' = $OS.Caption 'OSVersion' = $OS.Version 'OSInstallDate' = $OS.InstallDate 'isServer' = $Server 'IPv4Address' = $Network.IPv4Address.IPAddress 'Gateway' = $Network.IPv4DefaultGateway.nexthop 'DNS' = $Network.DNSServer | Where-Object { $_.AddressFamily -eq '2' } | Select-Object ServerADdresses -ExpandProperty ServerAddresses 'Updates' = $Updates.HotfixID | Out-String } Write-Verbose \"Checking network connectivity\" $pingGateway = Test-NetConnection -ComputerName $result.Gateway -InformationLevel Quiet $pingDNS = Test-NetConnection -ComputerName $result.DNS\u0026#91;0] -InformationLevel Quiet $pingWebsite = Test-NetConnection -ComputerName 'kamilpro.com' -InformationLevel Quiet $params = @{ MemberType = 'NoteProperty' Value = $pingGateway Name = 'pingGateway' } $result | Add-Member @params $result | Add-Member -MemberType NoteProperty -Value $pingDNS -Name 'pingDNS' $result | Add-Member -MemberType NoteProperty -Value $pingWebsite -Name 'pingWebsite' # Installed roles – server only IF ($result.isServer = $true) { $roles= Get-WindowsFeature | Where-Object { $_.Installed -eq $True -AND $_.FeatureType -eq 'Role' } | Select-Object Name -ExpandProperty Name $result | Add-Member -MemberType NoteProperty -Value $roles -Name 'Roles' } return $result } ","wordCount":"483","inLanguage":"en","datePublished":"2020-10-19T18:32:20Z","dateModified":"2022-01-03T19:48:21Z","author":{"@type":"Person","name":"Kamil"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://kamilpro.com/powershell-for-it-professionals-17-scripting-part-4-parameters-running-remotely-and-formatting/"},"publisher":{"@type":"Organization","name":"Kamil Pro","logo":{"@type":"ImageObject","url":"https://kamilpro.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://kamilpro.com accesskey=h title="Kamil Pro (Alt + H)">Kamil Pro</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://kamilpro.com/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://kamilpro.com/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://kamilpro.com/categories/ title=Categories><span>Categories</span></a></li><li><a href="https://www.youtube.com/playlist?list=PL-esmhgrps8Zv9bAHesStPRQ1AiUL1wY3" title="About PowerShell"><span>About PowerShell</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://kamilpro.com/powershell-for-it-professionals/ title="Powershell for IT professionals"><span>Powershell for IT professionals</span></a></li><li><a href=https://github.com/thekamilpro title=GitHub><span><i class='fab fa-github fa-fw'></i></span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>PowerShell for IT Professionals [#17] – Scripting part 4 – parameters, running remotely and formatting</h1><div class=post-meta><span title='2020-10-19 18:32:20 +0000 UTC'>2020-10-19</span>&nbsp;·&nbsp;Kamil</div></header><div class=post-content><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube-nocookie.com/embed/yJ7nmSjPABM style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><p>In the last part of scripting series, we will make the script to be able to query remote machines, e.g. servers.</p><p>We will also check how to add parameters to the script (and configure the default value of parameter) so that user will able to pass the parameter name like in a standard PowerShell cmdlet.</p><p>Finally, we are going to format the script so that it looks more reliable and make some refactoring so that the logic is simpler.</p><h2 id=exercises>Exercises<a hidden class=anchor aria-hidden=true href=#exercises>#</a></h2><ul><li>Convert all commandlets that have more than one parameter so that they are called with splatting</li><li>Add another property to the $result so that it will include the time when information was gattered</li><li>The $pingWebsite has a hardcoded value of ‘kamilpro.com’ – change it so that it uses a parameter instead</li><li>If you have multiple computers in your lab, retrieve all computers from AD and use script to query them. Hint: you can use the command to retrieve all computers as a parameter for $ComputerName, in that case, you might need to wrap the command in ( ) brackets.</li><li>Read about_Comment_Based_Help and add help to the script. You will need to add it at very top, above [cmdletbinding()], and wrap everything in &lt;# ////your help #>. One of the keywords is .SYNOPSIS.</li></ul><h2 id=script>Script<a hidden class=anchor aria-hidden=true href=#script>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=p>[</span><span class=nb>cmdletbinding</span><span class=p>()]</span>
</span></span><span class=line><span class=cl><span class=k>param</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=no>string[]</span><span class=p>]</span><span class=nv>$ComputerName</span> <span class=p>=</span> <span class=s1>&#39;localhost&#39;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Invoke-Command</span> <span class=n>-ComputerName</span> <span class=nv>$ComputerName</span> <span class=n>-ScriptBlock</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nb>Write-Verbose</span> <span class=s2>&#34;Getting OS Info&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>$OS</span> <span class=p>=</span> <span class=nb>Get-CimInstance</span> <span class=n>-ClassName</span> <span class=n>Win32_OperatingSystem</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>Write-Verbose</span> <span class=s2>&#34;Checking if its a server&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>$server</span> <span class=p>=</span> <span class=vm>$false</span>
</span></span><span class=line><span class=cl>    <span class=k>IF</span> <span class=p>(</span><span class=nv>$os</span><span class=p>.</span><span class=py>Caption</span> <span class=o>-like</span> <span class=s2>&#34;*Server*&#34;</span><span class=p>)</span> <span class=p>{</span> <span class=nv>$server</span> <span class=p>=</span> <span class=vm>$true</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nb>Write-Verbose</span> <span class=s2>&#34;Retrieving IP configuration&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>$Network</span> <span class=p>=</span> <span class=nb>Get-NetAdapter</span> <span class=p>|</span> 
</span></span><span class=line><span class=cl>        <span class=nb>Where-Object</span> <span class=p>{</span> <span class=nv>$_</span><span class=p>.</span><span class=py>Status</span> <span class=o>-eq</span> <span class=s1>&#39;Up&#39;</span> <span class=p>}</span> <span class=p>|</span> <span class=nb>Get-NetIPConfiguration</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>        <span class=nb>Write-Verbose</span> <span class=s2>&#34;Last updates&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>$Updates</span> <span class=p>=</span> <span class=nb>Get-HotFix</span> <span class=p>|</span> 
</span></span><span class=line><span class=cl>        <span class=nb>Sort-Object</span> <span class=n>InstalledOn</span> <span class=n>-Descending</span> <span class=p>|</span> <span class=nb>Select-Object</span> <span class=n>-First</span> <span class=mf>5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nv>$result</span> <span class=p>=</span> <span class=p>&amp;</span><span class=c>#91;pscustomobject]@{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;OSName&#39;</span>        <span class=p>=</span> <span class=nv>$OS</span><span class=p>.</span><span class=py>Caption</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;OSVersion&#39;</span>     <span class=p>=</span> <span class=nv>$OS</span><span class=p>.</span><span class=py>Version</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;OSInstallDate&#39;</span> <span class=p>=</span> <span class=nv>$OS</span><span class=p>.</span><span class=py>InstallDate</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;isServer&#39;</span>      <span class=p>=</span> <span class=nv>$Server</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;IPv4Address&#39;</span>   <span class=p>=</span> <span class=nv>$Network</span><span class=p>.</span><span class=py>IPv4Address</span><span class=p>.</span><span class=py>IPAddress</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Gateway&#39;</span>       <span class=p>=</span> <span class=nv>$Network</span><span class=p>.</span><span class=py>IPv4DefaultGateway</span><span class=p>.</span><span class=py>nexthop</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;DNS&#39;</span>           <span class=p>=</span> <span class=nv>$Network</span><span class=p>.</span><span class=py>DNSServer</span> <span class=p>|</span> <span class=nb>Where-Object</span> <span class=p>{</span> <span class=nv>$_</span><span class=p>.</span><span class=py>AddressFamily</span> <span class=o>-eq</span> <span class=s1>&#39;2&#39;</span> <span class=p>}</span> <span class=p>|</span> <span class=nb>Select-Object</span> <span class=n>ServerADdresses</span> <span class=n>-ExpandProperty</span> <span class=n>ServerAddresses</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;Updates&#39;</span>       <span class=p>=</span> <span class=nv>$Updates</span><span class=p>.</span><span class=py>HotfixID</span> <span class=p>|</span> <span class=nb>Out-String</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nb>Write-Verbose</span> <span class=s2>&#34;Checking network connectivity&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nv>$pingGateway</span> <span class=p>=</span> <span class=nb>Test-NetConnection</span> <span class=n>-ComputerName</span> <span class=nv>$result</span><span class=p>.</span><span class=py>Gateway</span> <span class=n>-InformationLevel</span> <span class=n>Quiet</span>
</span></span><span class=line><span class=cl>    <span class=nv>$pingDNS</span> <span class=p>=</span> <span class=nb>Test-NetConnection</span> <span class=n>-ComputerName</span> <span class=nv>$result</span><span class=p>.</span><span class=n>DNS</span><span class=p>&amp;</span><span class=c>#91;0] -InformationLevel Quiet</span>
</span></span><span class=line><span class=cl>    <span class=nv>$pingWebsite</span> <span class=p>=</span> <span class=nb>Test-NetConnection</span> <span class=n>-ComputerName</span> <span class=s1>&#39;kamilpro.com&#39;</span> <span class=n>-InformationLevel</span> <span class=n>Quiet</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nv>$params</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>MemberType</span> <span class=p>=</span> <span class=s1>&#39;NoteProperty&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>Value</span> <span class=p>=</span> <span class=nv>$pingGateway</span>
</span></span><span class=line><span class=cl>        <span class=n>Name</span> <span class=p>=</span> <span class=s1>&#39;pingGateway&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=nv>$result</span> <span class=p>|</span> <span class=nb>Add-Member</span> <span class=nv>@params</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=nv>$result</span> <span class=p>|</span> <span class=nb>Add-Member</span> <span class=n>-MemberType</span> <span class=n>NoteProperty</span> <span class=n>-Value</span> <span class=nv>$pingDNS</span> <span class=n>-Name</span> <span class=s1>&#39;pingDNS&#39;</span>
</span></span><span class=line><span class=cl>    <span class=nv>$result</span> <span class=p>|</span> <span class=nb>Add-Member</span> <span class=n>-MemberType</span> <span class=n>NoteProperty</span> <span class=n>-Value</span> <span class=nv>$pingWebsite</span> <span class=n>-Name</span> <span class=s1>&#39;pingWebsite&#39;</span>
</span></span><span class=line><span class=cl>    <span class=c># Installed roles – server only</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>IF</span> <span class=p>(</span><span class=nv>$result</span><span class=p>.</span><span class=py>isServer</span> <span class=p>=</span> <span class=vm>$true</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>$roles</span><span class=p>=</span> <span class=nb>Get-WindowsFeature</span> <span class=p>|</span> 
</span></span><span class=line><span class=cl>            <span class=nb>Where-Object</span> <span class=p>{</span> <span class=nv>$_</span><span class=p>.</span><span class=py>Installed</span> <span class=o>-eq</span> <span class=vm>$True</span> <span class=o>-AND</span> <span class=nv>$_</span><span class=p>.</span><span class=py>FeatureType</span> <span class=o>-eq</span> <span class=s1>&#39;Role&#39;</span> <span class=p>}</span> <span class=p>|</span>
</span></span><span class=line><span class=cl>            <span class=nb>Select-Object</span> <span class=n>Name</span> <span class=n>-ExpandProperty</span> <span class=n>Name</span>
</span></span><span class=line><span class=cl>        <span class=nv>$result</span> <span class=p>|</span> 
</span></span><span class=line><span class=cl>            <span class=nb>Add-Member</span> <span class=n>-MemberType</span> <span class=n>NoteProperty</span> <span class=n>-Value</span> <span class=nv>$roles</span> <span class=n>-Name</span> <span class=s1>&#39;Roles&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nv>$result</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://kamilpro.com/tags/command/>command</a></li><li><a href=https://kamilpro.com/tags/course/>course</a></li><li><a href=https://kamilpro.com/tags/first-script/>first script</a></li><li><a href=https://kamilpro.com/tags/formatting/>formatting</a></li><li><a href=https://kamilpro.com/tags/invoke/>invoke</a></li><li><a href=https://kamilpro.com/tags/param/>param</a></li><li><a href=https://kamilpro.com/tags/parameters/>parameters</a></li><li><a href=https://kamilpro.com/tags/powershell/>powershell</a></li><li><a href=https://kamilpro.com/tags/remote/>remote</a></li><li><a href=https://kamilpro.com/tags/script/>script</a></li><li><a href=https://kamilpro.com/tags/scripting/>scripting</a></li></ul></footer></article></main><footer class=footer><span>Kamil Procyszyn</span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>