<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Mastering PNPUTIL – how to add drivers to the Windows image | Kamil Pro</title><meta name=keywords content="deployment,driver,feat,image,Windows"><meta name=description content="Drivers – that’s what makes a harmony between hardware and software. Appropriate drivers can make a huge difference between computer’s performance, stability and even temperature. Therefore it’s super important to make sure you’ve got up-to-date files included with your image or Windows installation.
We are going to review PNPUTIL tool – the versatile tool for handling drivers within the Windows.
Why do you need PNPUTIL? Yes, why bother with some command line tool (PNPUTIL is command line only) when there are dedicated installers and device manager?"><meta name=author content="Kamil"><link rel=canonical href=https://kamilpro.github.io/mastering-pnputil-add-drivers-windows-image/><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://kamilpro.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://kamilpro.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://kamilpro.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://kamilpro.github.io/apple-touch-icon.png><link rel=mask-icon href=https://kamilpro.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=text/plain href=https://kamilpro.github.io/mastering-pnputil-add-drivers-windows-image/index.md><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Mastering PNPUTIL – how to add drivers to the Windows image"><meta property="og:description" content="Drivers – that’s what makes a harmony between hardware and software. Appropriate drivers can make a huge difference between computer’s performance, stability and even temperature. Therefore it’s super important to make sure you’ve got up-to-date files included with your image or Windows installation.
We are going to review PNPUTIL tool – the versatile tool for handling drivers within the Windows.
Why do you need PNPUTIL? Yes, why bother with some command line tool (PNPUTIL is command line only) when there are dedicated installers and device manager?"><meta property="og:type" content="article"><meta property="og:url" content="https://kamilpro.github.io/mastering-pnputil-add-drivers-windows-image/"><meta property="og:image" content="https://kamilpro.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-05-01T20:32:06+00:00"><meta property="article:modified_time" content="2022-01-03T19:48:21+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kamilpro.github.io/logo.png"><meta name=twitter:title content="Mastering PNPUTIL – how to add drivers to the Windows image"><meta name=twitter:description content="Drivers – that’s what makes a harmony between hardware and software. Appropriate drivers can make a huge difference between computer’s performance, stability and even temperature. Therefore it’s super important to make sure you’ve got up-to-date files included with your image or Windows installation.
We are going to review PNPUTIL tool – the versatile tool for handling drivers within the Windows.
Why do you need PNPUTIL? Yes, why bother with some command line tool (PNPUTIL is command line only) when there are dedicated installers and device manager?"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://kamilpro.github.io/posts/"},{"@type":"ListItem","position":3,"name":"Mastering PNPUTIL – how to add drivers to the Windows image","item":"https://kamilpro.github.io/mastering-pnputil-add-drivers-windows-image/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Mastering PNPUTIL – how to add drivers to the Windows image","name":"Mastering PNPUTIL – how to add drivers to the Windows image","description":"Drivers – that’s what makes a harmony between hardware and software. Appropriate drivers can make a huge difference between computer’s performance, stability and even temperature. Therefore it’s super important to make sure you’ve got up-to-date files included with your image or Windows installation.\nWe are going to review PNPUTIL tool – the versatile tool for handling drivers within the Windows.\nWhy do you need PNPUTIL? Yes, why bother with some command line tool (PNPUTIL is command line only) when there are dedicated installers and device manager?","keywords":["deployment","driver","feat","image","Windows"],"articleBody":"Drivers – that’s what makes a harmony between hardware and software. Appropriate drivers can make a huge difference between computer’s performance, stability and even temperature. Therefore it’s super important to make sure you’ve got up-to-date files included with your image or Windows installation.\nWe are going to review PNPUTIL tool – the versatile tool for handling drivers within the Windows.\nWhy do you need PNPUTIL? Yes, why bother with some command line tool (PNPUTIL is command line only) when there are dedicated installers and device manager? Not to mention that Windows update can download pretty much every single driver missing from the Internet.\nWell, it’s not that wonderful when there is a need to prepare a couple of dozens of computers.\nWhile all sort of installers need hardware to be present during the installation, PNPUTIL doesn’t. In fact, as long as you can provide driver files – *.inf to be more specific – you can add them to the image, and Windows will use them when it has detected the hardware.\nThat allows you to supply drivers before installing Windows on the target computer, which saves time after deployment. Drivers will be therefore installed automatically during Windows installation – fully automatically.\nWhat is the Driver Store Windows needs to store all the drivers in one location. Whenever you add, install, update or remove drivers, the OS will use the Driver Store as well as Windows Update to make your devices work properly.\nTake any driver, and you’ll find (among other files) at least one *.inf file. Windows will use the file to install the driver, using reference in the file to make sure that everything has been installed properly.\nAnother important task of adding new drivers to the driver store is security check of the file, making sure that the driver hasn’t been changed since developer released it.\nYou can find driver store in: C:\\Windows\\System32\\DriverStore.\nAdding vs Installing While these words are usually used interchangeably, they have a different meaning in Microsoft terminology.\nAdding means copying the driver and associated with it files to the Driver Store. During that process, all files will be checked for integrity and security. Adding the driver will not make your device working straight away, Windows will need to install it.\nInstalling means using the added driver for the actual hardware. Whenever computer detects a new hardware connected, it will go through the Driver Store/Windows Update and set up the device, provided there is a matching driver available.\nYou can think about it like having spices in your kitchen. When you go to shops you buy pepper, salt, sage, paprika and rosemary. This can be compared to downloading the drivers. Then you unpack these spices and put them in your cupboard. This is adding drivers to the store. Finally, you cook chicken and realise the salt, pepper and paprika will be necessary for it, so you take these spices out of the cupboard and season your chicken. This is installing the drivers.\nI’m getting hungry now, so let’s better move on to the next step.\nPNPUTIL syntax There are only 4 main syntaxes in PNPUTIL, which allow you to add, remove, export and list all the drivers currently in the driver store.\nWhen you’ll open the command prompt, type PNPUTIL and see:\n/add-driver [/subdirs] [/install] Add driver package(s) into the driver store. /subdirs - traverse sub directories for driver packages. /install - install/update drivers on any matching devices. /delete-driver [/force] Delete driver package from the driver store. /force - delete driver package even when it is in use by devices. /export-driver Export driver package(s) from the driver store into a target directory. /enum-drivers Enumerate all 3rd party driver packages in the driver store. Add /add-driver option allows you to add a driver to the store. If you provide specific INF file, only one driver will be copied, however using a wildcard *.inf will install all drivers within the current directory. You can also use /subdirs to do bulk load to all files in the child folders. Last option /install will install or update the drivers, however, Windows should perform it automatically once the devices have been detected.\nDelete Sometimes you’d like to remove a certain device from the device manager, but it keeps coming back with maniac’s resistance. The reason is the device is being only installed, but the actual files are present in the driver store.\nThat’s when you’d like to use **/delete-driver **with /**force **option. It will uninstall and purge the files from the driver store, even if the device is currently used.\nExport /export-driver is especially useful when you need to copy drivers from one computer to another, while not having the original driver source available. PNPUTIL will create an exact copy of the driver being used in the current system, which you’ll be able to add to another computer later on.\nEnumerate /enum-drivers will show you the list of all drivers in currently being kept in the driver store. You’ll be able to find the type, vendor, version and name of the driver.\nAll drivers will have the OemXX.inf naming convention, while XX is the unique number of the each driver. You can use that tool to identify drivers which you’d like to remove or export.\nHints/More stuff to read You can use command PNPUTIL /enum-drivers \u003e C:\\temp\\drivers.txt to create a file with the list of all current drivers. You can find names of drivers in Device Manager. Simply click the device you’d need the drivers for, pick details tab and choose “inf name” from the drop down menu. I did write more about creating the Windows 10 image here – https://kamilpro.com/prepare-windows-10-1607-image/. ","wordCount":"950","inLanguage":"en","datePublished":"2017-05-01T20:32:06Z","dateModified":"2022-01-03T19:48:21Z","author":{"@type":"Person","name":"Kamil"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://kamilpro.github.io/mastering-pnputil-add-drivers-windows-image/"},"publisher":{"@type":"Organization","name":"Kamil Pro","logo":{"@type":"ImageObject","url":"https://kamilpro.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://kamilpro.github.io accesskey=h title="Kamil Pro (Alt + H)">Kamil Pro</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://kamilpro.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://kamilpro.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://kamilpro.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href="https://www.youtube.com/playlist?list=PL-esmhgrps8Zv9bAHesStPRQ1AiUL1wY3" title="About PowerShell"><span>About PowerShell</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://kamilpro.github.io/powershell-for-it-professionals/ title="Powershell for IT professionals"><span>Powershell for IT professionals</span></a></li><li><a href=https://github.com/thekamilpro title=GitHub><span><i class='fab fa-github fa-fw'></i></span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Mastering PNPUTIL – how to add drivers to the Windows image</h1><div class=post-meta><span title='2017-05-01 20:32:06 +0000 UTC'>2017-05-01</span>&nbsp;·&nbsp;Kamil</div></header><div class=post-content><p>Drivers – that’s what makes a harmony between hardware and software. Appropriate drivers can make a huge difference between computer’s performance, stability and even temperature. Therefore it’s super important to make sure you’ve got up-to-date files included with your image or Windows installation.</p><p>We are going to review PNPUTIL tool – the versatile tool for handling drivers within the Windows.</p><h1 id=why-do-you-need-pnputil>Why do you need PNPUTIL?<a hidden class=anchor aria-hidden=true href=#why-do-you-need-pnputil>#</a></h1><p>Yes, why bother with some command line tool (PNPUTIL is command line only) when there are dedicated installers and device manager? Not to mention that Windows update can download pretty much every single driver missing from the Internet.</p><p>Well, it’s not that wonderful when there is a need to prepare a couple of dozens of computers.</p><p>While all sort of installers need hardware to be present during the installation, PNPUTIL doesn’t. In fact, as long as you can provide driver files – *.inf to be more specific – you can add them to the image, and Windows will use them when it has detected the hardware.</p><p>That allows you to supply drivers before installing Windows on the target computer, which saves time after deployment. Drivers will be therefore installed automatically during Windows installation – fully automatically.</p><h1 id=what-is-the-driver-store>What is the Driver Store<a hidden class=anchor aria-hidden=true href=#what-is-the-driver-store>#</a></h1><p>Windows needs to store all the drivers in one location. Whenever you add, install, update or remove drivers, the OS will use the Driver Store as well as Windows Update to make your devices work properly.</p><p>Take any driver, and you’ll find (among other files) at least one *.inf file. Windows will use the file to install the driver, using reference in the file to make sure that everything has been installed properly.</p><p>Another important task of adding new drivers to the driver store is security check of the file, making sure that the driver hasn’t been changed since developer released it.</p><p>You can find driver store in: C:\Windows\System32\DriverStore.</p><h1 id=adding-vs-installing>Adding vs Installing<a hidden class=anchor aria-hidden=true href=#adding-vs-installing>#</a></h1><p>While these words are usually used interchangeably, they have a different meaning in Microsoft terminology.</p><p>Adding means copying the driver and associated with it files to the Driver Store. During that process, all files will be checked for integrity and security. Adding the driver will not make your device working straight away, Windows will need to install it.</p><p>Installing means using the <em>added</em> driver for the actual hardware. Whenever computer detects a new hardware connected, it will go through the Driver Store/Windows Update and set up the device, provided there is a matching driver available.</p><p>You can think about it like having spices in your kitchen. When you go to shops you buy pepper, salt, sage, paprika and rosemary. This can be compared to downloading the drivers. Then you unpack these spices and put them in your cupboard. This is adding drivers to the store. Finally, you cook chicken and realise the salt, pepper and paprika will be necessary for it, so you take these spices out of the cupboard and season your chicken. This is installing the drivers.</p><p>I’m getting hungry now, so let’s better move on to the next step.</p><h1 id=pnputil-syntax>PNPUTIL syntax<a hidden class=anchor aria-hidden=true href=#pnputil-syntax>#</a></h1><p>There are only 4 main syntaxes in PNPUTIL, which allow you to add, remove, export and list all the drivers currently in the driver store.</p><p>When you’ll open the command prompt, type PNPUTIL and see:</p><pre><strong>/add-driver</strong> &lt;filename.inf | *.inf&gt; [/subdirs] [/install]

Add driver package(s) into the driver store.
 /subdirs - traverse sub directories for driver packages.
 /install - install/update drivers on any matching devices.

<strong>/delete-driver</strong> &lt;oem#.inf&gt; [/force]

Delete driver package from the driver store.
 /force - delete driver package even when it is in use by devices.

<strong>/export-driver</strong> &lt;oem#.inf | *&gt; &lt;target directory&gt;

Export driver package(s) from the driver store into a target directory.

<strong>/enum-drivers</strong>

Enumerate all 3rd party driver packages in the driver store.</pre><h2 id=add>Add<a hidden class=anchor aria-hidden=true href=#add>#</a></h2><p><strong>/add-driver</strong> option allows you to add a driver to the store. If you provide specific INF file, only one driver will be copied, however using a wildcard *.inf will install all drivers within the current directory. You can also use <strong>/subdirs</strong> to do bulk load to all files in the child folders.  Last option <strong>/install</strong> will install or update the drivers, however, Windows should perform it automatically once the devices have been detected.</p><h2 id=delete>Delete<a hidden class=anchor aria-hidden=true href=#delete>#</a></h2><p>Sometimes you’d like to remove a certain device from the device manager, but it keeps coming back with maniac’s resistance. The reason is the device is being only installed, but the actual files are present in the driver store.</p><p>That’s when you’d like to use **/delete-driver **with  /**force **option. It will uninstall and purge the files from the driver store, even if the device is currently used.</p><h2 id=export>Export<a hidden class=anchor aria-hidden=true href=#export>#</a></h2><p><strong>/export-driver</strong> is especially useful when you need to copy drivers from one computer to another, while not having the original driver source available. PNPUTIL will create an exact copy of the driver being used in the current system, which you’ll be able to add to another computer later on.</p><h2 id=enumerate>Enumerate<a hidden class=anchor aria-hidden=true href=#enumerate>#</a></h2><p><strong>/enum-drivers</strong> will show you the list of all drivers in currently being kept in the driver store. You’ll be able to find the type, vendor, version and name of the driver.</p><p>All drivers will have the OemXX.inf naming convention, while XX is the unique number of the each driver. You can use that tool to identify drivers which you’d like to remove or export.</p><h1 id=hintsmore-stuff-to-read>Hints/More stuff to read<a hidden class=anchor aria-hidden=true href=#hintsmore-stuff-to-read>#</a></h1><ul><li>You can use command <strong>PNPUTIL /enum-drivers > C:\temp\drivers.txt</strong> to create a file with the list of all current drivers.</li><li>You can find names of drivers in Device Manager. Simply click the device you’d need the drivers for, pick details tab and choose “inf name” from the drop down menu.</li><li>I did write more about creating the Windows 10 image here – <a href=https://kamilpro.com/prepare-windows-10-1607-image/ target=_blank rel="noopener noreferrer"><a href=https://kamilpro.com/prepare-windows-10-1607-image/>https://kamilpro.com/prepare-windows-10-1607-image/</a></a>.</li></ul></div><footer class=post-footer><ul class=post-tags><li><a href=https://kamilpro.github.io/tags/deployment/>deployment</a></li><li><a href=https://kamilpro.github.io/tags/driver/>driver</a></li><li><a href=https://kamilpro.github.io/tags/feat/>feat</a></li><li><a href=https://kamilpro.github.io/tags/image/>image</a></li><li><a href=https://kamilpro.github.io/tags/windows/>Windows</a></li></ul></footer></article></main><footer class=footer><span>Kamil Procyszyn</span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>