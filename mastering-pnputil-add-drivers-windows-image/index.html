<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Mastering PNPUTIL – how to add drivers to the Windows image - Kamil Pro</title><meta name=Description content="Sysadmin's point of view"><meta property="og:title" content="Mastering PNPUTIL – how to add drivers to the Windows image"><meta property="og:description" content="Drivers – that’s what makes a harmony between hardware and software. Appropriate drivers can make a huge difference between computer’s performance, stability and even temperature. Therefore it’s super important to make sure you’ve got up-to-date files included with your image or Windows installation.
We are going to review PNPUTIL tool – the versatile tool for handling drivers within the Windows.
Why do you need PNPUTIL? Yes, why bother with some command line tool (PNPUTIL is command line only) when there are dedicated installers and device manager?"><meta property="og:type" content="article"><meta property="og:url" content="https://kamilpro.github.io/mastering-pnputil-add-drivers-windows-image/"><meta property="og:image" content="https://kamilpro.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-05-01T20:32:06+00:00"><meta property="article:modified_time" content="2022-01-03T19:48:21+00:00"><meta property="og:site_name" content="My cool site"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kamilpro.github.io/logo.png"><meta name=twitter:title content="Mastering PNPUTIL – how to add drivers to the Windows image"><meta name=twitter:description content="Drivers – that’s what makes a harmony between hardware and software. Appropriate drivers can make a huge difference between computer’s performance, stability and even temperature. Therefore it’s super important to make sure you’ve got up-to-date files included with your image or Windows installation.
We are going to review PNPUTIL tool – the versatile tool for handling drivers within the Windows.
Why do you need PNPUTIL? Yes, why bother with some command line tool (PNPUTIL is command line only) when there are dedicated installers and device manager?"><meta name=application-name content="Kamil Pro"><meta name=apple-mobile-web-app-title content="Kamil Pro"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://kamilpro.github.io/mastering-pnputil-add-drivers-windows-image/><link rel=prev href=https://kamilpro.github.io/why-saturday-is-best-to-start-new-hobby/><link rel=next href=https://kamilpro.github.io/start-batching-your-tasks/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><meta name=google-site-verification content="NniR9DFiwo_hSUsjXQj7xw3IHmRtl0ICeu4UmstK680"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Mastering PNPUTIL – how to add drivers to the Windows image","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/kamilpro.github.io\/mastering-pnputil-add-drivers-windows-image\/"},"image":["https:\/\/kamilpro.github.io\/images\/Apple-Devices-Preview.png"],"genre":"posts","keywords":"deployment, driver, feat, image, Windows","wordcount":950,"url":"https:\/\/kamilpro.github.io\/mastering-pnputil-add-drivers-windows-image\/","datePublished":"2017-05-01T20:32:06+00:00","dateModified":"2022-01-03T19:48:21+00:00","license":"Kamil Procyszyn","publisher":{"@type":"Organization","name":"Kamil Pro","logo":{"@type":"ImageObject","url":"https:\/\/kamilpro.github.io\/images\/avatar.png","width":150,"height":150}},"author":{"@type":"Person","name":"Kamil"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Kamil Pro">Kamil Pro<span class=header-title-post><i class='fas fa-terminal'></i></span></a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href="https://www.youtube.com/playlist?list=PL-esmhgrps8Zv9bAHesStPRQ1AiUL1wY3" rel="noopener noreffer" target=_blank>About PowerShell </a><a class=menu-item href=/powershell-for-it-professionals/>Powershell for IT professionals </a><a class=menu-item href=/about/>About </a><a class=menu-item href=https://github.com/thekamilpro title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw'></i> </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Kamil Pro">Kamil Pro<span class=header-title-post><i class='fas fa-terminal'></i></span></a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href="https://www.youtube.com/playlist?list=PL-esmhgrps8Zv9bAHesStPRQ1AiUL1wY3" title rel="noopener noreffer" target=_blank>About PowerShell</a><a class=menu-item href=/powershell-for-it-professionals/ title>Powershell for IT professionals</a><a class=menu-item href=/about/ title>About</a><a class=menu-item href=https://github.com/thekamilpro title=GitHub rel="noopener noreffer" target=_blank><i class='fab fa-github fa-fw'></i></a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Mastering PNPUTIL – how to add drivers to the Windows image</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Kamil</a></span>&nbsp;<span class=post-category>included in <a href=/categories/deployment/><i class="far fa-folder fa-fw" aria-hidden=true></i>Deployment</a>&nbsp;<a href=/categories/it/><i class="far fa-folder fa-fw" aria-hidden=true></i>IT</a>&nbsp;<a href=/categories/windows/><i class="far fa-folder fa-fw" aria-hidden=true></i>Windows</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2017-05-01>2017-05-01</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;950 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;5 minutes&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=/wp-content/uploads/2017/05/wil-stewart-21815.jpg data-srcset="/wp-content/uploads/2017/05/wil-stewart-21815.jpg, /wp-content/uploads/2017/05/wil-stewart-21815.jpg 1.5x, /wp-content/uploads/2017/05/wil-stewart-21815.jpg 2x" data-sizes=auto alt=/wp-content/uploads/2017/05/wil-stewart-21815.jpg title=/wp-content/uploads/2017/05/wil-stewart-21815.jpg></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#add>Add</a></li><li><a href=#delete>Delete</a></li><li><a href=#export>Export</a></li><li><a href=#enumerate>Enumerate</a></li></ul></nav></div></div><div class=content id=content><p>Drivers – that’s what makes a harmony between hardware and software. Appropriate drivers can make a huge difference between computer’s performance, stability and even temperature. Therefore it’s super important to make sure you’ve got up-to-date files included with your image or Windows installation.</p><p>We are going to review PNPUTIL tool – the versatile tool for handling drivers within the Windows.</p><h1 id=why-do-you-need-pnputil>Why do you need PNPUTIL?</h1><p>Yes, why bother with some command line tool (PNPUTIL is command line only) when there are dedicated installers and device manager? Not to mention that Windows update can download pretty much every single driver missing from the Internet.</p><p>Well, it’s not that wonderful when there is a need to prepare a couple of dozens of computers.</p><p>While all sort of installers need hardware to be present during the installation, PNPUTIL doesn’t. In fact, as long as you can provide driver files – *.inf to be more specific – you can add them to the image, and Windows will use them when it has detected the hardware.</p><p>That allows you to supply drivers before installing Windows on the target computer, which saves time after deployment. Drivers will be therefore installed automatically during Windows installation – fully automatically.</p><h1 id=what-is-the-driver-store>What is the Driver Store</h1><p>Windows needs to store all the drivers in one location. Whenever you add, install, update or remove drivers, the OS will use the Driver Store as well as Windows Update to make your devices work properly.</p><p>Take any driver, and you’ll find (among other files) at least one *.inf file. Windows will use the file to install the driver, using reference in the file to make sure that everything has been installed properly.</p><p>Another important task of adding new drivers to the driver store is security check of the file, making sure that the driver hasn’t been changed since developer released it.</p><p>You can find driver store in: C:\Windows\System32\DriverStore.</p><h1 id=adding-vs-installing>Adding vs Installing</h1><p>While these words are usually used interchangeably, they have a different meaning in Microsoft terminology.</p><p>Adding means copying the driver and associated with it files to the Driver Store. During that process, all files will be checked for integrity and security. Adding the driver will not make your device working straight away, Windows will need to install it.</p><p>Installing means using the <em>added</em> driver for the actual hardware. Whenever computer detects a new hardware connected, it will go through the Driver Store/Windows Update and set up the device, provided there is a matching driver available.</p><p>You can think about it like having spices in your kitchen. When you go to shops you buy pepper, salt, sage, paprika and rosemary. This can be compared to downloading the drivers. Then you unpack these spices and put them in your cupboard. This is adding drivers to the store. Finally, you cook chicken and realise the salt, pepper and paprika will be necessary for it, so you take these spices out of the cupboard and season your chicken. This is installing the drivers.</p><p>I’m getting hungry now, so let’s better move on to the next step.</p><h1 id=pnputil-syntax>PNPUTIL syntax</h1><p>There are only 4 main syntaxes in PNPUTIL, which allow you to add, remove, export and list all the drivers currently in the driver store.</p><p>When you’ll open the command prompt, type PNPUTIL and see:</p><pre><strong>/add-driver</strong> &lt;filename.inf | *.inf&gt; [/subdirs] [/install]

Add driver package(s) into the driver store.
 /subdirs - traverse sub directories for driver packages.
 /install - install/update drivers on any matching devices.

<strong>/delete-driver</strong> &lt;oem#.inf&gt; [/force]

Delete driver package from the driver store.
 /force - delete driver package even when it is in use by devices.

<strong>/export-driver</strong> &lt;oem#.inf | *&gt; &lt;target directory&gt;

Export driver package(s) from the driver store into a target directory.

<strong>/enum-drivers</strong>

Enumerate all 3rd party driver packages in the driver store.</pre><h2 id=add>Add</h2><p><strong>/add-driver</strong> option allows you to add a driver to the store. If you provide specific INF file, only one driver will be copied, however using a wildcard *.inf will install all drivers within the current directory. You can also use <strong>/subdirs</strong> to do bulk load to all files in the child folders.  Last option <strong>/install</strong> will install or update the drivers, however, Windows should perform it automatically once the devices have been detected.</p><h2 id=delete>Delete</h2><p>Sometimes you’d like to remove a certain device from the device manager, but it keeps coming back with maniac’s resistance. The reason is the device is being only installed, but the actual files are present in the driver store.</p><p>That’s when you’d like to use **/delete-driver **with  /**force **option. It will uninstall and purge the files from the driver store, even if the device is currently used.</p><h2 id=export>Export</h2><p><strong>/export-driver</strong> is especially useful when you need to copy drivers from one computer to another, while not having the original driver source available. PNPUTIL will create an exact copy of the driver being used in the current system, which you’ll be able to add to another computer later on.</p><h2 id=enumerate>Enumerate</h2><p><strong>/enum-drivers</strong> will show you the list of all drivers in currently being kept in the driver store. You’ll be able to find the type, vendor, version and name of the driver.</p><p>All drivers will have the OemXX.inf naming convention, while XX is the unique number of the each driver. You can use that tool to identify drivers which you’d like to remove or export.</p><h1 id=hintsmore-stuff-to-read>Hints/More stuff to read</h1><ul><li>You can use command <strong>PNPUTIL /enum-drivers > C:\temp\drivers.txt</strong> to create a file with the list of all current drivers.</li><li>You can find names of drivers in Device Manager. Simply click the device you’d need the drivers for, pick details tab and choose “inf name” from the drop down menu.</li><li>I did write more about creating the Windows 10 image here – <a href=https://kamilpro.com/prepare-windows-10-1607-image/ target=_blank rel="noopener noreferrer"><a href=https://kamilpro.com/prepare-windows-10-1607-image/ target=_blank rel="noopener noreffer">https://kamilpro.com/prepare-windows-10-1607-image/</a></a>.</li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-01-03&nbsp;<a class=git-hash href=https://github.com/thekamilpro/commit/dfb5243d796d93396da474840d2b2063421897ad target=_blank title="commit by Kamil Procyszyn(kprocyszyn@gmail.com) dfb5243d796d93396da474840d2b2063421897ad: Add featured images">
<i class="fas fa-hashtag fa-fw" aria-hidden=true></i>dfb5243</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/mastering-pnputil-add-drivers-windows-image/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://kamilpro.github.io/mastering-pnputil-add-drivers-windows-image/ data-title="Mastering PNPUTIL – how to add drivers to the Windows image" data-via=@thekamilpro data-hashtags=deployment,driver,feat,image,Windows><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://kamilpro.github.io/mastering-pnputil-add-drivers-windows-image/ data-hashtag=deployment><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://kamilpro.github.io/mastering-pnputil-add-drivers-windows-image/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on WhatsApp" data-sharer=whatsapp data-url=https://kamilpro.github.io/mastering-pnputil-add-drivers-windows-image/ data-title="Mastering PNPUTIL – how to add drivers to the Windows image" data-web><i class="fab fa-whatsapp fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://kamilpro.github.io/mastering-pnputil-add-drivers-windows-image/ data-title="Mastering PNPUTIL – how to add drivers to the Windows image"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://kamilpro.github.io/mastering-pnputil-add-drivers-windows-image/><i class="fab fa-reddit fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://kamilpro.github.io/mastering-pnputil-add-drivers-windows-image/ data-title="Mastering PNPUTIL – how to add drivers to the Windows image" data-image=/wp-content/uploads/2017/05/wil-stewart-21815.jpg><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/deployment/>deployment</a>,&nbsp;<a href=/tags/driver/>driver</a>,&nbsp;<a href=/tags/feat/>feat</a>,&nbsp;<a href=/tags/image/>image</a>,&nbsp;<a href=/tags/windows/>Windows</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/why-saturday-is-best-to-start-new-hobby/ class=prev rel=prev title="Why Saturday is best to start new hobby."><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Why Saturday is best to start new hobby.</a>
<a href=/start-batching-your-tasks/ class=next rel=next title="Do you check email every 2 minutes? Start batching your tasks">Do you check email every 2 minutes? Start batching your tasks<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=utterances class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://utteranc.es/>utterances</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.102.3">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2014 - 2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Kamil Pro</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:10},comment:{utterances:{darkTheme:"github-dark",issueTerm:"pathname",label:"Comment",lightTheme:"github-light",repo:"thekamilpro/kamilpro.github.io"}},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-64576368-1",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=UA-64576368-1" async></script></body></html>