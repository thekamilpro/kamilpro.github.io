<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>PowerShell for IT Professionals [#15] – Scripting part 2 – IF and psobject | Kamil Pro</title><meta name=keywords content="course,custom,else,first script,hash table,if,object,powershell,ps1,psobject,script,video,write-host"><meta name=description content="In this lesson we carry on writing the scripting by gathering requirements and putting them together as comments in code.
Then we will retrieve OS information with the help of WMI and display it on the screen with Write-Host.
Although using Write-Host is easy to use, it doesn’t really allow us to do very much e.g. we cannot export information to the CSV, therefore we change it and start using custom PSObject – that way our script will start returning information like a regular PowerShell command."><meta name=author content="Kamil"><link rel=canonical href=https://kamilpro.github.io/powershell-for-it-professionals-15-scripting-part-2-if-and-psobject/><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://kamilpro.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://kamilpro.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://kamilpro.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://kamilpro.github.io/apple-touch-icon.png><link rel=mask-icon href=https://kamilpro.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=text/plain href=https://kamilpro.github.io/powershell-for-it-professionals-15-scripting-part-2-if-and-psobject/index.md><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="PowerShell for IT Professionals [#15] – Scripting part 2 – IF and psobject"><meta property="og:description" content="In this lesson we carry on writing the scripting by gathering requirements and putting them together as comments in code.
Then we will retrieve OS information with the help of WMI and display it on the screen with Write-Host.
Although using Write-Host is easy to use, it doesn’t really allow us to do very much e.g. we cannot export information to the CSV, therefore we change it and start using custom PSObject – that way our script will start returning information like a regular PowerShell command."><meta property="og:type" content="article"><meta property="og:url" content="https://kamilpro.github.io/powershell-for-it-professionals-15-scripting-part-2-if-and-psobject/"><meta property="og:image" content="https://kamilpro.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-10-05T17:16:21+00:00"><meta property="article:modified_time" content="2022-01-03T19:48:21+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kamilpro.github.io/logo.png"><meta name=twitter:title content="PowerShell for IT Professionals [#15] – Scripting part 2 – IF and psobject"><meta name=twitter:description content="In this lesson we carry on writing the scripting by gathering requirements and putting them together as comments in code.
Then we will retrieve OS information with the help of WMI and display it on the screen with Write-Host.
Although using Write-Host is easy to use, it doesn’t really allow us to do very much e.g. we cannot export information to the CSV, therefore we change it and start using custom PSObject – that way our script will start returning information like a regular PowerShell command."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://kamilpro.github.io/posts/"},{"@type":"ListItem","position":3,"name":"PowerShell for IT Professionals [#15] – Scripting part 2 – IF and psobject","item":"https://kamilpro.github.io/powershell-for-it-professionals-15-scripting-part-2-if-and-psobject/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"PowerShell for IT Professionals [#15] – Scripting part 2 – IF and psobject","name":"PowerShell for IT Professionals [#15] – Scripting part 2 – IF and psobject","description":"In this lesson we carry on writing the scripting by gathering requirements and putting them together as comments in code.\nThen we will retrieve OS information with the help of WMI and display it on the screen with Write-Host.\nAlthough using Write-Host is easy to use, it doesn’t really allow us to do very much e.g. we cannot export information to the CSV, therefore we change it and start using custom PSObject – that way our script will start returning information like a regular PowerShell command.","keywords":["course","custom","else","first script","hash table","if","object","powershell","ps1","psobject","script","video","write-host"],"articleBody":" In this lesson we carry on writing the scripting by gathering requirements and putting them together as comments in code.\nThen we will retrieve OS information with the help of WMI and display it on the screen with Write-Host.\nAlthough using Write-Host is easy to use, it doesn’t really allow us to do very much e.g. we cannot export information to the CSV, therefore we change it and start using custom PSObject – that way our script will start returning information like a regular PowerShell command.\nFinally, we will use an IF statement to decide whether the OS we are checking is a server.\nReference IF statement\nPS Custom Object\nHash table\nScript 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 $OS = Get-CimInstance -ClassName Win32_OperatingSystem # OS Name Write-Host \"OS Name: $($OS.Caption)\" # Version Write-Host \"OS Version: $($OS.Version)\" # Install Date Write-Host \"OS Install date: $($OS.InstallDate)\" # Client/Server IF ($os.Caption -like \"*Server*\") { $server = $true } else { $server = $false} # IP: Interface, ip, gateway, dns # Network: Can I ping gateway, DNS Server, website # Installed roles – server only # Last updates # It would be nice if could run this remotely $props = [pscustomobject]@{ 'OSName' = $OS.Caption 'OSVersion' = $OS.Version 'OSInstallDate' = $OS.InstallDate 'isServer' = $Server } $props ","wordCount":"228","inLanguage":"en","datePublished":"2020-10-05T17:16:21Z","dateModified":"2022-01-03T19:48:21Z","author":{"@type":"Person","name":"Kamil"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://kamilpro.github.io/powershell-for-it-professionals-15-scripting-part-2-if-and-psobject/"},"publisher":{"@type":"Organization","name":"Kamil Pro","logo":{"@type":"ImageObject","url":"https://kamilpro.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://kamilpro.github.io accesskey=h title="Kamil Pro (Alt + H)">Kamil Pro</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://kamilpro.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://kamilpro.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://kamilpro.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href="https://www.youtube.com/playlist?list=PL-esmhgrps8Zv9bAHesStPRQ1AiUL1wY3" title="About PowerShell"><span>About PowerShell</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://kamilpro.github.io/powershell-for-it-professionals/ title="Powershell for IT professionals"><span>Powershell for IT professionals</span></a></li><li><a href=https://github.com/thekamilpro title=GitHub><span><i class='fab fa-github fa-fw'></i></span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>PowerShell for IT Professionals [#15] – Scripting part 2 – IF and psobject</h1><div class=post-meta><span title='2020-10-05 17:16:21 +0000 UTC'>2020-10-05</span>&nbsp;·&nbsp;Kamil</div></header><div class=post-content><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube-nocookie.com/embed/FVXEhZAz_YU style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><p>In this lesson we carry on writing the scripting by gathering requirements and putting them together as comments in code.</p><p>Then we will retrieve OS information with the help of WMI and display it on the screen with Write-Host.</p><p>Although using Write-Host is easy to use, it doesn’t really allow us to do very much e.g. we cannot export information to the CSV, therefore we change it and start using custom PSObject – that way our script will start returning information like a regular PowerShell command.</p><p>Finally, we will use an IF statement to decide whether the OS we are checking is a server.</p><h2 id=reference>Reference<a hidden class=anchor aria-hidden=true href=#reference>#</a></h2><p><a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_if?view=powershell-7" target=_blank rel="noreferrer noopener">IF statement</a></p><p><a rel="noreferrer noopener" href="https://docs.microsoft.com/en-us/powershell/scripting/learn/deep-dives/everything-about-pscustomobject?view=powershell-7" target=_blank>PS Custom Object</a></p><p><a rel="noreferrer noopener" href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_hash_tables?view=powershell-7" target=_blank>Hash table</a></p><h2 id=script>Script<a hidden class=anchor aria-hidden=true href=#script>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$OS</span> <span class=p>=</span> <span class=nb>Get-CimInstance</span> <span class=n>-ClassName</span> <span class=n>Win32_OperatingSystem</span>
</span></span><span class=line><span class=cl><span class=c># OS Name</span>
</span></span><span class=line><span class=cl><span class=nb>Write-Host</span> <span class=s2>&#34;OS Name: </span><span class=p>$(</span><span class=nv>$OS</span><span class=p>.</span><span class=n>Caption</span><span class=p>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=c># Version</span>
</span></span><span class=line><span class=cl><span class=nb>Write-Host</span> <span class=s2>&#34;OS Version: </span><span class=p>$(</span><span class=nv>$OS</span><span class=p>.</span><span class=n>Version</span><span class=p>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=c># Install Date</span>
</span></span><span class=line><span class=cl><span class=nb>Write-Host</span> <span class=s2>&#34;OS Install date: </span><span class=p>$(</span><span class=nv>$OS</span><span class=p>.</span><span class=n>InstallDate</span><span class=p>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=c># Client/Server</span>
</span></span><span class=line><span class=cl><span class=k>IF</span> <span class=p>(</span><span class=nv>$os</span><span class=p>.</span><span class=py>Caption</span> <span class=o>-like</span> <span class=s2>&#34;*Server*&#34;</span><span class=p>)</span> <span class=p>{</span> <span class=nv>$server</span> <span class=p>=</span> <span class=vm>$true</span> <span class=p>}</span> <span class=k>else</span> <span class=p>{</span> <span class=nv>$server</span> <span class=p>=</span> <span class=vm>$false</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c># IP: Interface, ip, gateway, dns</span>
</span></span><span class=line><span class=cl><span class=c># Network: Can I ping gateway, DNS Server, website</span>
</span></span><span class=line><span class=cl><span class=c># Installed roles – server only</span>
</span></span><span class=line><span class=cl><span class=c># Last updates</span>
</span></span><span class=line><span class=cl><span class=c># It would be nice if could run this remotely </span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$props</span> <span class=p>=</span> <span class=p>[</span><span class=no>pscustomobject</span><span class=p>]</span><span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;OSName&#39;</span> <span class=p>=</span> <span class=nv>$OS</span><span class=p>.</span><span class=py>Caption</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;OSVersion&#39;</span> <span class=p>=</span> <span class=nv>$OS</span><span class=p>.</span><span class=py>Version</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;OSInstallDate&#39;</span> <span class=p>=</span> <span class=nv>$OS</span><span class=p>.</span><span class=py>InstallDate</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;isServer&#39;</span> <span class=p>=</span> <span class=nv>$Server</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nv>$props</span>
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://kamilpro.github.io/tags/course/>course</a></li><li><a href=https://kamilpro.github.io/tags/custom/>custom</a></li><li><a href=https://kamilpro.github.io/tags/else/>else</a></li><li><a href=https://kamilpro.github.io/tags/first-script/>first script</a></li><li><a href=https://kamilpro.github.io/tags/hash-table/>hash table</a></li><li><a href=https://kamilpro.github.io/tags/if/>if</a></li><li><a href=https://kamilpro.github.io/tags/object/>object</a></li><li><a href=https://kamilpro.github.io/tags/powershell/>powershell</a></li><li><a href=https://kamilpro.github.io/tags/ps1/>ps1</a></li><li><a href=https://kamilpro.github.io/tags/psobject/>psobject</a></li><li><a href=https://kamilpro.github.io/tags/script/>script</a></li><li><a href=https://kamilpro.github.io/tags/video/>video</a></li><li><a href=https://kamilpro.github.io/tags/write-host/>write-host</a></li></ul></footer></article></main><footer class=footer><span>Kamil Procyszyn</span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>