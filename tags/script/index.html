<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>script | Kamil Pro</title><meta name=keywords content><meta name=description content="Sysadmin's point of view"><meta name=author content><link rel=canonical href=https://kamilpro.com/tags/script/><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><link rel=icon href=https://kamilpro.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://kamilpro.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://kamilpro.com/favicon-32x32.png><link rel=apple-touch-icon href=https://kamilpro.com/apple-touch-icon.png><link rel=mask-icon href=https://kamilpro.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://kamilpro.com/tags/script/index.xml><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="script"><meta property="og:description" content="Sysadmin's point of view"><meta property="og:type" content="website"><meta property="og:url" content="https://kamilpro.com/tags/script/"><meta property="og:image" content="https://kamilpro.com/logo.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kamilpro.com/logo.png"><meta name=twitter:title content="script"><meta name=twitter:description content="Sysadmin's point of view"></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://kamilpro.com accesskey=h title="Kamil Pro (Alt + H)">Kamil Pro</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://kamilpro.com/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://kamilpro.com/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://kamilpro.com/categories/ title=Categories><span>Categories</span></a></li><li><a href="https://www.youtube.com/playlist?list=PL-esmhgrps8Zv9bAHesStPRQ1AiUL1wY3" title="About PowerShell"><span>About PowerShell</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://kamilpro.com/powershell-for-it-professionals/ title="Powershell for IT professionals"><span>Powershell for IT professionals</span></a></li><li><a href=https://github.com/thekamilpro title=GitHub><span><i class='fab fa-github fa-fw'></i></span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><header class=page-header><h1>script</h1></header><article class="post-entry tag-entry"><header class=entry-header><h2>PowerShell Error Handling - One error at the time please</h2></header><div class=entry-content><p>Code fails - whether because of reasons out of our control, or because we didn’t consider the situation it might fail. Expired credentials, timeout connections, lack of permissions go genuine software bug - each of these are potential problem which might fall our code over. And if we don’t handle the error, our script will simply throw and terminate. It’s certainly not desired state.
In this video I’ll show you different ways PowerShell can error, how to debug such errors and how to handle them - so that we are in control....</p></div><footer class=entry-footer><span title='2023-01-21 00:00:00 +0000 UTC'>2023-01-21</span>&nbsp;·&nbsp;Kamil</footer><a class=entry-link aria-label="post link to PowerShell Error Handling - One error at the time please" href=https://kamilpro.com/powershell-error-handling/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>PowerShell function - converting script into function with parameters</h2></header><div class=entry-content><p>So you’ve been writing your scripts for some time and wondering how to make them more PowerShell-like, so that they can be invoked from the console like all the other cmdlets?
In this quick video I’ll show you how to convert a sample script into function, add parameters and indicated to your user how to use your function with mandatory parameters and types.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 # Sample script which asks user for basic information, then manipulates it and # display some information # There's no way (at least easy) to pass these parameters from prompt, nor validate $Name = Read-Host -Prompt "What's your name?...</p></div><footer class=entry-footer><span title='2022-01-21 00:00:00 +0000 UTC'>2022-01-21</span>&nbsp;·&nbsp;Kamil</footer><a class=entry-link aria-label="post link to PowerShell function - converting script into function with parameters" href=https://kamilpro.com/powershell-function/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>PowerShell Hash Table - Storing key value pairs</h2></header><div class=entry-content><p>Quick crash course into using hash tables in PowerShell.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 &lt;#PSScriptInfo ....</p></div><footer class=entry-footer><span title='2021-09-14 00:00:00 +0000 UTC'>2021-09-14</span>&nbsp;·&nbsp;Kamil</footer><a class=entry-link aria-label="post link to PowerShell Hash Table - Storing key value pairs" href=https://kamilpro.com/powershell-hash-table/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>PowerShell Array and ArrayList - storing multiple items as a one variable</h2></header><div class=entry-content><p>Array is a basic data structure that allows to store multiple items in one variable. In this short video, I’ll show you how to create a basic array, populate it with items, how to add, access and modify items within array.
In addition, I’ll present to you how to use ArrayList - which is much more flexible array, especially for adding more items.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 # Link to the video: https://youtu....</p></div><footer class=entry-footer><span title='2021-08-23 00:00:00 +0000 UTC'>2021-08-23</span>&nbsp;·&nbsp;Kamil</footer><a class=entry-link aria-label="post link to PowerShell Array and ArrayList - storing multiple items as a one variable" href=https://kamilpro.com/powershell-array-and-arraylist/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>PowerShell Switch Statement - Different take on branching</h2></header><div class=entry-content><p>One switch statement can replace multiple if/else statements, it makes code more readable and is really easy to use - there’s no reason why you shouldn’t give it a try!
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 # Link to the video: https://youtu....</p></div><footer class=entry-footer><span title='2021-08-04 00:00:00 +0000 UTC'>2021-08-04</span>&nbsp;·&nbsp;Kamil</footer><a class=entry-link aria-label="post link to PowerShell Switch Statement - Different take on branching" href=https://kamilpro.com/powershell-switch-statement/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>PowerShell If statement - controlling the flow of your code</h2></header><div class=entry-content><p>In this video we are exploring how to use If statement in various scenarios. If statement allows you to take tide control over the execution of your code, by dictating your script what to do in a given situation.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 # Link to the video: https://youtu....</p></div><footer class=entry-footer><span title='2021-07-03 00:00:00 +0000 UTC'>2021-07-03</span>&nbsp;·&nbsp;Kamil</footer><a class=entry-link aria-label="post link to PowerShell If statement - controlling the flow of your code" href=https://kamilpro.com/powershell-if-statement/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>PowerShell for IT Professionals [#19] – Websites and APIs</h2></header><div class=entry-content><p>PowerShell is a great server automation tool, but what about Internet and any other web served services?
As it turns out, PowerShell is great in scrapping websites and consuming APIs – and it’s been one of the main development areas of the tool in the last couple of years.
In this lesson we are going to see how to use PowerShell to download files, scrap websites, discover links.
We will then use an API of PasswordPusher (pwpush....</p></div><footer class=entry-footer><span title='2020-11-15 20:57:20 +0000 UTC'>2020-11-15</span>&nbsp;·&nbsp;Kamil</footer><a class=entry-link aria-label="post link to PowerShell for IT Professionals [#19] – Websites and APIs" href=https://kamilpro.com/powershell-for-it-professionals-19-websites-and-apis/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>PowerShell for IT Professionals [#17] – Scripting part 4 – parameters, running remotely and formatting</h2></header><div class=entry-content><p>In the last part of scripting series, we will make the script to be able to query remote machines, e.g. servers.
We will also check how to add parameters to the script (and configure the default value of parameter) so that user will able to pass the parameter name like in a standard PowerShell cmdlet.
Finally, we are going to format the script so that it looks more reliable and make some refactoring so that the logic is simpler....</p></div><footer class=entry-footer><span title='2020-10-19 18:32:20 +0000 UTC'>2020-10-19</span>&nbsp;·&nbsp;Kamil</footer><a class=entry-link aria-label="post link to PowerShell for IT Professionals [#17] – Scripting part 4 – parameters, running remotely and formatting" href=https://kamilpro.com/powershell-for-it-professionals-17-scripting-part-4-parameters-running-remotely-and-formatting/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>PowerShell for IT Professionals [#16] – Scripting part 3 – Add-Member and network</h2></header><div class=entry-content><p>In this lesson we are taking our script further by adding details about IP configuration and last installed hotfixes.
But it turns out, the networking information is not that shallow as it seems at the first glance – thus I’ll show you how to retrieve the information from the configuration.
We will also look on how to reuse our already created object so that we don’t need to duplicate code....</p></div><footer class=entry-footer><span title='2020-10-13 19:12:40 +0000 UTC'>2020-10-13</span>&nbsp;·&nbsp;Kamil</footer><a class=entry-link aria-label="post link to PowerShell for IT Professionals [#16] – Scripting part 3 – Add-Member and network" href=https://kamilpro.com/powershell-for-it-professionals-16-scripting-part-3-add-member-and-network/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>PowerShell for IT Professionals [#15] – Scripting part 2 – IF and psobject</h2></header><div class=entry-content><p>In this lesson we carry on writing the scripting by gathering requirements and putting them together as comments in code.
Then we will retrieve OS information with the help of WMI and display it on the screen with Write-Host.
Although using Write-Host is easy to use, it doesn’t really allow us to do very much e.g. we cannot export information to the CSV, therefore we change it and start using custom PSObject – that way our script will start returning information like a regular PowerShell command....</p></div><footer class=entry-footer><span title='2020-10-05 17:16:21 +0000 UTC'>2020-10-05</span>&nbsp;·&nbsp;Kamil</footer><a class=entry-link aria-label="post link to PowerShell for IT Professionals [#15] – Scripting part 2 – IF and psobject" href=https://kamilpro.com/powershell-for-it-professionals-15-scripting-part-2-if-and-psobject/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>PowerShell for IT Professionals [#14] – Scripting – Hello World!</h2></header><div class=entry-content><p>In this lesson we will be preparing our workstation for writing PowerShell scripts. We will start by enabling RSAT and then install Visual Studio Code which is a recommended and free PowerShell code editor.
We will then have a look at the basic function of VS Code and create a simple “Hello World” script.
Exercises If you haven’t followed along, you definitely would like to install VS Code and create a *....</p></div><footer class=entry-footer><span title='2020-09-26 13:00:35 +0000 UTC'>2020-09-26</span>&nbsp;·&nbsp;Kamil</footer><a class=entry-link aria-label="post link to PowerShell for IT Professionals [#14] – Scripting – Hello World!" href=https://kamilpro.com/powershell-for-it-professionals-14-scripting-hello-world/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>Powershell – resolve full names to usernames from CSV file</h2></header><div class=entry-content><p>It’s unbelievable how long it took me to figure out this simple Powershell script, but yet it does the trick :).
Often you receive a request to do a certain action with a bunch of accounts, and (obviously) the list provided contains the full names rather usernames. Pain to do it manually, but yet we can utilise Powershell here.
What you need: CSV file, with only one column, and the header of the column must be called “Name”, if you prefer to use something different, simply amend Name in line 6 to reflect your header....</p></div><footer class=entry-footer><span title='2017-10-21 14:03:58 +0000 UTC'>2017-10-21</span>&nbsp;·&nbsp;Kamil</footer><a class=entry-link aria-label="post link to Powershell – resolve full names to usernames from CSV file" href=https://kamilpro.com/powershell-resolve-full-names-usernames-csv-file/></a></article></main><footer class=footer><span>Kamil Procyszyn</span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>