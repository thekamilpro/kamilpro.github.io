<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>PowerShell for IT Professionals [#10] – Remote management with PowerShell | Kamil Pro</title><meta name=keywords content="command,course,enter,invoke,IT,linux,powershell,psexec,pssesion,rdp,remote,remoting,ssh,sysadmin,telnet,ws-man"><meta name=description content="In this lesson we’re going to learn how to do one-to-one and one-to-many remote management with PowerShell. There’s no need for telnet, ssh or psexec as PowerShell has its own protocol that’s built in right into Windows. We will look at how to create interactive sessions and send commands to multiple servers at once.
Exercises With Enter-PSSesion, Remote to remote server and&nbsp; restart &#8220;Windows update&#8221; service With Invoke-Command find out the remote computers last boot up/startup time List all running processes on remote server without using Enter-PsSession or Invoke-Command If you have a Domain Controller available, use Invoke-Command to list all computers on that network (you can use * for filter), remember that you need to provide all necessary parameters with your command in the script block so command just runs and doesn&#8217;t prompt for any additional information."><meta name=author content="Kamil"><link rel=canonical href=https://kamilpro.com/powershell-for-it-professionals-10-remote-management-with-powershell/><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://kamilpro.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://kamilpro.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://kamilpro.com/favicon-32x32.png><link rel=apple-touch-icon href=https://kamilpro.com/apple-touch-icon.png><link rel=mask-icon href=https://kamilpro.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=text/plain href=https://kamilpro.com/powershell-for-it-professionals-10-remote-management-with-powershell/index.md><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="PowerShell for IT Professionals [#10] – Remote management with PowerShell"><meta property="og:description" content="In this lesson we’re going to learn how to do one-to-one and one-to-many remote management with PowerShell. There’s no need for telnet, ssh or psexec as PowerShell has its own protocol that’s built in right into Windows. We will look at how to create interactive sessions and send commands to multiple servers at once.
Exercises With Enter-PSSesion, Remote to remote server and&nbsp; restart &#8220;Windows update&#8221; service With Invoke-Command find out the remote computers last boot up/startup time List all running processes on remote server without using Enter-PsSession or Invoke-Command If you have a Domain Controller available, use Invoke-Command to list all computers on that network (you can use * for filter), remember that you need to provide all necessary parameters with your command in the script block so command just runs and doesn&#8217;t prompt for any additional information."><meta property="og:type" content="article"><meta property="og:url" content="https://kamilpro.com/powershell-for-it-professionals-10-remote-management-with-powershell/"><meta property="og:image" content="https://kamilpro.com/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-08-24T10:00:00+00:00"><meta property="article:modified_time" content="2022-01-03T19:48:21+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kamilpro.com/logo.png"><meta name=twitter:title content="PowerShell for IT Professionals [#10] – Remote management with PowerShell"><meta name=twitter:description content="In this lesson we’re going to learn how to do one-to-one and one-to-many remote management with PowerShell. There’s no need for telnet, ssh or psexec as PowerShell has its own protocol that’s built in right into Windows. We will look at how to create interactive sessions and send commands to multiple servers at once.
Exercises With Enter-PSSesion, Remote to remote server and&nbsp; restart &#8220;Windows update&#8221; service With Invoke-Command find out the remote computers last boot up/startup time List all running processes on remote server without using Enter-PsSession or Invoke-Command If you have a Domain Controller available, use Invoke-Command to list all computers on that network (you can use * for filter), remember that you need to provide all necessary parameters with your command in the script block so command just runs and doesn&#8217;t prompt for any additional information."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://kamilpro.com/posts/"},{"@type":"ListItem","position":3,"name":"PowerShell for IT Professionals [#10] – Remote management with PowerShell","item":"https://kamilpro.com/powershell-for-it-professionals-10-remote-management-with-powershell/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"PowerShell for IT Professionals [#10] – Remote management with PowerShell","name":"PowerShell for IT Professionals [#10] – Remote management with PowerShell","description":"In this lesson we’re going to learn how to do one-to-one and one-to-many remote management with PowerShell. There’s no need for telnet, ssh or psexec as PowerShell has its own protocol that’s built in right into Windows. We will look at how to create interactive sessions and send commands to multiple servers at once.\nExercises With Enter-PSSesion, Remote to remote server and\u0026nbsp; restart \u0026#8220;Windows update\u0026#8221; service With Invoke-Command find out the remote computers last boot up/startup time List all running processes on remote server without using Enter-PsSession or Invoke-Command If you have a Domain Controller available, use Invoke-Command to list all computers on that network (you can use * for filter), remember that you need to provide all necessary parameters with your command in the script block so command just runs and doesn\u0026#8217;t prompt for any additional information.","keywords":["command","course","enter","invoke","IT","linux","powershell","psexec","pssesion","rdp","remote","remoting","ssh","sysadmin","telnet","ws-man"],"articleBody":" In this lesson we’re going to learn how to do one-to-one and one-to-many remote management with PowerShell. There’s no need for telnet, ssh or psexec as PowerShell has its own protocol that’s built in right into Windows. We will look at how to create interactive sessions and send commands to multiple servers at once.\nExercises With Enter-PSSesion, Remote to remote server and restart “Windows update” service With Invoke-Command find out the remote computers last boot up/startup time List all running processes on remote server without using Enter-PsSession or Invoke-Command If you have a Domain Controller available, use Invoke-Command to list all computers on that network (you can use * for filter), remember that you need to provide all necessary parameters with your command in the script block so command just runs and doesn’t prompt for any additional information. Notes 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 Enable-Psremoting Enter-PSSesion ps-svr1 Hostname Get-Service GIP # I can even run commands that are not available on my source machine Get-ADDomainController Get-ADUser Exit or Exit-PSSession # Caution about double hoping Invoke-Command Invoke-Command -computerName ps-svr1 -command { get-service} # Invoke command executes commands on the remote comptuers and brings back the results # Can you tell a difference? Invoke-Command -computerName ps-svr1 -command { get-service | Where {$_.status -eq 'stopped' } } Invoke-Command -computerName ps-svr1 -command { get-service } | Where {$_.status -eq 'stopped' } # -ComputerName in the commandlet Get-Service -ComputerName ps-svr1 Invoke-Command -computerName ps-svr1 -command { get-service } # they look the same, but are they? Get-Service -ComputerName ps-svr1 | GM Invoke-Command -computerName ps-svr1 -command { get-service } | GM ","wordCount":"299","inLanguage":"en","datePublished":"2020-08-24T10:00:00Z","dateModified":"2022-01-03T19:48:21Z","author":{"@type":"Person","name":"Kamil"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://kamilpro.com/powershell-for-it-professionals-10-remote-management-with-powershell/"},"publisher":{"@type":"Organization","name":"Kamil Pro","logo":{"@type":"ImageObject","url":"https://kamilpro.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://kamilpro.com accesskey=h title="Kamil Pro (Alt + H)">Kamil Pro</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://kamilpro.com/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://kamilpro.com/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://kamilpro.com/categories/ title=Categories><span>Categories</span></a></li><li><a href="https://www.youtube.com/playlist?list=PL-esmhgrps8Zv9bAHesStPRQ1AiUL1wY3" title="About PowerShell"><span>About PowerShell</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://kamilpro.com/powershell-for-it-professionals/ title="Powershell for IT professionals"><span>Powershell for IT professionals</span></a></li><li><a href=https://github.com/thekamilpro title=GitHub><span><i class='fab fa-github fa-fw'></i></span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>PowerShell for IT Professionals [#10] – Remote management with PowerShell</h1><div class=post-meta><span title='2020-08-24 10:00:00 +0000 UTC'>2020-08-24</span>&nbsp;·&nbsp;Kamil</div></header><div class=post-content><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube-nocookie.com/embed/TB2-Y3zFUb0 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><p>In this lesson we’re going to learn how to do one-to-one and one-to-many remote management with PowerShell. There’s no need for telnet, ssh or psexec as PowerShell has its own protocol that’s built in right into Windows. We will look at how to create interactive sessions and send commands to multiple servers at once.</p><h2 id=exercises>Exercises<a hidden class=anchor aria-hidden=true href=#exercises>#</a></h2><ol type=1><li>With Enter-PSSesion, Remote to remote server and&nbsp; restart &#8220;Windows update&#8221; service</li><li>With Invoke-Command find out the remote computers last boot up/startup time</li><li>List all running processes on remote server without using Enter-PsSession or Invoke-Command</li><li>If you have a Domain Controller available, use Invoke-Command to list all computers on that network (you can use * for filter), remember that you need to provide all necessary parameters with your command in the script block so command just runs and doesn&#8217;t prompt for any additional information.</li></ol><h2 id=notes>Notes<a hidden class=anchor aria-hidden=true href=#notes>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>Enable-Psremoting</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Enter-PSSesion</span> <span class=nb>ps-svr1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Hostname</span>
</span></span><span class=line><span class=cl><span class=nb>Get-Service</span>
</span></span><span class=line><span class=cl><span class=n>GIP</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># I can even run commands that are not available on my source machine</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Get-ADDomainController</span>
</span></span><span class=line><span class=cl><span class=nb>Get-ADUser</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Exit</span> <span class=n>or</span> <span class=nb>Exit-PSSession</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Caution about double hoping</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Invoke-Command</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Invoke-Command</span> <span class=n>-computerName</span> <span class=nb>ps-svr1</span> <span class=n>-command</span>  <span class=p>{</span> <span class=nb>get-service</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Invoke command executes commands on the remote comptuers and brings back the results</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Can you tell a difference?</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Invoke-Command</span> <span class=n>-computerName</span> <span class=nb>ps-svr1</span> <span class=n>-command</span>  <span class=p>{</span> <span class=nb>get-service</span> <span class=p>|</span> <span class=nb>Where </span><span class=p>{</span><span class=nv>$_</span><span class=p>.</span><span class=py>status</span> <span class=o>-eq</span> <span class=s1>&#39;stopped&#39;</span> <span class=p>}</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Invoke-Command</span> <span class=n>-computerName</span> <span class=nb>ps-svr1</span> <span class=n>-command</span>  <span class=p>{</span> <span class=nb>get-service</span> <span class=p>}</span> <span class=p>|</span> <span class=nb>Where </span><span class=p>{</span><span class=nv>$_</span><span class=p>.</span><span class=py>status</span> <span class=o>-eq</span> <span class=s1>&#39;stopped&#39;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># -ComputerName in the commandlet</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Get-Service</span> <span class=n>-ComputerName</span> <span class=nb>ps-svr1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Invoke-Command</span> <span class=n>-computerName</span> <span class=nb>ps-svr1</span> <span class=n>-command</span>  <span class=p>{</span> <span class=nb>get-service</span>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># they look the same, but are they?</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Get-Service</span> <span class=n>-ComputerName</span> <span class=nb>ps-svr1</span> <span class=p>|</span> <span class=nb>GM
</span></span></span><span class=line><span class=cl><span class=nb></span>
</span></span><span class=line><span class=cl><span class=nb>Invoke-Command</span> <span class=n>-computerName</span> <span class=nb>ps-svr1</span> <span class=n>-command</span>  <span class=p>{</span> <span class=nb>get-service</span>  <span class=p>}</span> <span class=p>|</span> <span class=nb>GM
</span></span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://kamilpro.com/tags/command/>command</a></li><li><a href=https://kamilpro.com/tags/course/>course</a></li><li><a href=https://kamilpro.com/tags/enter/>enter</a></li><li><a href=https://kamilpro.com/tags/invoke/>invoke</a></li><li><a href=https://kamilpro.com/tags/it/>IT</a></li><li><a href=https://kamilpro.com/tags/linux/>linux</a></li><li><a href=https://kamilpro.com/tags/powershell/>powershell</a></li><li><a href=https://kamilpro.com/tags/psexec/>psexec</a></li><li><a href=https://kamilpro.com/tags/pssesion/>pssesion</a></li><li><a href=https://kamilpro.com/tags/rdp/>rdp</a></li><li><a href=https://kamilpro.com/tags/remote/>remote</a></li><li><a href=https://kamilpro.com/tags/remoting/>remoting</a></li><li><a href=https://kamilpro.com/tags/ssh/>ssh</a></li><li><a href=https://kamilpro.com/tags/sysadmin/>sysadmin</a></li><li><a href=https://kamilpro.com/tags/telnet/>telnet</a></li><li><a href=https://kamilpro.com/tags/ws-man/>ws-man</a></li></ul></footer></article></main><footer class=footer><span>Kamil Procyszyn</span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>