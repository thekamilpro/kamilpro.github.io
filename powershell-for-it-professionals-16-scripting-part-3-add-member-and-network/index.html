<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>PowerShell for IT Professionals [#16] – Scripting part 3 – Add-Member and network | Kamil Pro</title><meta name=keywords content="add-member,course,hotfix,if,ip configuration,network,patch,powershell,psobject,script,video"><meta name=description content="In this lesson we are taking our script further by adding details about IP configuration and last installed hotfixes.
But it turns out, the networking information is not that shallow as it seems at the first glance – thus I’ll show you how to retrieve the information from the configuration.
We will also look on how to reuse our already created object so that we don’t need to duplicate code."><meta name=author content="Kamil"><link rel=canonical href=https://kamilpro.com/powershell-for-it-professionals-16-scripting-part-3-add-member-and-network/><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://kamilpro.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://kamilpro.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://kamilpro.com/favicon-32x32.png><link rel=apple-touch-icon href=https://kamilpro.com/apple-touch-icon.png><link rel=mask-icon href=https://kamilpro.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=text/plain href=https://kamilpro.com/powershell-for-it-professionals-16-scripting-part-3-add-member-and-network/index.md><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="PowerShell for IT Professionals [#16] – Scripting part 3 – Add-Member and network"><meta property="og:description" content="In this lesson we are taking our script further by adding details about IP configuration and last installed hotfixes.
But it turns out, the networking information is not that shallow as it seems at the first glance – thus I’ll show you how to retrieve the information from the configuration.
We will also look on how to reuse our already created object so that we don’t need to duplicate code."><meta property="og:type" content="article"><meta property="og:url" content="https://kamilpro.com/powershell-for-it-professionals-16-scripting-part-3-add-member-and-network/"><meta property="og:image" content="https://kamilpro.com/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-10-13T19:12:40+00:00"><meta property="article:modified_time" content="2022-01-03T19:48:21+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kamilpro.com/logo.png"><meta name=twitter:title content="PowerShell for IT Professionals [#16] – Scripting part 3 – Add-Member and network"><meta name=twitter:description content="In this lesson we are taking our script further by adding details about IP configuration and last installed hotfixes.
But it turns out, the networking information is not that shallow as it seems at the first glance – thus I’ll show you how to retrieve the information from the configuration.
We will also look on how to reuse our already created object so that we don’t need to duplicate code."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://kamilpro.com/posts/"},{"@type":"ListItem","position":3,"name":"PowerShell for IT Professionals [#16] – Scripting part 3 – Add-Member and network","item":"https://kamilpro.com/powershell-for-it-professionals-16-scripting-part-3-add-member-and-network/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"PowerShell for IT Professionals [#16] – Scripting part 3 – Add-Member and network","name":"PowerShell for IT Professionals [#16] – Scripting part 3 – Add-Member and network","description":"In this lesson we are taking our script further by adding details about IP configuration and last installed hotfixes.\nBut it turns out, the networking information is not that shallow as it seems at the first glance – thus I’ll show you how to retrieve the information from the configuration.\nWe will also look on how to reuse our already created object so that we don’t need to duplicate code.","keywords":["add-member","course","hotfix","if","ip configuration","network","patch","powershell","psobject","script","video"],"articleBody":" In this lesson we are taking our script further by adding details about IP configuration and last installed hotfixes.\nBut it turns out, the networking information is not that shallow as it seems at the first glance – thus I’ll show you how to retrieve the information from the configuration.\nWe will also look on how to reuse our already created object so that we don’t need to duplicate code.\nAnd finally, we will use Add-Member to add more properties to the custom object.\nScript 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 $OS = Get-CimInstance -ClassName Win32_OperatingSystem # OS Name Write-Host \"OS Name: $($OS.Caption)\" # Version Write-Host \"OS Version: $($OS.Version)\" # Install Date Write-Host \"OS Install date: $($OS.InstallDate)\" # Client/Server IF ($os.Caption -like \"*Server*\") { $server = $true } else { $server = $false} # IP: Interface, ip, gateway, dns $Network = Get-NetAdapter | Where-Object {$_.Status -eq 'Up'} | Get-NetIPConfiguration # Last updates $Updates = Get-HotFix | Sort InstalledOn -Descending | Select-Object -First 5 # It would be nice if could run this remotely $props = [pscustomobject]@{ 'OSName' = $OS.Caption 'OSVersion' = $OS.Version 'OSInstallDate' = $OS.InstallDate 'isServer' = $Server 'IPv4Address' = $Network.IPv4Address.IPAddress 'Gateway' = $Network.IPv4DefaultGateway.nexthop 'DNS' = $Network.DNSServer | Where-Object {$_.AddressFamily -eq '2'} | Select-Object ServerADdresses -ExpandProperty ServerAddresses 'Updates' = $Updates.HotfixID | Out-String } # Network: Can I ping gateway, DNS Server, website $pingGateway = Test-NetConnection -ComputerName $props.Gateway -InformationLevel Quiet $pingDNS = Test-NetConnection -ComputerName $props.DNS\u0026#91;0] -InformationLevel Quiet $pingWebsite = Test-NetConnection -ComputerName 'kamilpro.com' -InformationLevel Quiet $props | Add-Member -MemberType NoteProperty -Value $pingGateway -Name 'pingGateway' $props | Add-Member -MemberType NoteProperty -Value $pingDNS -Name 'pingDNS' $props | Add-Member -MemberType NoteProperty -Value $pingWebsite -Name 'pingWebsite' # Installed roles – server only IF ($props.isServer = $true) { $Roles = Get-WindowsFeature } $props ","wordCount":"318","inLanguage":"en","datePublished":"2020-10-13T19:12:40Z","dateModified":"2022-01-03T19:48:21Z","author":{"@type":"Person","name":"Kamil"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://kamilpro.com/powershell-for-it-professionals-16-scripting-part-3-add-member-and-network/"},"publisher":{"@type":"Organization","name":"Kamil Pro","logo":{"@type":"ImageObject","url":"https://kamilpro.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://kamilpro.com accesskey=h title="Kamil Pro (Alt + H)">Kamil Pro</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://kamilpro.com/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://kamilpro.com/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://kamilpro.com/categories/ title=Categories><span>Categories</span></a></li><li><a href="https://www.youtube.com/playlist?list=PL-esmhgrps8Zv9bAHesStPRQ1AiUL1wY3" title="About PowerShell"><span>About PowerShell</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://kamilpro.com/powershell-for-it-professionals/ title="Powershell for IT professionals"><span>Powershell for IT professionals</span></a></li><li><a href=https://github.com/thekamilpro title=GitHub><span><i class='fab fa-github fa-fw'></i></span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>PowerShell for IT Professionals [#16] – Scripting part 3 – Add-Member and network</h1><div class=post-meta><span title='2020-10-13 19:12:40 +0000 UTC'>2020-10-13</span>&nbsp;·&nbsp;Kamil</div></header><div class=post-content><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube-nocookie.com/embed/rA8CWs2Of2Y style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><p>In this lesson we are taking our script further by adding details about IP configuration and last installed hotfixes.</p><p>But it turns out, the networking information is not that shallow as it seems at the first glance – thus I’ll show you how to retrieve the information from the configuration.</p><p>We will also look on how to reuse our already created object so that we don’t need to duplicate code.</p><p>And finally, we will use Add-Member to add more properties to the custom object.</p><h2 id=script>Script<a hidden class=anchor aria-hidden=true href=#script>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nv>$OS</span> <span class=p>=</span> <span class=nb>Get-CimInstance</span> <span class=n>-ClassName</span> <span class=n>Win32_OperatingSystem</span>
</span></span><span class=line><span class=cl><span class=c># OS Name</span>
</span></span><span class=line><span class=cl><span class=nb>Write-Host</span> <span class=s2>&#34;OS Name: </span><span class=p>$(</span><span class=nv>$OS</span><span class=p>.</span><span class=n>Caption</span><span class=p>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=c># Version</span>
</span></span><span class=line><span class=cl><span class=nb>Write-Host</span> <span class=s2>&#34;OS Version: </span><span class=p>$(</span><span class=nv>$OS</span><span class=p>.</span><span class=n>Version</span><span class=p>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=c># Install Date</span>
</span></span><span class=line><span class=cl><span class=nb>Write-Host</span> <span class=s2>&#34;OS Install date: </span><span class=p>$(</span><span class=nv>$OS</span><span class=p>.</span><span class=n>InstallDate</span><span class=p>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=c># Client/Server</span>
</span></span><span class=line><span class=cl><span class=k>IF</span> <span class=p>(</span><span class=nv>$os</span><span class=p>.</span><span class=py>Caption</span> <span class=o>-like</span> <span class=s2>&#34;*Server*&#34;</span><span class=p>)</span> <span class=p>{</span> <span class=nv>$server</span> <span class=p>=</span> <span class=vm>$true</span> <span class=p>}</span> <span class=k>else</span> <span class=p>{</span> <span class=nv>$server</span> <span class=p>=</span> <span class=vm>$false</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c># IP: Interface, ip, gateway, dns</span>
</span></span><span class=line><span class=cl><span class=nv>$Network</span> <span class=p>=</span> <span class=nb>Get-NetAdapter</span> <span class=p>|</span> <span class=nb>Where-Object</span> <span class=p>{</span><span class=nv>$_</span><span class=p>.</span><span class=py>Status</span> <span class=o>-eq</span> <span class=s1>&#39;Up&#39;</span><span class=p>}</span> <span class=p>|</span> <span class=nb>Get-NetIPConfiguration</span>
</span></span><span class=line><span class=cl><span class=c># Last updates</span>
</span></span><span class=line><span class=cl><span class=nv>$Updates</span> <span class=p>=</span> <span class=nb>Get-HotFix</span> <span class=p>|</span> <span class=nb>Sort </span><span class=n>InstalledOn</span> <span class=n>-Descending</span> <span class=p>|</span> <span class=nb>Select-Object</span> <span class=n>-First</span> <span class=mf>5</span>
</span></span><span class=line><span class=cl><span class=c># It would be nice if could run this remotely </span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$props</span> <span class=p>=</span> <span class=p>[</span><span class=no>pscustomobject</span><span class=p>]</span><span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;OSName&#39;</span> <span class=p>=</span> <span class=nv>$OS</span><span class=p>.</span><span class=py>Caption</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;OSVersion&#39;</span> <span class=p>=</span> <span class=nv>$OS</span><span class=p>.</span><span class=py>Version</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;OSInstallDate&#39;</span> <span class=p>=</span> <span class=nv>$OS</span><span class=p>.</span><span class=py>InstallDate</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;isServer&#39;</span> <span class=p>=</span> <span class=nv>$Server</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;IPv4Address&#39;</span> <span class=p>=</span> <span class=nv>$Network</span><span class=p>.</span><span class=py>IPv4Address</span><span class=p>.</span><span class=py>IPAddress</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;Gateway&#39;</span> <span class=p>=</span> <span class=nv>$Network</span><span class=p>.</span><span class=py>IPv4DefaultGateway</span><span class=p>.</span><span class=py>nexthop</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;DNS&#39;</span> <span class=p>=</span> <span class=nv>$Network</span><span class=p>.</span><span class=py>DNSServer</span> <span class=p>|</span> <span class=nb>Where-Object</span> <span class=p>{</span><span class=nv>$_</span><span class=p>.</span><span class=py>AddressFamily</span> <span class=o>-eq</span> <span class=s1>&#39;2&#39;</span><span class=p>}</span> <span class=p>|</span> <span class=nb>Select-Object</span> <span class=n>ServerADdresses</span> <span class=n>-ExpandProperty</span> <span class=n>ServerAddresses</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;Updates&#39;</span> <span class=p>=</span> <span class=nv>$Updates</span><span class=p>.</span><span class=py>HotfixID</span> <span class=p>|</span> <span class=nb>Out-String</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c># Network: Can I ping gateway, DNS Server, website</span>
</span></span><span class=line><span class=cl><span class=nv>$pingGateway</span> <span class=p>=</span> <span class=nb>Test-NetConnection</span> <span class=n>-ComputerName</span> <span class=nv>$props</span><span class=p>.</span><span class=py>Gateway</span> <span class=n>-InformationLevel</span> <span class=n>Quiet</span>
</span></span><span class=line><span class=cl><span class=nv>$pingDNS</span> <span class=p>=</span> <span class=nb>Test-NetConnection</span> <span class=n>-ComputerName</span> <span class=nv>$props</span><span class=p>.</span><span class=n>DNS</span><span class=p>&amp;</span><span class=c>#91;0] -InformationLevel Quiet</span>
</span></span><span class=line><span class=cl><span class=nv>$pingWebsite</span> <span class=p>=</span> <span class=nb>Test-NetConnection</span> <span class=n>-ComputerName</span> <span class=s1>&#39;kamilpro.com&#39;</span> <span class=n>-InformationLevel</span> <span class=n>Quiet</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$props</span> <span class=p>|</span> <span class=nb>Add-Member</span> <span class=n>-MemberType</span> <span class=n>NoteProperty</span> <span class=n>-Value</span> <span class=nv>$pingGateway</span> <span class=n>-Name</span> <span class=s1>&#39;pingGateway&#39;</span>
</span></span><span class=line><span class=cl><span class=nv>$props</span> <span class=p>|</span> <span class=nb>Add-Member</span> <span class=n>-MemberType</span> <span class=n>NoteProperty</span> <span class=n>-Value</span> <span class=nv>$pingDNS</span> <span class=n>-Name</span> <span class=s1>&#39;pingDNS&#39;</span>
</span></span><span class=line><span class=cl><span class=nv>$props</span> <span class=p>|</span> <span class=nb>Add-Member</span> <span class=n>-MemberType</span> <span class=n>NoteProperty</span> <span class=n>-Value</span> <span class=nv>$pingWebsite</span> <span class=n>-Name</span> <span class=s1>&#39;pingWebsite&#39;</span>
</span></span><span class=line><span class=cl><span class=c># Installed roles – server only</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>IF</span> <span class=p>(</span><span class=nv>$props</span><span class=p>.</span><span class=py>isServer</span> <span class=p>=</span> <span class=vm>$true</span><span class=p>)</span> <span class=p>{</span> <span class=nv>$Roles</span> <span class=p>=</span> <span class=nb>Get-WindowsFeature</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$props</span>
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://kamilpro.com/tags/add-member/>add-member</a></li><li><a href=https://kamilpro.com/tags/course/>course</a></li><li><a href=https://kamilpro.com/tags/hotfix/>hotfix</a></li><li><a href=https://kamilpro.com/tags/if/>if</a></li><li><a href=https://kamilpro.com/tags/ip-configuration/>ip configuration</a></li><li><a href=https://kamilpro.com/tags/network/>network</a></li><li><a href=https://kamilpro.com/tags/patch/>patch</a></li><li><a href=https://kamilpro.com/tags/powershell/>powershell</a></li><li><a href=https://kamilpro.com/tags/psobject/>psobject</a></li><li><a href=https://kamilpro.com/tags/script/>script</a></li><li><a href=https://kamilpro.com/tags/video/>video</a></li></ul></footer></article></main><footer class=footer><span>Kamil Procyszyn</span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>