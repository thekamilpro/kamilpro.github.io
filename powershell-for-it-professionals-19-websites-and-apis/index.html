<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>PowerShell for IT Professionals [#19] – Websites and APIs | Kamil Pro</title><meta name=keywords content="api,course,download,internet,invoke,json,method,password,powershell,pwpush,request,rest,scrapping,script,training,website"><meta name=description content="PowerShell is a great server automation tool, but what about Internet and any other web served services?
As it turns out, PowerShell is great in scrapping websites and consuming APIs – and it’s been one of the main development areas of the tool in the last couple of years.
In this lesson we are going to see how to use PowerShell to download files, scrap websites, discover links.
We will then use an API of PasswordPusher (pwpush."><meta name=author content="Kamil"><link rel=canonical href=https://kamilpro.github.io/powershell-for-it-professionals-19-websites-and-apis/><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://kamilpro.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://kamilpro.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://kamilpro.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://kamilpro.github.io/apple-touch-icon.png><link rel=mask-icon href=https://kamilpro.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=text/plain href=https://kamilpro.github.io/powershell-for-it-professionals-19-websites-and-apis/index.md><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="PowerShell for IT Professionals [#19] – Websites and APIs"><meta property="og:description" content="PowerShell is a great server automation tool, but what about Internet and any other web served services?
As it turns out, PowerShell is great in scrapping websites and consuming APIs – and it’s been one of the main development areas of the tool in the last couple of years.
In this lesson we are going to see how to use PowerShell to download files, scrap websites, discover links.
We will then use an API of PasswordPusher (pwpush."><meta property="og:type" content="article"><meta property="og:url" content="https://kamilpro.github.io/powershell-for-it-professionals-19-websites-and-apis/"><meta property="og:image" content="https://kamilpro.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-11-15T20:57:20+00:00"><meta property="article:modified_time" content="2022-01-03T19:48:21+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kamilpro.github.io/logo.png"><meta name=twitter:title content="PowerShell for IT Professionals [#19] – Websites and APIs"><meta name=twitter:description content="PowerShell is a great server automation tool, but what about Internet and any other web served services?
As it turns out, PowerShell is great in scrapping websites and consuming APIs – and it’s been one of the main development areas of the tool in the last couple of years.
In this lesson we are going to see how to use PowerShell to download files, scrap websites, discover links.
We will then use an API of PasswordPusher (pwpush."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://kamilpro.github.io/posts/"},{"@type":"ListItem","position":3,"name":"PowerShell for IT Professionals [#19] – Websites and APIs","item":"https://kamilpro.github.io/powershell-for-it-professionals-19-websites-and-apis/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"PowerShell for IT Professionals [#19] – Websites and APIs","name":"PowerShell for IT Professionals [#19] – Websites and APIs","description":"PowerShell is a great server automation tool, but what about Internet and any other web served services?\nAs it turns out, PowerShell is great in scrapping websites and consuming APIs – and it’s been one of the main development areas of the tool in the last couple of years.\nIn this lesson we are going to see how to use PowerShell to download files, scrap websites, discover links.\nWe will then use an API of PasswordPusher (pwpush.","keywords":["api","course","download","internet","invoke","json","method","password","powershell","pwpush","request","rest","scrapping","script","training","website"],"articleBody":" PowerShell is a great server automation tool, but what about Internet and any other web served services?\nAs it turns out, PowerShell is great in scrapping websites and consuming APIs – and it’s been one of the main development areas of the tool in the last couple of years.\nIn this lesson we are going to see how to use PowerShell to download files, scrap websites, discover links.\nWe will then use an API of PasswordPusher (pwpush.com) to generate expiring links to our secret passwords – all from within PowerShell.\nScript 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 Set-Location C:\\temp2; clear $PSVersionTable ### Invoke-WebRequest # Downloading files $uri = \"https://github.com/notepad-plus-plus/notepad-plus-plus/releases/download/v7.9.1/npp.7.9.1.Installer.x64.exe\" $here = Get-Location Invoke-WebRequest -Uri $uri Invoke-WebRequest -Uri $uri -OutFile .\\notepad1.exe ls $wc = \u0026#91;System.Net.Webclient]::New() $wc.DownloadFile($uri, \"$here\\notepad2.exe\") ls Start-BitsTransfer -Source $uri -Destination \"$here\\notepad3.exe\" ls $Website = Invoke-WebRequest -Uri \"bbc.com\" $Website $Website.StatusCode; $Website.StatusDescription; $Website.Headers $Website.RawContent $Website.RawContent | Out-File website.html explorer . # Websites $Website.Links $Website.Links | where {$_.class -eq \"top-list-item__link\"} $Website.Links | where {$_.class -eq \"top-list-item__link\"} | select data-bbc-title,href # Resolving shortcut urls $Website.Images $Website.images | where {$_.src -like \"http*\"} $Website.images | where {$_.src -like \"http*\"} | ForEach-Object {Start-BitsTransfer -Source $_.src -Destination \"$($_.alt).jpg\" } ls explorer . # Short urls $uri = \"https://bit.ly/38JsRDB\" $response = Invoke-WebRequest -Uri $uri $response.BaseResponse.RequestMessage.RequestUri.AbsoluteUri # Api $Uri = \"https://pwpush.com/p.json\" # Json $json = '{ \"password\": { \"expire_after_views\": 5, \"expire_after_days\": 2, \"payload\": \"mysecretpassword\" } }' $request = Invoke-WebRequest -Uri $uri -Method \"Post\" -ContentType \"application/json\" -Body $json $request $request.Content $request.Content | ConvertFrom-Json $body = @{ password = @{ \"payload\" = \"mysecretpassword\" \"expire_after_days\" = 2 \"expire_after_views\" = 5 } } $body $body.password $Body | ConvertTo-Json $Body $body = @{ password = @{ \"payload\" = \"mysecretpassword\" \"expire_after_days\" = 2 \"expire_after_views\" = 5 } } | ConvertTo-Json Invoke-WebRequest -Uri $uri -Method \"Post\" -ContentType \"application/json\" -Body $body ###Invoke-RestMethod $Uri = \"https://pwpush.com/p.json\" $params = @{ uri = $uri ContentType = \"application/json\" Method = \"Post\" body = $body } $password = Invoke-RestMethod @params $password # Let's confirm it worked $uri = \"https://pwpush.com/p/{0}.json\" -f $password.url_token Invoke-RestMethod -Uri $uri ","wordCount":"422","inLanguage":"en","datePublished":"2020-11-15T20:57:20Z","dateModified":"2022-01-03T19:48:21Z","author":{"@type":"Person","name":"Kamil"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://kamilpro.github.io/powershell-for-it-professionals-19-websites-and-apis/"},"publisher":{"@type":"Organization","name":"Kamil Pro","logo":{"@type":"ImageObject","url":"https://kamilpro.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://kamilpro.github.io accesskey=h title="Kamil Pro (Alt + H)">Kamil Pro</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://kamilpro.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://kamilpro.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://kamilpro.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href="https://www.youtube.com/playlist?list=PL-esmhgrps8Zv9bAHesStPRQ1AiUL1wY3" title="About PowerShell"><span>About PowerShell</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://kamilpro.github.io/powershell-for-it-professionals/ title="Powershell for IT professionals"><span>Powershell for IT professionals</span></a></li><li><a href=https://github.com/thekamilpro title=GitHub><span><i class='fab fa-github fa-fw'></i></span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>PowerShell for IT Professionals [#19] – Websites and APIs</h1><div class=post-meta><span title='2020-11-15 20:57:20 +0000 UTC'>2020-11-15</span>&nbsp;·&nbsp;Kamil</div></header><div class=post-content><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube-nocookie.com/embed/dzaqNeblPF4 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><p>PowerShell is a great server automation tool, but what about Internet and any other web served services?</p><p>As it turns out, PowerShell is great in scrapping websites and consuming APIs – and it’s been one of the main development areas of the tool in the last couple of years.</p><p>In this lesson we are going to see how to use PowerShell to download files, scrap websites, discover links.</p><p>We will then use an API of <a href=https://pwpush.com/>PasswordPusher (pwpush.com)</a> to generate expiring links to our secret passwords – all from within PowerShell.</p><h2 id=script>Script<a hidden class=anchor aria-hidden=true href=#script>#</a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span><span class=lnt>93
</span><span class=lnt>94
</span><span class=lnt>95
</span><span class=lnt>96
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-powershell data-lang=powershell><span class=line><span class=cl><span class=nb>Set-Location</span> <span class=n>C:</span><span class=p>\</span><span class=n>temp2</span><span class=p>;</span> <span class=nb>clear
</span></span></span><span class=line><span class=cl><span class=nb></span><span class=nv>$PSVersionTable</span>
</span></span><span class=line><span class=cl><span class=c>### Invoke-WebRequest</span>
</span></span><span class=line><span class=cl><span class=c># Downloading files</span>
</span></span><span class=line><span class=cl><span class=nv>$uri</span> <span class=p>=</span> <span class=s2>&#34;https://github.com/notepad-plus-plus/notepad-plus-plus/releases/download/v7.9.1/npp.7.9.1.Installer.x64.exe&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$here</span> <span class=p>=</span> <span class=nb>Get-Location</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Invoke-WebRequest</span> <span class=n>-Uri</span> <span class=nv>$uri</span>
</span></span><span class=line><span class=cl><span class=nb>Invoke-WebRequest</span> <span class=n>-Uri</span> <span class=nv>$uri</span> <span class=n>-OutFile</span> <span class=p>.\</span><span class=n>notepad1</span><span class=p>.</span><span class=py>exe</span>
</span></span><span class=line><span class=cl><span class=nb>ls
</span></span></span><span class=line><span class=cl><span class=nb></span>
</span></span><span class=line><span class=cl><span class=nv>$wc</span> <span class=p>=</span> <span class=p>&amp;</span><span class=c>#91;System.Net.Webclient]::New()</span>
</span></span><span class=line><span class=cl><span class=nv>$wc</span><span class=p>.</span><span class=py>DownloadFile</span><span class=p>(</span><span class=nv>$uri</span><span class=p>,</span> <span class=s2>&#34;</span><span class=nv>$here</span><span class=s2>\notepad2.exe&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>ls
</span></span></span><span class=line><span class=cl><span class=nb></span>
</span></span><span class=line><span class=cl><span class=nb>Start-BitsTransfer</span> <span class=n>-Source</span> <span class=nv>$uri</span> <span class=n>-Destination</span> <span class=s2>&#34;</span><span class=nv>$here</span><span class=s2>\notepad3.exe&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>ls
</span></span></span><span class=line><span class=cl><span class=nb></span>
</span></span><span class=line><span class=cl><span class=nv>$Website</span> <span class=p>=</span> <span class=nb>Invoke-WebRequest</span> <span class=n>-Uri</span> <span class=s2>&#34;bbc.com&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$Website</span>
</span></span><span class=line><span class=cl><span class=nv>$Website</span><span class=p>.</span><span class=n>StatusCode</span><span class=p>;</span> <span class=nv>$Website</span><span class=p>.</span><span class=n>StatusDescription</span><span class=p>;</span> <span class=nv>$Website</span><span class=p>.</span><span class=py>Headers</span>
</span></span><span class=line><span class=cl><span class=nv>$Website</span><span class=p>.</span><span class=py>RawContent</span> 
</span></span><span class=line><span class=cl><span class=nv>$Website</span><span class=p>.</span><span class=py>RawContent</span> <span class=p>|</span> <span class=nb>Out-File</span> <span class=n>website</span><span class=p>.</span><span class=py>html</span>
</span></span><span class=line><span class=cl><span class=n>explorer</span> <span class=p>.</span>
</span></span><span class=line><span class=cl><span class=c># Websites</span>
</span></span><span class=line><span class=cl><span class=nv>$Website</span><span class=p>.</span><span class=py>Links</span>
</span></span><span class=line><span class=cl><span class=nv>$Website</span><span class=p>.</span><span class=py>Links</span> <span class=p>|</span> <span class=nb>where </span><span class=p>{</span><span class=nv>$_</span><span class=p>.</span><span class=py>class</span> <span class=o>-eq</span> <span class=s2>&#34;top-list-item__link&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nv>$Website</span><span class=p>.</span><span class=py>Links</span> <span class=p>|</span> <span class=nb>where </span><span class=p>{</span><span class=nv>$_</span><span class=p>.</span><span class=py>class</span> <span class=o>-eq</span> <span class=s2>&#34;top-list-item__link&#34;</span><span class=p>}</span> <span class=p>|</span> <span class=nb>select data-bbc</span><span class=n>-title</span><span class=p>,</span><span class=n>href</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Resolving shortcut urls</span>
</span></span><span class=line><span class=cl><span class=nv>$Website</span><span class=p>.</span><span class=py>Images</span>
</span></span><span class=line><span class=cl><span class=nv>$Website</span><span class=p>.</span><span class=py>images</span> <span class=p>|</span> <span class=nb>where </span><span class=p>{</span><span class=nv>$_</span><span class=p>.</span><span class=py>src</span> <span class=o>-like</span> <span class=s2>&#34;http*&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nv>$Website</span><span class=p>.</span><span class=py>images</span> <span class=p>|</span> <span class=nb>where </span><span class=p>{</span><span class=nv>$_</span><span class=p>.</span><span class=py>src</span> <span class=o>-like</span> <span class=s2>&#34;http*&#34;</span><span class=p>}</span> <span class=p>|</span> <span class=nb>ForEach-Object</span>  <span class=p>{</span><span class=nb>Start-BitsTransfer</span> <span class=n>-Source</span> <span class=nv>$_</span><span class=p>.</span><span class=py>src</span> <span class=n>-Destination</span> <span class=s2>&#34;</span><span class=p>$(</span><span class=nv>$_</span><span class=p>.</span><span class=n>alt</span><span class=p>)</span><span class=s2>.jpg&#34;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nb>ls
</span></span></span><span class=line><span class=cl><span class=nb></span><span class=n>explorer</span> <span class=p>.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Short urls</span>
</span></span><span class=line><span class=cl><span class=nv>$uri</span> <span class=p>=</span> <span class=s2>&#34;https://bit.ly/38JsRDB&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$response</span> <span class=p>=</span> <span class=nb>Invoke-WebRequest</span> <span class=n>-Uri</span> <span class=nv>$uri</span>
</span></span><span class=line><span class=cl><span class=nv>$response</span><span class=p>.</span><span class=py>BaseResponse</span><span class=p>.</span><span class=py>RequestMessage</span><span class=p>.</span><span class=py>RequestUri</span><span class=p>.</span><span class=py>AbsoluteUri</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Api</span>
</span></span><span class=line><span class=cl><span class=nv>$Uri</span> <span class=p>=</span> <span class=s2>&#34;https://pwpush.com/p.json&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Json</span>
</span></span><span class=line><span class=cl><span class=nv>$json</span> <span class=p>=</span> <span class=s1>&#39;{
</span></span></span><span class=line><span class=cl><span class=s1>    &#34;password&#34;: {
</span></span></span><span class=line><span class=cl><span class=s1>      &#34;expire_after_views&#34;: 5,
</span></span></span><span class=line><span class=cl><span class=s1>      &#34;expire_after_days&#34;: 2,
</span></span></span><span class=line><span class=cl><span class=s1>      &#34;payload&#34;: &#34;mysecretpassword&#34;
</span></span></span><span class=line><span class=cl><span class=s1>    }
</span></span></span><span class=line><span class=cl><span class=s1>  }&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$request</span> <span class=p>=</span> <span class=nb>Invoke-WebRequest</span> <span class=n>-Uri</span> <span class=nv>$uri</span> <span class=n>-Method</span> <span class=s2>&#34;Post&#34;</span> <span class=n>-ContentType</span> <span class=s2>&#34;application/json&#34;</span> <span class=n>-Body</span> <span class=nv>$json</span>
</span></span><span class=line><span class=cl><span class=nv>$request</span>
</span></span><span class=line><span class=cl><span class=nv>$request</span><span class=p>.</span><span class=py>Content</span>
</span></span><span class=line><span class=cl><span class=nv>$request</span><span class=p>.</span><span class=py>Content</span> <span class=p>|</span> <span class=nb>ConvertFrom-Json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$body</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>password</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;payload&#34;</span> <span class=p>=</span> <span class=s2>&#34;mysecretpassword&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;expire_after_days&#34;</span> <span class=p>=</span> <span class=mf>2</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;expire_after_views&#34;</span> <span class=p>=</span> <span class=mf>5</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nv>$body</span>
</span></span><span class=line><span class=cl><span class=nv>$body</span><span class=p>.</span><span class=py>password</span> 
</span></span><span class=line><span class=cl><span class=nv>$Body</span> <span class=p>|</span> <span class=nb>ConvertTo-Json</span>
</span></span><span class=line><span class=cl><span class=nv>$Body</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$body</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>password</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;payload&#34;</span> <span class=p>=</span> <span class=s2>&#34;mysecretpassword&#34;</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;expire_after_days&#34;</span> <span class=p>=</span> <span class=mf>2</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;expire_after_views&#34;</span> <span class=p>=</span> <span class=mf>5</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=p>|</span> <span class=nb>ConvertTo-Json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Invoke-WebRequest</span> <span class=n>-Uri</span> <span class=nv>$uri</span> <span class=n>-Method</span> <span class=s2>&#34;Post&#34;</span> <span class=n>-ContentType</span> <span class=s2>&#34;application/json&#34;</span> <span class=n>-Body</span> <span class=nv>$body</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>###Invoke-RestMethod</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$Uri</span> <span class=p>=</span> <span class=s2>&#34;https://pwpush.com/p.json&#34;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=nv>$params</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>uri</span> <span class=p>=</span> <span class=nv>$uri</span>
</span></span><span class=line><span class=cl>    <span class=n>ContentType</span> <span class=p>=</span> <span class=s2>&#34;application/json&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>Method</span> <span class=p>=</span> <span class=s2>&#34;Post&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>body</span> <span class=p>=</span> <span class=nv>$body</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nv>$password</span> <span class=p>=</span> <span class=nb>Invoke-RestMethod</span> <span class=nv>@params</span>
</span></span><span class=line><span class=cl><span class=nv>$password</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Let&#39;s confirm it worked</span>
</span></span><span class=line><span class=cl><span class=nv>$uri</span> <span class=p>=</span> <span class=s2>&#34;https://pwpush.com/p/{0}.json&#34;</span> <span class=o>-f</span> <span class=nv>$password</span><span class=p>.</span><span class=py>url_token</span>
</span></span><span class=line><span class=cl><span class=nb>Invoke-RestMethod</span> <span class=n>-Uri</span> <span class=nv>$uri</span>
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://kamilpro.github.io/tags/api/>api</a></li><li><a href=https://kamilpro.github.io/tags/course/>course</a></li><li><a href=https://kamilpro.github.io/tags/download/>download</a></li><li><a href=https://kamilpro.github.io/tags/internet/>internet</a></li><li><a href=https://kamilpro.github.io/tags/invoke/>invoke</a></li><li><a href=https://kamilpro.github.io/tags/json/>json</a></li><li><a href=https://kamilpro.github.io/tags/method/>method</a></li><li><a href=https://kamilpro.github.io/tags/password/>password</a></li><li><a href=https://kamilpro.github.io/tags/powershell/>powershell</a></li><li><a href=https://kamilpro.github.io/tags/pwpush/>pwpush</a></li><li><a href=https://kamilpro.github.io/tags/request/>request</a></li><li><a href=https://kamilpro.github.io/tags/rest/>rest</a></li><li><a href=https://kamilpro.github.io/tags/scrapping/>scrapping</a></li><li><a href=https://kamilpro.github.io/tags/script/>script</a></li><li><a href=https://kamilpro.github.io/tags/training/>training</a></li><li><a href=https://kamilpro.github.io/tags/website/>website</a></li></ul></footer></article></main><footer class=footer><span>Kamil Procyszyn</span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>