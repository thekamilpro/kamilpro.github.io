<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Deploying software with GPO | Kamil Pro</title><meta name=keywords content="active directory,deployment,gpo,software"><meta name=description content="Having software consistently deployed across the fleet of computers is one of the key points that can be automated.
If I have a choice (and it makes sense), I will always choose GPO over any other solution because it’s embedded into Active Directory thus not requiring installation, learning and maintenance of additional management tool.
MSI – Software Installation One of the main advantages of MSI installers is that in 99% of cases you can just use the “Software Installation” option in GPO, and GPO will take care of the silent installation."><meta name=author content="Kamil"><link rel=canonical href=https://kamilpro.github.io/deploying-software-with-gpo/><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://kamilpro.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://kamilpro.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://kamilpro.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://kamilpro.github.io/apple-touch-icon.png><link rel=mask-icon href=https://kamilpro.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=text/plain href=https://kamilpro.github.io/deploying-software-with-gpo/index.md><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Deploying software with GPO"><meta property="og:description" content="Having software consistently deployed across the fleet of computers is one of the key points that can be automated.
If I have a choice (and it makes sense), I will always choose GPO over any other solution because it’s embedded into Active Directory thus not requiring installation, learning and maintenance of additional management tool.
MSI – Software Installation One of the main advantages of MSI installers is that in 99% of cases you can just use the “Software Installation” option in GPO, and GPO will take care of the silent installation."><meta property="og:type" content="article"><meta property="og:url" content="https://kamilpro.github.io/deploying-software-with-gpo/"><meta property="og:image" content="https://kamilpro.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-03-15T14:25:59+00:00"><meta property="article:modified_time" content="2022-01-03T19:48:21+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kamilpro.github.io/logo.png"><meta name=twitter:title content="Deploying software with GPO"><meta name=twitter:description content="Having software consistently deployed across the fleet of computers is one of the key points that can be automated.
If I have a choice (and it makes sense), I will always choose GPO over any other solution because it’s embedded into Active Directory thus not requiring installation, learning and maintenance of additional management tool.
MSI – Software Installation One of the main advantages of MSI installers is that in 99% of cases you can just use the “Software Installation” option in GPO, and GPO will take care of the silent installation."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://kamilpro.github.io/posts/"},{"@type":"ListItem","position":3,"name":"Deploying software with GPO","item":"https://kamilpro.github.io/deploying-software-with-gpo/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Deploying software with GPO","name":"Deploying software with GPO","description":"Having software consistently deployed across the fleet of computers is one of the key points that can be automated.\nIf I have a choice (and it makes sense), I will always choose GPO over any other solution because it’s embedded into Active Directory thus not requiring installation, learning and maintenance of additional management tool.\nMSI – Software Installation One of the main advantages of MSI installers is that in 99% of cases you can just use the “Software Installation” option in GPO, and GPO will take care of the silent installation.","keywords":["active directory","deployment","gpo","software"],"articleBody":"Having software consistently deployed across the fleet of computers is one of the key points that can be automated.\nIf I have a choice (and it makes sense), I will always choose GPO over any other solution because it’s embedded into Active Directory thus not requiring installation, learning and maintenance of additional management tool.\nMSI – Software Installation One of the main advantages of MSI installers is that in 99% of cases you can just use the “Software Installation” option in GPO, and GPO will take care of the silent installation. In addition, if the newer version of the installer is ever listed, you can simply link the newer version of the installer, and GPO will take care of upgrading current installations.\nThe rule is, if the installer doesn’t have any mandatory custom made parameters, it will silently push the software.\nHow to find out if the MSI can be silently installed with GPO We are going to use the MsiExec (Windows Installer) tool, my installer file is called: GoogleChromeStandaloneEnterprise64.msi\nAnd command line syntax is:\nMsiexec /i \u003c\u003e /quiet Thus making my command to look like this:\nmsiexec /i GoogleChromeStandaloneEnterprise64.msi /quiet If after issuing that command you can see your piece of software has been installed, it’s good to go with GPO.\nSet up GPO To make the GPO working, we need to put an installer file on some network share, and since it’s going to be computers accessing the file, the computer must have read access – not the user – to the file. The easiest way to achieve this is to use NETLOGON folder.\nYou access it via \\«DomainNAme»\\NETLOGON\nIf you’re not sure what your domain name is, simply open Group Policy manager and it will be listed there:\nSo I’m going to copy the installer file to my NETLOGON folder:\n\\company.pri\\NETLOGON\nAnd create a new GPO:\nTo create a GPO for the installer:\nAfter opening the Group Policy Management, right-click on the root/or OU and choose to create a new GPO and link it.\nGive it an appropriate name and then expand settings:\nComputer \u003e Policies \u003e Software Settings \u003e Software Installation. Then right-click \u003e New \u003e Package.\nPoint it to your installer file – critical is you must point via network share; thus either \\DomainName\\someshare or \\ComputerName\\share Choose assign and job done.\nEXE and Non-standard MSI files Sometimes the software installer requires providing custom switches, and the only way to achieve the installation is to use a custom script. Thankfully in GPO, we have an option of startup/shutdown scripts – that the script will execute every time the computers boots/shuts down.\nOn the side note, I’ll add that you can schedule a task via GPO that will kick in the script on a regular basis, or every boot – in case you’d need that. I had once a need to deploy the management client that tended to stop its services with no apparent reason, making management of computers that were out in the field a daunting task. Got it solved by having the installer and script copied to the local machine and a scheduled task that was executing script once per hour. The problem of unmanaged computers has gone. The problem with that kind of installers is the fact they often don’t advertise what switches are required, making it much more difficult. Thus at this stage, you might be forced to either check the developer’s website/manual or even contact them if the silent installation is supported. You can also have a look in the section of tips below which might point you to the solution.\nLet’s take as an example the installer for Airtame – it’s MSI based, however, requires special switches for silent installation. Likely enough, the software vendor has provided the manual and switches required:\nhttps://help.airtame.com/en/articles/2543555-how-to-deploy-the-airtame-app-via-msi\nThe fastest way to validate the script, without writing the script, is to run in the shell.\nYou can open the shell by pressing and holding SHIFT key, then right-click in the windows and choose “Open Windows shell here”\nmsiexec /i \"airtame-application-3.5.1-setup.msi\" /quiet WRAPPED_ARGUMENTS=\"/autostart=false /streaming_notification=true\" Once I’ve validated it’s been installed, time to create a script.\nGPO with the Startup script I’ve put the installer to the NETLOGON as a previous installer.\nCreate a new GPO and configure it as follows:\nExpand Computer Configuration \u003e Policies \u003e Windows Settings \u003e Scripts \u003e Startup\nIn the Startup Properties click “Show Files…” and create a new text file there, changing its extension to BAT (what I have set up on all my machines, is to show file extensions – this way I can change file extensions as a file name change), open it and paste the script below:\npushd //company.pri/NETLOGON msiexec /i \"Airtame-3.5.1-setup.msi\" /quiet WRAPPED_ARGUMENTS=\"/autostart=false /streaming_notification=true\" Popd First-line changes to the working directory to the folder where installation file is\nThe second line is the same command with testes moment ago\nThe last line will return the path the original location – not really needed, but it’s nice to have it.\nSave the file.\nBefore closing the Startup explorer window, copy the path (it’s ridiculously long) in my example:\n\\company.pri\\SysVol\\company.pri\\Policies{299CE059-AD3B-4F12-9DC3-3AC9EB36124E}\\Machine\\Scripts\\Startup\nComing back to “Startup Properties” window, click “Add” this time, and if you can’t see your script, paste the path to the window – now you can point to the script file you’ve just created.\nGo to your test machine, run “gpupdate /force” from the shell and reboot your machine – validate the software got installed.\nHelpful websites https://chocolatey.org/search – Chocolatey is a powerful package manager based on PowerShell. You can discover switches by reviewing their ps1 files, available on the website. It’s also a great product for installing and maintaining your application – have a look and you’ll forget what it’s like to Google for software installer and updating applications one by one.\nhttps://www.manageengine.com/products/desktop-central/software-installation/latest-software.html – Another great tool, this one is being used for managing computers. On the link above, you can discover how they push particular pieces of software.\nhttps://www.itninja.com/ – a great website for IT Professionals, and in context of this post, has a lot of how-tos on deploying software.\nPhoto by Ferdinand Stöhr on Unsplash\n","wordCount":"1020","inLanguage":"en","datePublished":"2020-03-15T14:25:59Z","dateModified":"2022-01-03T19:48:21Z","author":{"@type":"Person","name":"Kamil"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://kamilpro.github.io/deploying-software-with-gpo/"},"publisher":{"@type":"Organization","name":"Kamil Pro","logo":{"@type":"ImageObject","url":"https://kamilpro.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://kamilpro.github.io accesskey=h title="Kamil Pro (Alt + H)">Kamil Pro</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://kamilpro.github.io/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://kamilpro.github.io/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://kamilpro.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href="https://www.youtube.com/playlist?list=PL-esmhgrps8Zv9bAHesStPRQ1AiUL1wY3" title="About PowerShell"><span>About PowerShell</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://kamilpro.github.io/powershell-for-it-professionals/ title="Powershell for IT professionals"><span>Powershell for IT professionals</span></a></li><li><a href=https://github.com/thekamilpro title=GitHub><span><i class='fab fa-github fa-fw'></i></span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Deploying software with GPO</h1><div class=post-meta><span title='2020-03-15 14:25:59 +0000 UTC'>2020-03-15</span>&nbsp;·&nbsp;Kamil</div></header><div class=post-content><p>Having software consistently deployed across the fleet of computers is one of the key points that can be automated.</p><p>If I have a choice (and it makes sense), I will always choose GPO over any other solution because it’s embedded into Active Directory thus not requiring installation, learning and maintenance of additional management tool.</p><h1 id=msi-8211-software-installation>MSI – Software Installation<a hidden class=anchor aria-hidden=true href=#msi-8211-software-installation>#</a></h1><p>One of the main advantages of MSI installers is that in 99% of cases you can just use the “Software Installation” option in GPO, and GPO will take care of the silent installation. In addition, if the newer version of the installer is ever listed, you can simply link the newer version of the installer, and GPO will take care of upgrading current installations.</p><p>The rule is, if the installer doesn’t have any mandatory custom made parameters, it will silently push the software.</p><h2 id=how-to-find-out-if-the-msi-can-be-silently-installed-with-gpo>How to find out if the MSI can be silently installed with GPO<a hidden class=anchor aria-hidden=true href=#how-to-find-out-if-the-msi-can-be-silently-installed-with-gpo>#</a></h2><p>We are going to use the MsiExec (Windows Installer) tool, my installer file is called: GoogleChromeStandaloneEnterprise64.msi</p><p>And command line syntax is:</p><pre class=wp-block-preformatted>Msiexec /i &lt;&lt;Path/File name>> /quiet</pre><p>Thus making my command to look like this:</p><pre class=wp-block-preformatted>msiexec /i GoogleChromeStandaloneEnterprise64.msi /quiet</pre><p>If after issuing that command you can see your piece of software has been installed, it’s good to go with GPO.</p><h2 id=set-up-gpo>Set up GPO<a hidden class=anchor aria-hidden=true href=#set-up-gpo>#</a></h2><p>To make the GPO working, we need to put an installer file on some network share, and since it’s going to be computers accessing the file, the computer must have read access – not the user – to the file. The easiest way to achieve this is to use NETLOGON folder.</p><p>You access it via <a href=file://DomainNAme/NETLOGON>\&#171;DomainNAme&#187;\NETLOGON</a></p><p>If you’re not sure what your domain name is, simply open Group Policy manager and it will be listed there:<figure class="wp-block-image size-large"></p><p><img loading=lazy width=351 height=310 src="https://i0.wp.com/kamilpro.com/wp-content/uploads/2020/03/image-4.jpg?resize=351%2C310&#038;ssl=1" alt class=wp-image-1587 srcset="https://i0.wp.com/kamilpro.com/wp-content/uploads/2020/03/image-4.jpg?w=351&ssl=1 351w, https://i0.wp.com/kamilpro.com/wp-content/uploads/2020/03/image-4.jpg?resize=300%2C265&ssl=1 300w" sizes="(max-width: 351px) 100vw, 351px" data-recalc-dims=1></figure></p><p>So I’m going to copy the installer file to my NETLOGON folder:</p><p><a href=file://company.pri/NETLOGON>\company.pri\NETLOGON</a></p><p>And create a new GPO:<figure class="wp-block-image size-large"></p><p><img loading=lazy width=1354 height=766 src="https://i1.wp.com/kamilpro.com/wp-content/uploads/2020/03/GPO-Software-Install.gif?fit=900%2C509&ssl=1" alt class=wp-image-1590></figure></p><p>To create a GPO for the installer:</p><p>After opening the Group Policy Management, right-click on the root/or OU and choose to create a new GPO and link it.</p><p>Give it an appropriate name and then expand settings:</p><p>Computer > Policies > Software Settings > Software Installation. Then right-click > New > Package.</p><p>Point it to your installer file – critical is you must point via network share; thus either <a href=file://DomainName/someshare%20or%20/ComputerName/share>\DomainName\someshare or \ComputerName\share</a> </p><p>Choose assign and job done.</p><h1 id=exe-and-non-standard-msi-files>EXE and Non-standard MSI files<a hidden class=anchor aria-hidden=true href=#exe-and-non-standard-msi-files>#</a></h1><p>Sometimes the software installer requires providing custom switches, and the only way to achieve the installation is to use a custom script. Thankfully in GPO, we have an option of startup/shutdown scripts – that the script will execute every time the computers boots/shuts down.</p><p class="has-background has-cyan-bluish-gray-background-color">On the side note, I&#8217;ll add that you can schedule a task via GPO that will kick in the script on a regular basis, or every boot &#8211; in case you&#8217;d need that. I had once a need to deploy the management client that tended to stop its services with no apparent reason, making management of computers that were out in the field a daunting task. Got it solved by having the installer and script copied to the local machine and a scheduled task that was executing script once per hour. The problem of unmanaged computers has gone.</p><p>The problem with that kind of installers is the fact they often don’t advertise what switches are required, making it much more difficult. Thus at this stage, you might be forced to either check the developer’s website/manual or even contact them if the silent installation is supported. You can also have a look in the section of tips below which might point you to the solution.</p><p>Let’s take as an example the installer for Airtame – it’s MSI based, however, requires special switches for silent installation. Likely enough, the software vendor has provided the manual and switches required:</p><p><a href=https://help.airtame.com/en/articles/2543555-how-to-deploy-the-airtame-app-via-msi>https://help.airtame.com/en/articles/2543555-how-to-deploy-the-airtame-app-via-msi</a></p><p>The fastest way to validate the script, without writing the script, is to run in the shell.</p><p>You can open the shell by pressing and holding SHIFT key, then right-click in the windows and choose “Open Windows shell here”</p><pre class=wp-block-preformatted>msiexec /i "airtame-application-3.5.1-setup.msi" /quiet
WRAPPED_ARGUMENTS="/autostart=false /streaming_notification=true"</pre><p>Once I’ve validated it’s been installed, time to create a script.</p><h2 id=gpo-with-the-startup-scriptfigure-classwp-block-image-size-large>GPO with the Startup script<figure class="wp-block-image size-large"><a hidden class=anchor aria-hidden=true href=#gpo-with-the-startup-scriptfigure-classwp-block-image-size-large>#</a></h2><p><img loading=lazy width=1354 height=766 src="https://i2.wp.com/kamilpro.com/wp-content/uploads/2020/03/GPO-Startup-Script.gif?fit=900%2C509&ssl=1" alt class=wp-image-1591></figure></p><p>I’ve put the installer to the NETLOGON as a previous installer.</p><p>Create a new GPO and configure it as follows:</p><p>Expand Computer Configuration > Policies > Windows Settings > Scripts > Startup</p><p>In the Startup Properties click “Show Files…” and create a new text file there, changing its extension to BAT (what I have set up on all my machines, is to show file extensions – this way I can change file extensions as a file name change), open it and paste the script below:</p><pre class=wp-block-preformatted>pushd //company.pri/NETLOGON
msiexec /i "Airtame-3.5.1-setup.msi" /quiet WRAPPED_ARGUMENTS="/autostart=false /streaming_notification=true"
Popd</pre><p>First-line changes to the working directory to the folder where installation file is</p><p>The second line is the same command with testes moment ago</p><p>The last line will return the path the original location – not really needed, but it’s nice to have it.</p><p>Save the file.</p><p>Before closing the Startup explorer window, copy the path (it’s ridiculously long) in my example:</p><p><a href=file://company.pri/SysVol/company.pri/Policies/%7b299CE059-AD3B-4F12-9DC3-3AC9EB36124E%7d/Machine/Scripts/Startup>\company.pri\SysVol\company.pri\Policies{299CE059-AD3B-4F12-9DC3-3AC9EB36124E}\Machine\Scripts\Startup</a></p><p>Coming back to “Startup Properties” window, click “Add” this time, and if you can’t see your script, paste the path to the window – now you can point to the script file you’ve just created.</p><p>Go to your test machine, run “gpupdate /force” from the shell and reboot your machine – validate the software got installed.</p><h1 id=helpful-websites>Helpful websites<a hidden class=anchor aria-hidden=true href=#helpful-websites>#</a></h1><p><a href=https://chocolatey.org/search>https://chocolatey.org/search</a> – Chocolatey is a powerful package manager based on PowerShell. You can discover switches by reviewing their ps1 files, available on the website. It’s also a great product for installing and maintaining your application – have a look and you’ll forget what it’s like to Google for software installer and updating applications one by one.</p><p><a href=https://www.manageengine.com/products/desktop-central/software-installation/latest-software.html>https://www.manageengine.com/products/desktop-central/software-installation/latest-software.html</a> – Another great tool, this one is being used for managing computers. On the link above, you can discover how they push particular pieces of software.</p><p><a href=https://www.itninja.com/>https://www.itninja.com/</a> – a great website for IT Professionals, and in context of this post, has a lot of how-tos on deploying software.</p><p>Photo by <a href="https://unsplash.com/@fellowferdi?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Ferdinand Stöhr</a> on <a href="https://unsplash.com/s/photos/pattern?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText">Unsplash</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://kamilpro.github.io/tags/active-directory/>active directory</a></li><li><a href=https://kamilpro.github.io/tags/deployment/>deployment</a></li><li><a href=https://kamilpro.github.io/tags/gpo/>gpo</a></li><li><a href=https://kamilpro.github.io/tags/software/>software</a></li></ul></footer></article></main><footer class=footer><span>Kamil Procyszyn</span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>