<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>PowerShell Hash Table - Storing key value pairs | Kamil Pro</title><meta name=keywords content="PowerShell,table,key,value,pair,list,script"><meta name=description content="Quick crash course into using hash tables in PowerShell.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 <#PSScriptInfo ."><meta name=author content="Kamil"><link rel=canonical href=https://kamilpro.com/powershell-hash-table/><link crossorigin=anonymous href=/assets/css/stylesheet.5cfc680b1eeaeef9efbced92d46c2a9e876b72ee14fba85846afc4cff9e6e6f8.css integrity="sha256-XPxoCx7q7vnvvO2S1Gwqnodrcu4U+6hYRq/Ez/nm5vg=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://kamilpro.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://kamilpro.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://kamilpro.com/favicon-32x32.png><link rel=apple-touch-icon href=https://kamilpro.com/apple-touch-icon.png><link rel=mask-icon href=https://kamilpro.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=text/plain href=https://kamilpro.com/powershell-hash-table/index.md><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="PowerShell Hash Table - Storing key value pairs"><meta property="og:description" content="Quick crash course into using hash tables in PowerShell.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 <#PSScriptInfo ."><meta property="og:type" content="article"><meta property="og:url" content="https://kamilpro.com/powershell-hash-table/"><meta property="og:image" content="https://kamilpro.com/powershell-hash-table/featured-image.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-09-14T00:00:00+00:00"><meta property="article:modified_time" content="2022-05-01T21:39:25+01:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kamilpro.com/powershell-hash-table/featured-image.png"><meta name=twitter:title content="PowerShell Hash Table - Storing key value pairs"><meta name=twitter:description content="Quick crash course into using hash tables in PowerShell.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 <#PSScriptInfo ."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://kamilpro.com/posts/"},{"@type":"ListItem","position":3,"name":"PowerShell Hash Table - Storing key value pairs","item":"https://kamilpro.com/powershell-hash-table/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"PowerShell Hash Table - Storing key value pairs","name":"PowerShell Hash Table - Storing key value pairs","description":"Quick crash course into using hash tables in PowerShell.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 \u0026lt;#PSScriptInfo .","keywords":["PowerShell","table","key","value","pair","list","script"],"articleBody":" Quick crash course into using hash tables in PowerShell.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 \u003c#PSScriptInfo .VERSION 1.0.0 .GUID 50fa84c4-080d-45cd-82a8-9e8dba10b187 .AUTHOR Kamil Procyszyn .COPYRIGHT Kamil Procyszyn .PROJECTURI https://github.com/kprocyszyn/About-PowerShell .RELEASENOTES 2021 September .DESCRIPTION Link to the video: https://youtu.be/oti2l8EmAT8 Documentation: https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_hash_tables?view=powershell-7.1#:~:text=In%20PowerShell%2C%20each%20hash%20table%20is%20a%20Hashtable,to%20create%20an%20ordered%20dictionary%20%28System.Collections.Specialized.OrderedDictionary%29%20in%20PowerShell. #\u003e \u003c# About hashtable: A hash table, also known as a dictionary or associative array, is a compact data structure that stores one or more key/value pairs. For example, a hash table might contain a series of IP addresses and computer names, where the IP addresses are the keys and the computer names are the values, or vice versa. #\u003e #Creating a hashtable $hash = @{} ############################# # Adding items to hashtable # ############################# $hash.Add(\"Person\", \"John\") $hash.Add(\"Email\", \"John@john.com\") $hash.Add(\"Pet\", \"Cat\") $hash.Add(\"Surname\", \"Smith\") $hash # Removing Key from hashtable $hash.Remove(\"Surname\") $hash # Prepopulating hashtable $details = @{ Person = \"Mike\" Email = \"Mike@Mike.com\" Pet = \"Dog\" } $details # Adding key that already exists throws $details.Add(\"Pet\", \"Snake\") ################### # Accessing items # ################### # Accessing with property name $details['Pet'] $details.Pet # We can use variable $property = \"Email\" $details[$property] # Accessing multiple properties $details[\"Email\", \"Person\"] # Non existent value doesn't throw $details['Surname'] $details.Surname # Although we can check for true/false [bool]$details['Surname'] ################### # Updating values # ################### # We can update and add new values $details['Pet'] = \"Snake\" $details['Drink'] = \"Flat white\" $details $details.pet = \"Dog\" $details.Food = \"Lamb Shish Kebab\" $details ########### # Looping # ########### # using foreach foreach ($key in $details.Keys) { \"{0} is {1}\" -f $key, $details[$key] } # piping to foreach-object $details.Keys | ForEach-Object { \"{0} is {1}\" -f $_, $details[$_] } # GetEnumerator() allows us to work with properties $details.GetEnumerator() | ForEach-Object { \"{0} is {1}\" -f $_.Key, $_.Value } # Values can't be updated while enumarated! foreach ($key in $details.Keys) { $details[$key] = 'BLAH' } # Keys must be cloned before updating $details.Keys.Clone() | ForEach-Object { $details[$_] = \"SANITISED\" } $details ###### # IF # ###### # checking if hashtable exists if ($details) {\"It's there\"} $empty = @{} if ($empty) {\"It's empty, but it's there!\"} # Checking if key exists if ($details.Person) {\"There's some info about a person\"} # Deailing with false $details.Add(\"Empty\", \"\") $details.Add(\"Null\", $Null) $details.Add(\"False\", $false) $details if ($details.Empty) {\"It's there\"} if ($details.Null) {\"It's there\"} if ($details.False) {\"It's there\"} if ($details.ContainsKey('Null')) {\"It's null!\"} ###################### # Custom expressions # ###################### $employee = @{ Name = \"Beth\" HourlyWage = 10 HoursWorked = 7.5 } $employee | Select-Object -Property *,@{N = \"Wage\"; E = {$_.HourlyWage * $_.HoursWorked } } ############# # Splatting # ############# Invoke-RestMethod -Uri catfact.ninja/facts -Method Get | Select-Object Data -ExpandProperty Data $params = @{ Uri = \"catfact.ninja/facts\" Method = \"Get\" } Invoke-RestMethod @params | Select-Object Data -ExpandProperty Data # Adding parameters $Verbose = $true if ($Verbose) { $params['Verbose'] = $true } Invoke-RestMethod @params ##################### # Nested hashtables # ##################### $Environments = @{ Development = @{ Server = \"Server1\" Admin = \"Rachel Green\" Credentials = @{ Username = \"Serv1\" Password = \"Secret\" } } Test = @{ Server = \"Server2\" Admin = \"Joe Triviani\" Credentials = @{ Username = \"Serv2\" Password = \"Letmein\" } } } # Accessing nested properties $Environments $Environments.Keys $Environments.Values $Environments.Test $Environments.Test.Credentials $Environments['Test']['Credentials'] # Updating nested properties $Environments.Test.Credentials.Username = \"admin\" $Environments.Test.Credentials # Quickly unwrapping all properties $Environments | ConvertTo-Json -Depth 99 # Adding nested properties $Environments['Production'] = @{} $Environments.Production.Server = \"Server3\" $Environments.Production.Admin = \"Ross Geller\" $Environments.Production['Credentials'] = @{} $Environments.Production.Credentials.Username = \"Serv3\" $Environments.Production.Credentials.Password = \"Nosuchplace\" ##################### # Working with JSON # ##################### $Environments | ConvertTo-Json | Out-File C:\\temp\\envs.json Get-Content C:\\Temp\\envs.json | ConvertFrom-Json #This will create pscustomobject ################## # PSCustomObject # ################## # Creating a new object $EnvironmentsObject = [pscustomobject]@{ Development = @{ Server = \"Server1\" Admin = \"Rachel Green\" Credentials = @{ Username = \"Serv1\" Password = \"Secret\" } } Test = @{ Server = \"Server2\" Admin = \"Joe Triviani\" Credentials = @{ Username = \"Serv2\" Password = \"Letmein\" } } } # Casting hashtable to object [PSCustomObject]$Environments ","wordCount":"894","inLanguage":"en","datePublished":"2021-09-14T00:00:00Z","dateModified":"2022-05-01T21:39:25+01:00","author":{"@type":"Person","name":"Kamil"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://kamilpro.com/powershell-hash-table/"},"publisher":{"@type":"Organization","name":"Kamil Pro","logo":{"@type":"ImageObject","url":"https://kamilpro.com/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://kamilpro.com accesskey=h title="Kamil Pro (Alt + H)">Kamil Pro</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://kamilpro.com/posts/ title=Posts><span>Posts</span></a></li><li><a href=https://kamilpro.com/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://kamilpro.com/categories/ title=Categories><span>Categories</span></a></li><li><a href="https://www.youtube.com/playlist?list=PL-esmhgrps8Zv9bAHesStPRQ1AiUL1wY3" title="About PowerShell"><span>About PowerShell</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=https://kamilpro.com/powershell-for-it-professionals/ title="Powershell for IT professionals"><span>Powershell for IT professionals</span></a></li><li><a href=https://github.com/thekamilpro title=GitHub><span><i class='fab fa-github fa-fw'></i></span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>PowerShell Hash Table - Storing key value pairs</h1><div class=post-meta><span title='2021-09-14 00:00:00 +0000 UTC'>2021-09-14</span>&nbsp;Â·&nbsp;Kamil</div></header><div class=post-content><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube-nocookie.com/embed/oti2l8EmAT8 style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><p>Quick crash course into using hash tables in PowerShell.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span><span class=lnt>213
</span><span class=lnt>214
</span><span class=lnt>215
</span><span class=lnt>216
</span><span class=lnt>217
</span><span class=lnt>218
</span><span class=lnt>219
</span><span class=lnt>220
</span><span class=lnt>221
</span><span class=lnt>222
</span><span class=lnt>223
</span><span class=lnt>224
</span><span class=lnt>225
</span><span class=lnt>226
</span><span class=lnt>227
</span><span class=lnt>228
</span><span class=lnt>229
</span><span class=lnt>230
</span><span class=lnt>231
</span><span class=lnt>232
</span><span class=lnt>233
</span><span class=lnt>234
</span><span class=lnt>235
</span><span class=lnt>236
</span><span class=lnt>237
</span><span class=lnt>238
</span><span class=lnt>239
</span><span class=lnt>240
</span><span class=lnt>241
</span><span class=lnt>242
</span><span class=lnt>243
</span><span class=lnt>244
</span><span class=lnt>245
</span><span class=lnt>246
</span><span class=lnt>247
</span><span class=lnt>248
</span><span class=lnt>249
</span><span class=lnt>250
</span><span class=lnt>251
</span><span class=lnt>252
</span><span class=lnt>253
</span><span class=lnt>254
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ps1 data-lang=ps1><span class=line><span class=cl><span class=cm>&lt;#PSScriptInfo
</span></span></span><span class=line><span class=cl><span class=cm>.VERSION 1.0.0
</span></span></span><span class=line><span class=cl><span class=cm>.GUID 50fa84c4-080d-45cd-82a8-9e8dba10b187
</span></span></span><span class=line><span class=cl><span class=cm>.AUTHOR Kamil Procyszyn
</span></span></span><span class=line><span class=cl><span class=cm>.COPYRIGHT Kamil Procyszyn
</span></span></span><span class=line><span class=cl><span class=cm>.PROJECTURI https://github.com/kprocyszyn/About-PowerShell
</span></span></span><span class=line><span class=cl><span class=cm>.RELEASENOTES 2021 September
</span></span></span><span class=line><span class=cl><span class=cm>.</span><span class=sd>DESCRIPTION</span><span class=cm>
</span></span></span><span class=line><span class=cl><span class=cm>Link to the video: https://youtu.be/oti2l8EmAT8
</span></span></span><span class=line><span class=cl><span class=cm>Documentation: https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_hash_tables?view=powershell-7.1#:~:text=In%20PowerShell%2C%20each%20hash%20table%20is%20a%20Hashtable,to%20create%20an%20ordered%20dictionary%20%28System.Collections.Specialized.OrderedDictionary%29%20in%20PowerShell.
</span></span></span><span class=line><span class=cl><span class=cm>#&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cm>&lt;#
</span></span></span><span class=line><span class=cl><span class=cm>About hashtable:
</span></span></span><span class=line><span class=cl><span class=cm>A hash table, also known as a dictionary or associative array, 
</span></span></span><span class=line><span class=cl><span class=cm>is a compact data structure that stores one or more key/value pairs. 
</span></span></span><span class=line><span class=cl><span class=cm>For example, a hash table might contain a series of IP addresses and computer names, 
</span></span></span><span class=line><span class=cl><span class=cm>where the IP addresses are the keys and the computer names are the values, or vice versa.
</span></span></span><span class=line><span class=cl><span class=cm>#&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>#Creating a hashtable</span>
</span></span><span class=line><span class=cl><span class=nv>$hash</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>#############################</span>
</span></span><span class=line><span class=cl><span class=c># Adding items to hashtable #</span>
</span></span><span class=line><span class=cl><span class=c>#############################</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$hash</span><span class=p>.</span><span class=py>Add</span><span class=p>(</span><span class=s2>&#34;Person&#34;</span><span class=p>,</span> <span class=s2>&#34;John&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$hash</span><span class=p>.</span><span class=py>Add</span><span class=p>(</span><span class=s2>&#34;Email&#34;</span><span class=p>,</span> <span class=s2>&#34;John@john.com&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$hash</span><span class=p>.</span><span class=py>Add</span><span class=p>(</span><span class=s2>&#34;Pet&#34;</span><span class=p>,</span> <span class=s2>&#34;Cat&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$hash</span><span class=p>.</span><span class=py>Add</span><span class=p>(</span><span class=s2>&#34;Surname&#34;</span><span class=p>,</span> <span class=s2>&#34;Smith&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$hash</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Removing Key from hashtable</span>
</span></span><span class=line><span class=cl><span class=nv>$hash</span><span class=p>.</span><span class=py>Remove</span><span class=p>(</span><span class=s2>&#34;Surname&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$hash</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Prepopulating hashtable</span>
</span></span><span class=line><span class=cl><span class=nv>$details</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Person</span> <span class=p>=</span> <span class=s2>&#34;Mike&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>Email</span> <span class=p>=</span> <span class=s2>&#34;Mike@Mike.com&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>Pet</span> <span class=p>=</span> <span class=s2>&#34;Dog&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nv>$details</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Adding key that already exists throws</span>
</span></span><span class=line><span class=cl><span class=nv>$details</span><span class=p>.</span><span class=py>Add</span><span class=p>(</span><span class=s2>&#34;Pet&#34;</span><span class=p>,</span> <span class=s2>&#34;Snake&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>###################</span>
</span></span><span class=line><span class=cl><span class=c># Accessing items #</span>
</span></span><span class=line><span class=cl><span class=c>###################</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Accessing with property name</span>
</span></span><span class=line><span class=cl><span class=nv>$details</span><span class=p>[</span><span class=s1>&#39;Pet&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nv>$details</span><span class=p>.</span><span class=py>Pet</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># We can use variable</span>
</span></span><span class=line><span class=cl><span class=nv>$property</span> <span class=p>=</span> <span class=s2>&#34;Email&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$details</span><span class=p>[</span><span class=nv>$property</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Accessing multiple properties</span>
</span></span><span class=line><span class=cl><span class=nv>$details</span><span class=p>[</span><span class=s2>&#34;Email&#34;</span><span class=p>,</span> <span class=s2>&#34;Person&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Non existent value doesn&#39;t throw</span>
</span></span><span class=line><span class=cl><span class=nv>$details</span><span class=p>[</span><span class=s1>&#39;Surname&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nv>$details</span><span class=p>.</span><span class=py>Surname</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Although we can check for true/false </span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=no>bool</span><span class=p>]</span><span class=nv>$details</span><span class=p>[</span><span class=s1>&#39;Surname&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>###################</span>
</span></span><span class=line><span class=cl><span class=c># Updating values #</span>
</span></span><span class=line><span class=cl><span class=c>###################</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># We can update and add new values</span>
</span></span><span class=line><span class=cl><span class=nv>$details</span><span class=p>[</span><span class=s1>&#39;Pet&#39;</span><span class=p>]</span> <span class=p>=</span> <span class=s2>&#34;Snake&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$details</span><span class=p>[</span><span class=s1>&#39;Drink&#39;</span><span class=p>]</span> <span class=p>=</span> <span class=s2>&#34;Flat white&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$details</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$details</span><span class=p>.</span><span class=py>pet</span> <span class=p>=</span> <span class=s2>&#34;Dog&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$details</span><span class=p>.</span><span class=py>Food</span> <span class=p>=</span> <span class=s2>&#34;Lamb Shish Kebab&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$details</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>###########</span>
</span></span><span class=line><span class=cl><span class=c># Looping #</span>
</span></span><span class=line><span class=cl><span class=c>###########</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># using foreach</span>
</span></span><span class=line><span class=cl><span class=k>foreach</span> <span class=p>(</span><span class=nv>$key</span> <span class=k>in</span> <span class=nv>$details</span><span class=p>.</span><span class=n>Keys</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;{0} is {1}&#34;</span> <span class=o>-f</span> <span class=nv>$key</span><span class=p>,</span> <span class=nv>$details</span><span class=p>[</span><span class=nv>$key</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># piping to foreach-object</span>
</span></span><span class=line><span class=cl><span class=nv>$details</span><span class=p>.</span><span class=py>Keys</span> <span class=p>|</span> <span class=nb>ForEach-Object</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;{0} is {1}&#34;</span> <span class=o>-f</span> <span class=nv>$_</span><span class=p>,</span> <span class=nv>$details</span><span class=p>[</span><span class=nv>$_</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># GetEnumerator() allows us to work with properties</span>
</span></span><span class=line><span class=cl><span class=nv>$details</span><span class=p>.</span><span class=py>GetEnumerator</span><span class=p>()</span> <span class=p>|</span> <span class=nb>ForEach-Object</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;{0} is {1}&#34;</span> <span class=o>-f</span> <span class=nv>$_</span><span class=p>.</span><span class=n>Key</span><span class=p>,</span> <span class=nv>$_</span><span class=p>.</span><span class=py>Value</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Values can&#39;t be updated while enumarated!</span>
</span></span><span class=line><span class=cl><span class=k>foreach</span> <span class=p>(</span><span class=nv>$key</span> <span class=k>in</span> <span class=nv>$details</span><span class=p>.</span><span class=n>Keys</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$details</span><span class=p>[</span><span class=nv>$key</span><span class=p>]</span> <span class=p>=</span> <span class=s1>&#39;BLAH&#39;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Keys must be cloned before updating</span>
</span></span><span class=line><span class=cl><span class=nv>$details</span><span class=p>.</span><span class=py>Keys</span><span class=p>.</span><span class=py>Clone</span><span class=p>()</span> <span class=p>|</span> <span class=nb>ForEach-Object</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$details</span><span class=p>[</span><span class=nv>$_</span><span class=p>]</span> <span class=p>=</span> <span class=s2>&#34;SANITISED&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nv>$details</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>######</span>
</span></span><span class=line><span class=cl><span class=c># IF #</span>
</span></span><span class=line><span class=cl><span class=c>######</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># checking if hashtable exists</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$details</span><span class=p>)</span> <span class=p>{</span><span class=s2>&#34;It&#39;s there&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$empty</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$empty</span><span class=p>)</span> <span class=p>{</span><span class=s2>&#34;It&#39;s empty, but it&#39;s there!&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Checking if key exists</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$details</span><span class=p>.</span><span class=n>Person</span><span class=p>)</span> <span class=p>{</span><span class=s2>&#34;There&#39;s some info about a person&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Deailing with false</span>
</span></span><span class=line><span class=cl><span class=nv>$details</span><span class=p>.</span><span class=py>Add</span><span class=p>(</span><span class=s2>&#34;Empty&#34;</span><span class=p>,</span> <span class=s2>&#34;&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$details</span><span class=p>.</span><span class=py>Add</span><span class=p>(</span><span class=s2>&#34;Null&#34;</span><span class=p>,</span> <span class=vm>$Null</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$details</span><span class=p>.</span><span class=py>Add</span><span class=p>(</span><span class=s2>&#34;False&#34;</span><span class=p>,</span> <span class=vm>$false</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nv>$details</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$details</span><span class=p>.</span><span class=n>Empty</span><span class=p>)</span> <span class=p>{</span><span class=s2>&#34;It&#39;s there&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$details</span><span class=p>.</span><span class=n>Null</span><span class=p>)</span> <span class=p>{</span><span class=s2>&#34;It&#39;s there&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$details</span><span class=p>.</span><span class=n>False</span><span class=p>)</span> <span class=p>{</span><span class=s2>&#34;It&#39;s there&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$details</span><span class=p>.</span><span class=py>ContainsKey</span><span class=p>(</span><span class=s1>&#39;Null&#39;</span><span class=p>))</span> <span class=p>{</span><span class=s2>&#34;It&#39;s null!&#34;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>######################</span>
</span></span><span class=line><span class=cl><span class=c># Custom expressions #</span>
</span></span><span class=line><span class=cl><span class=c>######################</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$employee</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Name</span> <span class=p>=</span> <span class=s2>&#34;Beth&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>HourlyWage</span> <span class=p>=</span> <span class=mf>10</span>
</span></span><span class=line><span class=cl>    <span class=n>HoursWorked</span> <span class=p>=</span> <span class=mf>7.5</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nv>$employee</span> <span class=p>|</span> <span class=nb>Select-Object</span> <span class=n>-Property</span>  <span class=p>*,</span><span class=vm>@</span><span class=p>{</span><span class=n>N</span> <span class=p>=</span> <span class=s2>&#34;Wage&#34;</span><span class=p>;</span> <span class=n>E</span> <span class=p>=</span> <span class=p>{</span><span class=nv>$_</span><span class=p>.</span><span class=py>HourlyWage</span> <span class=p>*</span> <span class=nv>$_</span><span class=p>.</span><span class=py>HoursWorked</span> <span class=p>}</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>#############</span>
</span></span><span class=line><span class=cl><span class=c># Splatting #</span>
</span></span><span class=line><span class=cl><span class=c>#############</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>Invoke-RestMethod</span> <span class=n>-Uri</span> <span class=n>catfact</span><span class=p>.</span><span class=n>ninja</span><span class=p>/</span><span class=n>facts</span> <span class=n>-Method</span> <span class=n>Get</span> <span class=p>|</span> <span class=nb>Select-Object</span> <span class=n>Data</span> <span class=n>-ExpandProperty</span> <span class=n>Data</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$params</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Uri</span> <span class=p>=</span> <span class=s2>&#34;catfact.ninja/facts&#34;</span>
</span></span><span class=line><span class=cl>    <span class=n>Method</span> <span class=p>=</span> <span class=s2>&#34;Get&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nb>Invoke-RestMethod</span> <span class=nv>@params</span> <span class=p>|</span> <span class=nb>Select-Object</span> <span class=n>Data</span> <span class=n>-ExpandProperty</span> <span class=n>Data</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Adding parameters</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$Verbose</span> <span class=p>=</span> <span class=vm>$true</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=p>(</span><span class=nv>$Verbose</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nv>$params</span><span class=p>[</span><span class=s1>&#39;Verbose&#39;</span><span class=p>]</span> <span class=p>=</span> <span class=vm>$true</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nb>Invoke-RestMethod</span> <span class=nv>@params</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>#####################</span>
</span></span><span class=line><span class=cl><span class=c># Nested hashtables #</span>
</span></span><span class=line><span class=cl><span class=c>#####################</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$Environments</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Development</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Server</span> <span class=p>=</span> <span class=s2>&#34;Server1&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>Admin</span> <span class=p>=</span> <span class=s2>&#34;Rachel Green&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>Credentials</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Username</span> <span class=p>=</span> <span class=s2>&#34;Serv1&#34;</span>
</span></span><span class=line><span class=cl>            <span class=n>Password</span> <span class=p>=</span> <span class=s2>&#34;Secret&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Test</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Server</span> <span class=p>=</span> <span class=s2>&#34;Server2&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>Admin</span> <span class=p>=</span> <span class=s2>&#34;Joe Triviani&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>Credentials</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Username</span> <span class=p>=</span> <span class=s2>&#34;Serv2&#34;</span>
</span></span><span class=line><span class=cl>            <span class=n>Password</span> <span class=p>=</span> <span class=s2>&#34;Letmein&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Accessing nested properties</span>
</span></span><span class=line><span class=cl><span class=nv>$Environments</span>
</span></span><span class=line><span class=cl><span class=nv>$Environments</span><span class=p>.</span><span class=py>Keys</span>
</span></span><span class=line><span class=cl><span class=nv>$Environments</span><span class=p>.</span><span class=py>Values</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$Environments</span><span class=p>.</span><span class=py>Test</span>
</span></span><span class=line><span class=cl><span class=nv>$Environments</span><span class=p>.</span><span class=py>Test</span><span class=p>.</span><span class=py>Credentials</span>
</span></span><span class=line><span class=cl><span class=nv>$Environments</span><span class=p>[</span><span class=s1>&#39;Test&#39;</span><span class=p>][</span><span class=s1>&#39;Credentials&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Updating nested properties</span>
</span></span><span class=line><span class=cl><span class=nv>$Environments</span><span class=p>.</span><span class=py>Test</span><span class=p>.</span><span class=py>Credentials</span><span class=p>.</span><span class=py>Username</span> <span class=p>=</span> <span class=s2>&#34;admin&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$Environments</span><span class=p>.</span><span class=py>Test</span><span class=p>.</span><span class=py>Credentials</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Quickly unwrapping all properties</span>
</span></span><span class=line><span class=cl><span class=nv>$Environments</span> <span class=p>|</span> <span class=nb>ConvertTo-Json</span> <span class=n>-Depth</span> <span class=mf>99</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Adding nested properties</span>
</span></span><span class=line><span class=cl><span class=nv>$Environments</span><span class=p>[</span><span class=s1>&#39;Production&#39;</span><span class=p>]</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=nv>$Environments</span><span class=p>.</span><span class=py>Production</span><span class=p>.</span><span class=py>Server</span> <span class=p>=</span> <span class=s2>&#34;Server3&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$Environments</span><span class=p>.</span><span class=py>Production</span><span class=p>.</span><span class=py>Admin</span> <span class=p>=</span> <span class=s2>&#34;Ross Geller&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$Environments</span><span class=p>.</span><span class=n>Production</span><span class=p>[</span><span class=s1>&#39;Credentials&#39;</span><span class=p>]</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{}</span>
</span></span><span class=line><span class=cl><span class=nv>$Environments</span><span class=p>.</span><span class=py>Production</span><span class=p>.</span><span class=py>Credentials</span><span class=p>.</span><span class=py>Username</span> <span class=p>=</span> <span class=s2>&#34;Serv3&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>$Environments</span><span class=p>.</span><span class=py>Production</span><span class=p>.</span><span class=py>Credentials</span><span class=p>.</span><span class=py>Password</span> <span class=p>=</span> <span class=s2>&#34;Nosuchplace&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>#####################</span>
</span></span><span class=line><span class=cl><span class=c># Working with JSON #</span>
</span></span><span class=line><span class=cl><span class=c>#####################</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>$Environments</span> <span class=p>|</span> <span class=nb>ConvertTo-Json</span> <span class=p>|</span> <span class=nb>Out-File</span> <span class=n>C:</span><span class=p>\</span><span class=n>temp</span><span class=p>\</span><span class=n>envs</span><span class=p>.</span><span class=py>json</span>
</span></span><span class=line><span class=cl><span class=nb>Get-Content</span> <span class=n>C:</span><span class=p>\</span><span class=n>Temp</span><span class=p>\</span><span class=n>envs</span><span class=p>.</span><span class=py>json</span> <span class=p>|</span> <span class=nb>ConvertFrom-Json</span> <span class=c>#This will create pscustomobject</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>##################</span>
</span></span><span class=line><span class=cl><span class=c># PSCustomObject #</span>
</span></span><span class=line><span class=cl><span class=c>##################</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Creating a new object</span>
</span></span><span class=line><span class=cl><span class=nv>$EnvironmentsObject</span> <span class=p>=</span> <span class=p>[</span><span class=no>pscustomobject</span><span class=p>]</span><span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Development</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Server</span> <span class=p>=</span> <span class=s2>&#34;Server1&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>Admin</span> <span class=p>=</span> <span class=s2>&#34;Rachel Green&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>Credentials</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Username</span> <span class=p>=</span> <span class=s2>&#34;Serv1&#34;</span>
</span></span><span class=line><span class=cl>            <span class=n>Password</span> <span class=p>=</span> <span class=s2>&#34;Secret&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Test</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Server</span> <span class=p>=</span> <span class=s2>&#34;Server2&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>Admin</span> <span class=p>=</span> <span class=s2>&#34;Joe Triviani&#34;</span>
</span></span><span class=line><span class=cl>        <span class=n>Credentials</span> <span class=p>=</span> <span class=vm>@</span><span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Username</span> <span class=p>=</span> <span class=s2>&#34;Serv2&#34;</span>
</span></span><span class=line><span class=cl>            <span class=n>Password</span> <span class=p>=</span> <span class=s2>&#34;Letmein&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c># Casting hashtable to object</span>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=no>PSCustomObject</span><span class=p>]</span><span class=nv>$Environments</span>
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://kamilpro.com/tags/powershell/>powershell</a></li><li><a href=https://kamilpro.com/tags/table/>table</a></li><li><a href=https://kamilpro.com/tags/key/>key</a></li><li><a href=https://kamilpro.com/tags/value/>value</a></li><li><a href=https://kamilpro.com/tags/pair/>pair</a></li><li><a href=https://kamilpro.com/tags/list/>list</a></li><li><a href=https://kamilpro.com/tags/script/>script</a></li></ul></footer></article></main><footer class=footer><span>Kamil Procyszyn</span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>